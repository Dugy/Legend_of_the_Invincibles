#textdomain wesnoth-loti
[scenario]
    id="42_Passage_of_Detriment"
    name= _ "Passage of Detriment"
    map_data="{~add-ons/Legend_of_the_Invincibles/maps/42_Passage_of_Detriment.map}"
    next_scenario=43_Verminous_Sewers
    victory_when_enemies_defeated=no
    experience_modifier=80
    turns=-1
    {DEFAULT_MUSIC_PLAYLIST}
    [time]
        id=dark_indoors
        name= _ "Indoors"
        image=misc/schedule-indoors.png
        lawful_bonus=-25
        red=-45
        green=-35
        blue=-10
    [/time]
    [side]
        type=Efraim_god
        id=Efraim
        name=_"Efraim"
        canrecruit=yes
        side=1
        controller=human
        recruit=Skeleton,Skeleton Archer,Ghost,Walking Corpse,Soulless,Bone Shooter,Deathblade,Revenant,Wraith,Shadow,Chocobone,Spearman,Swordsman,Javelineer,Pikeman,Bowman,Longbowman,Heavy Infantryman,Shock Trooper,Fencer,Duelist,Mage,White Mage,Red Mage,Cavalryman,Dragoon,Horseman,Lancer,Snow Hunter,Knight,Elvish Fighter,Elvish Archer,Elvish Shaman,Elvish Scout,Elvish Druid,Elvish Sorceress,Elvish Captain,Elvish Hero,Elvish Marksman,Elvish Ranger,Elvish Marshal,Elvish Champion,Elvish Sharpshooter,Elvish Avenger,Elvish Outrider,Elvish Shyde,Elvish Enchantress,Thug,Bandit,Thief,Rogue,Footpad,Outlaw,Poacher,Trapper,Troll,Dwarvish Fighter,Dwarvish Steelclad,Dwarvish Guardsman,Dwarvish Stalwart,Dwarvish Thunderer,Dwarvish Thunderguard,Dwarvish Ulfserker,Dwarvish Berserker
        village_gold=0
        income=-2
        gold=0
        team_name=good
        unrenamable=yes
        user_team_name=_"Good"
        shroud=yes
        fog=yes
    [/side]
    {INFERNO_ENEMY_NO_LEADER_SIDE 2}
    {INFERNO_ENEMY_NO_LEADER_SIDE 3}
    {INFERNO_ENEMY_NO_LEADER_SIDE 4}
    {INFERNO_ENEMY_NO_LEADER_SIDE 5}
    {INFERNO_ENEMY_NO_LEADER_SIDE 6}
    {INFERNO_ENEMY_NO_LEADER_SIDE 7}
    {INFERNO_ENEMY_NO_LEADER_SIDE 8}
    [event]
        name=prestart
        {INFERNAL_OBJECTIVES}
        {VARIABLE_OP path rand (1..4)}
        [if]
            [variable]
                name=path
                greater_than=2
            [/variable]
            [then]
                {INFERNO_TRANSITION 35 76,1 73-79,1-2}
                {INFERNO_ORIGIN 35 77,5}
                [if]
                    [variable]
                        name=path
                        equals=3
                    [/variable]
                    [then]
                        [terrain]
                            x=72
                            y=3
                            terrain=Urb
                        [/terrain]
                        [terrain]
                            x=71
                            y=5
                            terrain=Urb
                        [/terrain]
                    [/then]
                    [else]
                        [terrain]
                            x=83
                            y=4
                            terrain=Urb
                        [/terrain]
                        [terrain]
                            x=83
                            y=5
                            terrain=Urb
                        [/terrain]
                    [/else]
                [/if]
            [/then]
            [else]
                {INFERNO_TRANSITION 35 299,63 299-300,61-66}
                {INFERNO_ORIGIN 35 298,63}
                [if]
                    [variable]
                        name=path
                        equals=1
                    [/variable]
                    [then]
                        [terrain]
                            x=298
                            y=60
                            terrain=Urb
                        [/terrain]
                        [terrain]
                            x=297
                            y=60
                            terrain=Urb
                        [/terrain]
                    [/then]
                    [else]
                        [terrain]
                            x=298
                            y=66
                            terrain=Urb
                        [/terrain]
                        [terrain]
                            x=299
                            y=67
                            terrain=Urb
                        [/terrain]
                    [/else]
                [/if]
            [/else]
        [/if]
        {VARIABLE_OP path rand (1..4)}
        [if]
            [variable]
                name=path
                greater_than=2
            [/variable]
            [then]
                {INFERNO_TRANSITION 36 224,299 219-229,299-300}
                {INFERNO_ORIGIN 36 225,299}
                [if]
                    [variable]
                        name=path
                        equals=3
                    [/variable]
                    [then]
                        [terrain]
                            x=219
                            y=299
                            terrain=Urb
                        [/terrain]
                        [terrain]
                            x=223
                            y=296
                            terrain=Urb
                        [/terrain]
                    [/then]
                    [else]
                        [terrain]
                            x=229
                            y=298
                            terrain=Urb
                        [/terrain]
                        [terrain]
                            x=228
                            y=297
                            terrain=Urb
                        [/terrain]
                    [/else]
                [/if]
            [/then]
            [else]
                {INFERNO_TRANSITION 36 206,1 203-209,1-2}
                {INFERNO_ORIGIN 36 206,3}
                [if]
                    [variable]
                        name=path
                        equals=1
                    [/variable]
                    [then]
                        [terrain]
                            x=210
                            y=1
                            terrain=Urb
                        [/terrain]
                        [terrain]
                            x=211
                            y=3
                            terrain=Urb
                        [/terrain]
                    [/then]
                    [else]
                        [terrain]
                            x=200
                            y=3
                            terrain=Urb
                        [/terrain]
                        [terrain]
                            x=205
                            y=7
                            terrain=Urb
                        [/terrain]
                    [/else]
                [/if]
            [/else]
        [/if]
        {VARIABLE_OP path rand (1..4)}
        [if]
            [variable]
                name=path
                greater_than=2
            [/variable]
            [then]
                {INFERNO_TRANSITION 41 2,106 1-2,102-109}
                {INFERNO_ORIGIN 41 4,105}
                [if]
                    [variable]
                        name=path
                        equals=3
                    [/variable]
                    [then]
                        [terrain]
                            x=4
                            y=101
                            terrain=Urb
                        [/terrain]
                        [terrain]
                            x=7
                            y=103
                            terrain=Urb
                        [/terrain]
                    [/then]
                    [else]
                        [terrain]
                            x=10
                            y=106
                            terrain=Urb
                        [/terrain]
                        [terrain]
                            x=4
                            y=109
                            terrain=Urb
                        [/terrain]
                    [/else]
                [/if]
            [/then]
            [else]
                {INFERNO_TRANSITION 41 299,148 299-300,146-152}
                {INFERNO_ORIGIN 41 297,148}
                [if]
                    [variable]
                        name=path
                        equals=1
                    [/variable]
                    [then]
                        [terrain]
                            x=295
                            y=151
                            terrain=Urb
                        [/terrain]
                        [terrain]
                            x=294
                            y=150
                            terrain=Urb
                        [/terrain]
                    [/then]
                    [else]
                        [terrain]
                            x=296
                            y=145
                            terrain=Urb
                        [/terrain]
                        [terrain]
                            x=291
                            y=146
                            terrain=Urb
                        [/terrain]
                    [/else]
                [/if]
            [/else]
        [/if]
        {VARIABLE_OP path rand (1..4)}
        [if]
            [variable]
                name=path
                greater_than=2
            [/variable]
            [then]
                {INFERNO_TRANSITION 48 299,249 299-300,244-251}
                {INFERNO_ORIGIN 48 298,248}
                [if]
                    [variable]
                        name=path
                        equals=3
                    [/variable]
                    [then]
                        [terrain]
                            x=297
                            y=245
                            terrain=Urb
                        [/terrain]
                        [terrain]
                            x=294
                            y=246
                            terrain=Urb
                        [/terrain]
                    [/then]
                    [else]
                        [terrain]
                            x=296
                            y=251
                            terrain=Urb
                        [/terrain]
                        [terrain]
                            x=297
                            y=252
                            terrain=Urb
                        [/terrain]
                    [/else]
                [/if]
            [/then]
            [else]
                {INFERNO_TRANSITION 48 3,299 1-7,299-300}
                {INFERNO_ORIGIN 48 5,298}
                [if]
                    [variable]
                        name=path
                        equals=1
                    [/variable]
                    [then]
                        [terrain]
                            x=4
                            y=294
                            terrain=Urb
                        [/terrain]
                        [terrain]
                            x=5
                            y=294
                            terrain=Urb
                        [/terrain]
                    [/then]
                    [else]
                        [terrain]
                            x=11
                            y=295
                            terrain=Urb
                        [/terrain]
                        [terrain]
                            x=11
                            y=294
                            terrain=Urb
                        [/terrain]
                    [/else]
                [/if]
            [/else]
        [/if]
        {VARIABLE_OP path rand (1..4)}
        [if]
            [variable]
                name=path
                greater_than=2
            [/variable]
            [then]
                {INFERNO_TRANSITION 46 3,159 1-2,155-162}
                {INFERNO_ORIGIN 46 4,158}
                [if]
                    [variable]
                        name=path
                        equals=3
                    [/variable]
                    [then]
                        [terrain]
                            x=8
                            y=155
                            terrain=Urb
                        [/terrain]
                        [terrain]
                            x=12
                            y=158
                            terrain=Urb
                        [/terrain]
                    [/then]
                    [else]
                        [terrain]
                            x=8
                            y=161
                            terrain=Urb
                        [/terrain]
                        [terrain]
                            x=3
                            y=163
                            terrain=Urb
                        [/terrain]
                    [/else]
                [/if]
            [/then]
            [else]
                {INFERNO_TRANSITION 46 165,299 161-170,299-300}
                {INFERNO_ORIGIN 46 166,298}
                [if]
                    [variable]
                        name=path
                        equals=1
                    [/variable]
                    [then]
                        [terrain]
                            x=163
                            y=296
                            terrain=Urb
                        [/terrain]
                        [terrain]
                            x=160
                            y=299
                            terrain=Urb
                        [/terrain]
                    [/then]
                    [else]
                        [terrain]
                            x=168
                            y=295
                            terrain=Urb
                        [/terrain]
                        [terrain]
                            x=171
                            y=299
                            terrain=Urb
                        [/terrain]
                    [/else]
                [/if]
            [/else]
        [/if]
        {INFERNO_CHEST 179 153 sc42_chest}
        {VARIABLE last_scenario 42}
    [/event]
    [event]
        name=start
        {INFERNO_RECALL_ALL}
        {INFERNO_ITEM 27 43 sc42_item1}
        {INFERNO_ITEM 88 163 sc42_item2}
        {INFERNO_ITEM 98 243 sc42_item3}
        {INFERNO_ITEM 263 215 sc42_item4}
        [if]
            [variable]
                name=quests.entered_sc42
                equals=yes
            [/variable]
            [else]
                [message]
                    speaker=Lethalia
                    message= _ "Maybe we should not go here."
                [/message]
                [message]
                    speaker=Efraim
                    message= _ "Do you have some kind of foreboding?"
                [/message]
                [message]
                    speaker=Lethalia
                    message= _ "Yes... use your magical senses. These tunnels are extremely large. They may be hiding even a shortcut right to Uria, but I doubt somebody can pass through this labyrinth without losing his sanity or life."
                [/message]
                [message]
                    speaker=Efraim
                    message= _ "Yes, I can feel that. And places like this will have their dark secrets. We might encounter ancient monsters of incredible power here. They can keep hiding here for eons, because nobody is going through here."
                [/message]
                [message]
                    speaker=Lethalia
                    message= _ "We should avoid this path. This labyrinth will be dreadful.."
                [/message]	#Dreadful is strongly diminutive, a mere indication that this will be worse than anything. Just see the map, it is hard to find a way through it even without shroud.
                [message]
                    speaker=Lilith
                    message= _ "Wait, this is the Passage of Detriment! We should not go here if we want to survive, nothing ever left this labyrinth!"
                [/message]
                {VARIABLE quests.entered_sc42 yes}
            [/else]
        [/if]
    [/event]
    [event]
        name=moveto
        [filter]
            side=1
            x,y=227-267,150-190
        [/filter]	#Works across walls, this will cause the inhabitants occasionally attack the player without warning, creating an impression that the monsters are wandering the area.
        [unit]
            side=2
            type=Demon Lord
            generate_name=yes
            random_gender=yes
            random_traits=yes
            x,y=247,170
            [variables]
                boss=yes
            [/variables]
        [/unit]
    [/event]
    [event]
        name=moveto
        [filter]
            side=1
            x,y=200-240,161-201
        [/filter]
        [unit]
            side=3
            type=Abaddon
            generate_name=yes
            random_gender=yes
            random_traits=yes
            x,y=220,181
            [variables]
                boss=yes
            [/variables]
        [/unit]
    [/event]
    [event]
        name=moveto
        [filter]
            side=1
            x,y=31-71,35-75
        [/filter]
        [unit]
            type=Reaper
            x=51
            y=55
            side=4
            name= _ "Dark Wanderer"
            id=Dark Wanderer
            [modifications]
                [object]
                    [effect]
                        apply_to=image_mod
                        replace="CS(-80,-224,-224)"
                    [/effect]
                    [effect]
                        apply_to=attack
                        increase_damage=100%
                        increase_attacks=100%
                    [/effect]
                    [effect]
                        apply_to=hitpoints
                        increase=200%
                        increase_total=200%
                    [/effect]
                    [effect]
                        apply_to=max_experience
                        increase=1000%
                    [/effect]
                    [effect]
                        apply_to=resistance
                        replace=false
                        [resistance]
                            fire=-30
                            cold=-30
                            arcane=-30
                            blade=-30
                            pierce=-30
                            impact=-30
                        [/resistance]
                    [/effect]
                [/object]
            [/modifications]
            [variables]
                boss=yes
            [/variables]
        [/unit]
        [store_unit]
            [filter]
                id=Dark Wanderer
            [/filter]
            kill=no
            variable=blackening_store
        [/store_unit]
        [set_variable]
            name=blackening_store.level
            value=20
        [/set_variable]
        [unstore_unit]
            variable=blackening_store
            find_vacant=no
        [/unstore_unit]
        [clear_variable]
            name=blackening_store
        [/clear_variable]
    [/event]
    [event]
        name=moveto
        [filter]
            side=1
            x,y=266-300,13-53
        [/filter]
        [unit]
            type=Dark Shade
            x=286
            y=33
            side=5
            name= _ "Lost Soul"
            id=Lost Soul
            [modifications]
                [object]
                    [effect]
                        apply_to=attack
                        increase_damage=100%
                        increase_attacks=100%
                    [/effect]
                    [effect]
                        apply_to=max_experience
                        increase=1000%
                    [/effect]
                    [effect]
                        apply_to=hitpoints
                        increase=200%
                        increase_total=200%
                    [/effect]
                    [effect]
                        apply_to=resistance
                        replace=false
                        [resistance]
                            fire=-30
                            cold=-30
                            arcane=-30
                            blade=-30
                            pierce=-30
                            impact=-30
                        [/resistance]
                    [/effect]
                [/object]
            [/modifications]
            [variables]
                boss=yes
            [/variables]
        [/unit]
        [store_unit]
            [filter]
                id=Lost Soul
            [/filter]
            kill=no
            variable=blackening_store
        [/store_unit]
        [set_variable]
            name=blackening_store.level
            value=20
        [/set_variable]
        [unstore_unit]
            variable=blackening_store
            find_vacant=no
        [/unstore_unit]
        [clear_variable]
            name=blackening_store
        [/clear_variable]
    [/event]
    [event]
        name=moveto
        [filter]
            side=1
            x,y=72-112,143-183
        [/filter]
        [unit]
            type=Corrupted Elvish Juggernaut
            x=92
            y=163
            side=6
            name= _ "Vengeful Spirit"
            id=Vengeful Spirit
            [modifications]
                {TRAIT_UNDEAD}
                [object]
                    [effect]
                        apply_to=image_mod
                        replace="O(50%)"
                    [/effect]
                    [effect]
                        apply_to=max_experience
                        increase=1000%
                    [/effect]
                    [effect]
                        apply_to=hitpoints
                        increase=200%
                        increase_total=200%
                    [/effect]
                    [effect]
                        apply_to=resistance
                        replace=false
                        [resistance]
                            fire=-30
                            cold=-30
                            arcane=-30
                            blade=-50
                            pierce=-50
                            impact=-50
                        [/resistance]
                    [/effect]
                [/object]
            [/modifications]
            [variables]
                boss=yes
            [/variables]
        [/unit]
        [store_unit]
            [filter]
                id=Vengeful Spirit
            [/filter]
            kill=no
            variable=blackening_store
        [/store_unit]
        [set_variable]
            name=blackening_store.level
            value=30
        [/set_variable]
        [set_variable]
            name=blackening_store.max_attacks
            value=2
        [/set_variable]
        [unstore_unit]
            variable=blackening_store
            find_vacant=no
        [/unstore_unit]
        [clear_variable]
            name=blackening_store
        [/clear_variable]
    [/event]
    [event]
        name=moveto
        [filter]
            side=1
            x,y=210-250,76-116
        [/filter]
        [unit]
            type=Dracolich
            x=230
            y=96
            side=7
            id=Dracolich
            [modifications]
                [object]
                    [effect]
                        apply_to=max_experience
                        increase=1000%
                    [/effect]
                    [effect]
                        apply_to=attack
                        increase_damage=100%
                        increase_attacks=100%
                    [/effect]
                    [effect]
                        apply_to=hitpoints
                        increase=200%
                        increase_total=200%
                    [/effect]
                    [effect]
                        apply_to=resistance
                        replace=false
                        [resistance]
                            fire=-30
                            cold=-30
                            arcane=-30
                            blade=-30
                            pierce=-30
                            impact=-30
                        [/resistance]
                    [/effect]
                [/object]
            [/modifications]
            [variables]
                boss=yes
            [/variables]
        [/unit]
        [store_unit]
            [filter]
                id=Dracolich
            [/filter]
            kill=no
            variable=blackening_store
        [/store_unit]
        [set_variable]
            name=blackening_store.level
            value=30
        [/set_variable]
        [unstore_unit]
            variable=blackening_store
            find_vacant=no
        [/unstore_unit]
        [clear_variable]
            name=blackening_store
        [/clear_variable]
    [/event]
    [event]
        name=moveto
        [filter]
            side=1
            x,y=96-136,29-69
        [/filter]
        [unit]
            type=Spider Demon
            x=116
            y=49
            side=8
            name= _ "Miscreation Champion"
            id=Miscreation
            [modifications]
                {TRAIT_UNDEAD}
                [object]
                    [effect]
                        apply_to=image_mod
                        replace="CS(50,-50,-50)"
                    [/effect]
                    [effect]
                        apply_to=max_experience
                        increase=1000%
                    [/effect]
                    [effect]
                        apply_to=attack
                        increase_damage=100%
                        increase_attacks=100%
                    [/effect]
                    [effect]
                        apply_to=hitpoints
                        increase=200%
                        increase_total=200%
                    [/effect]
                    [effect]
                        apply_to=resistance
                        replace=false
                        [resistance]
                            fire=-20
                            cold=-20
                            arcane=-20
                            blade=-20
                            pierce=-20
                            impact=-20
                        [/resistance]
                    [/effect]
                [/object]
                [variables]
                    boss=yes
                [/variables]
            [/modifications]
        [/unit]
        [store_unit]
            [filter]
                id=Miscreation
            [/filter]
            kill=no
            variable=blackening_store
        [/store_unit]
        [set_variable]
            name=blackening_store.level
            value=20
        [/set_variable]
        [unstore_unit]
            variable=blackening_store
            find_vacant=no
        [/unstore_unit]
        [clear_variable]
            name=blackening_store
        [/clear_variable]
    [/event]
    {DROPS 50 80 (axe,axe,staff,sword,sword,knife,bow,xbow,spear,spear,bow,dagger,mace) yes 2,3,4,5,6,7,8}
    {CAMPAIGN9_EVENTS}
    {GENERIC_DEATHS}
    {GLOBAL_EVENTS}
    {DISABLE_UPKEEP 1}
[/scenario]

#textdomain wesnoth-loti
#define ENEMY_AI
    [ai]
        aggression=1.0
        passive_leader_shares_keep=yes
    [/ai]
#enddef
#define BLACKEN
    [set_variable]
        name=blackening_store.level
        multiply=3
    [/set_variable]
    [set_variable]
        name=blackening_store.variables.black_soul
        set=yes
    [/set_variable]
    [set_variable]
        name=blackening_store.level
        add=2
    [/set_variable]
    [set_variable]
        name=blackening_store.race
        value="black soul-loti"
    [/set_variable]
    [set_variable]
        name=blackening_store.alignment
        value=chaotic
    [/set_variable]
#enddef
#define PLACE_SPAWN
    {VARIABLE inserted_event.name moveto}
    {VARIABLE inserted_event.filter.side (1,2,3,4,5)}
    {VARIABLE checked "$($spawn_list.spawn[$k].x-$spawn_list.spawn[$k].range)"}
    [if]
        [variable]
            name=checked
            less_than=1
        [/variable]
        [then]
            {VARIABLE inserted_event.filter.filter_location.x "0-$($spawn_list.spawn[$k].x*1+$spawn_list.spawn[$k].range)"}
        [/then]
        [else]
            {VARIABLE inserted_event.filter.filter_location.x "$($spawn_list.spawn[$k].x-$spawn_list.spawn[$k].range)-$($spawn_list.spawn[$k].x*1+$spawn_list.spawn[$k].range)"}
        [/else]
    [/if]
    {VARIABLE checked "$($spawn_list.spawn[$k].y-$spawn_list.spawn[$y].range)"}
    [if]
        [variable]
            name=checked
            less_than=1
        [/variable]
        [then]
            {VARIABLE inserted_event.filter.filter_location.y "0-$($spawn_list.spawn[$k].y*1+$spawn_list.spawn[$k].range)"}
        [/then]
        [else]
            {VARIABLE inserted_event.filter.filter_location.y "$($spawn_list.spawn[$k].y-$spawn_list.spawn[$k].range)-$($spawn_list.spawn[$k].y*1+$spawn_list.spawn[$k].range)"}
        [/else]
    [/if]
    {CLEAR_VARIABLE checked}
    {VARIABLE inserted_event.set_variable.name spawn.spawn_type}
    {VARIABLE inserted_event.set_variable.value $spawn_list.spawn[$k].spawn_type}
    {VARIABLE inserted_event.set_variable[1].name spawn.number}
    {VARIABLE inserted_event.set_variable[1].value $spawn_list.spawn[$k].number}
    {VARIABLE inserted_event.set_variable[2].name spawn.increment}
    {VARIABLE inserted_event.set_variable[2].value $spawn_list.spawn[$k].increment}
    {VARIABLE inserted_event.set_variable[3].name spawn.x}
    {VARIABLE inserted_event.set_variable[3].value $spawn_list.spawn[$k].x}
    {VARIABLE inserted_event.set_variable[4].name spawn.y}
    {VARIABLE inserted_event.set_variable[4].value $spawn_list.spawn[$k].y}
    {VARIABLE inserted_event.set_variable[5].name spawn.act}
    {VARIABLE inserted_event.set_variable[5].value $spawn_list.spawn[$k].act}
    {VARIABLE inserted_event.set_variable[6].name spawn.blacken}
    {VARIABLE inserted_event.set_variable[6].value $spawn_list.spawn[$k].blacken}
    {VARIABLE inserted_event.set_variable[7].name spawn.side}
    {VARIABLE inserted_event.set_variable[7].value $spawn_list.spawn[$k].side}
    {VARIABLE inserted_event.set_variable[8].name spawn_list.spawn[$k].free}
    {VARIABLE inserted_event.set_variable[8].value 1}
    {VARIABLE inserted_event.fire_event.name spawn_enemy}
    {VARIABLE spawn_list.spawn[$k].free 0}
    [insert_tag]
        name=event
        variable=inserted_event
    [/insert_tag]
#enddef
#define PLACE_SPAWNS ACT
    {FOREACH spawn_list.spawn k}
        [if]
            [variable]
                name=spawn_list.spawn[$k].act
                equals={ACT}
            [/variable]
            [then]
                {PLACE_SPAWN}
            [/then]
        [/if]
    {NEXT k}
#enddef
#define A1BOSSES_KILL_CHECK
    [if]
        [variable]
            name=a11
            equals=1
        [/variable]
        [and]
            [variable]
                name=a12
                equals=1
            [/variable]
        [/and]
        [and]
            [variable]
                name=a13
                equals=1
            [/variable]
        [/and]
        [and]
            [variable]
                name=a14
                equals=1
            [/variable]
        [/and]
        [then]
            {VARIABLE a15 1}
            {VARIABLE k17 1}
            {VARIABLE k18 1}
            {VARIABLE k19 1}
            {VARIABLE k20 1}
            [chat]
                speaker= _ "Information"
                message= _ "All Act 1 bosses have been defeated. Portal to act 2 has been unsealed."
            [/chat]
            [remove_item]
                x,y=51,97
                image=scenery/portal-red.png
            [/remove_item]
            {PLACE_IMAGE scenery/portal.png 51 97}
        [/then]
    [/if]
#enddef
#define A2BOSSES_KILL_CHECK
    [if]
        [variable]
            name=a21
            equals=1
        [/variable]
        [and]
            [variable]
                name=a22
                equals=1
            [/variable]
        [/and]
        [and]
            [variable]
                name=a23
                equals=1
            [/variable]
        [/and]
        [and]
            [variable]
                name=a24
                equals=1
            [/variable]
        [/and]
        [then]
            {VARIABLE a25 1}
            {VARIABLE k26 1}
            {VARIABLE k27 1}
            {VARIABLE k28 1}
            {VARIABLE k29 1}
            [chat]
                speaker= _ "Information"
                message= _ "All Act 2 bosses have been defeated. Portal to act 3 has been unsealed."
            [/chat]
            [remove_item]
                x,y=57,90
                image=scenery/portal-red.png
            [/remove_item]
            {PLACE_IMAGE scenery/portal.png 57 90}
        [/then]
    [/if]
#enddef
#define ENEMY_SPAWN X Y MONSTER_LIST NUMBER
    [event]
        name=moveto
        [filter]
            side=1,2,3,4,5
            [filter_location]
                x,y={X},{Y}
                radius=25
            [/filter_location]
        [/filter]
        {VARIABLE spawn_count {NUMBER}}
        [while]
            [variable]
                name=spawn_count
                greater_than=0
            [/variable]
            [do]
                {VARIABLE_OP spawn_type rand {MONSTER_LIST}}
                {GENERIC_UNIT 6 $spawn_type {X} {Y}}
                {VARIABLE_OP spawn_count sub 1}
            [/do]
        [/while]
        [allow_undo]
        [/allow_undo]	#You can go back, but the enemy will be there anyway; this is to make sure that the player cannot notice some enemies spawned in the distance
        {CLEAR_VARIABLE spawn_count,spawn_type}
    [/event]
#enddef
#define A1_SAURIAN_SPAWN X Y NUMBER
    [spawn]
        range=18
        spawn_type=Saurian Skirmisher,Saurian Skirmisher,Saurian Augur
        increment=1
        act=1
        number={NUMBER}
        x={X}
        y={Y}
        side=6
    [/spawn]
#enddef
#define A1_LESSER_ORCISH_SPAWN X Y NUMBER
    [spawn]
        range=25
        spawn_type=Orcish Grunt,Orcish Archer,Orcish Assassin,Orcish Grunt,Orcish Archer,Orcish Assassin,Orcish Warrior,Orcish Slayer,Orcish Crossbowman
        increment=1
        act=1
        number={NUMBER}
        x={X}
        y={Y}
        side=7
    [/spawn]
#enddef
#define A1_ORCISH_SPAWN X Y NUMBER
    [spawn]
        range=25
        spawn_type=Orcish Grunt,Orcish Archer,Orcish Assassin,Orcish Warrior,Orcish Slayer,Orcish Crossbowman,Orcish Warlord,Orcish Slurbow
        increment=1
        act=1
        number={NUMBER}
        x={X}
        y={Y}
        side=8
    [/spawn]
#enddef
#define A1_GREATER_ORCISH_SPAWN X Y NUMBER
    [spawn]
        range=25
        spawn_type=Orcish Warrior,Orcish Slayer,Orcish Crossbowman,Orcish Warlord,Orcish Slurbow
        increment=1
        act=1
        number={NUMBER}
        x={X}
        y={Y}
        side=9
    [/spawn]
#enddef
#define A1_TROLL_SPAWN X Y NUMBER
    [spawn]
        range=25
        spawn_type=Troll Whelp,Troll Whelp,Troll,Troll,Troll Rocklobber,Troll Shaman,Troll Warrior
        increment=1
        act=1
        number={NUMBER}
        x={X}
        y={Y}
        side=6
    [/spawn]
#enddef
#define A1_GREATER_TROLL_SPAWN X Y NUMBER
    [spawn]
        range=25
        spawn_type=Troll,Troll Rocklobber,Troll Shaman,Troll Warrior,Great Troll,Troll Hero
        increment=1
        act=1
        number={NUMBER}
        x={X}
        y={Y}
        side=6
    [/spawn]
#enddef
#define A1_GOBLIN_SPAWN X Y NUMBER
    [spawn]
        range=25
        spawn_type=Goblin Spearman,Goblin Spearman,Goblin Spearman,Goblin Impaler,Goblin Impaler,Goblin Rouser,Wolf Rider,Goblin Knight,Goblin Pillager
        increment=1
        act=1
        number={NUMBER}
        x={X}
        y={Y}
        side=7
    [/spawn]
#enddef
#define A1_GREATER_GOBLIN_SPAWN X Y NUMBER
    [spawn]
        range=25
        spawn_type=Goblin Impaler,Goblin Impaler,Wolf Rider,Goblin Knight,Goblin Pillager,Direwolf Rider
        increment=1
        act=1
        number={NUMBER}
        x={X}
        y={Y}
        side=8
    [/spawn]
#enddef
#define A1_DESERT_SPAWN X Y NUMBER
    [spawn]
        range=25
        spawn_type=Giant Scorpion,Giant Spider,Giant Rat,Wolf,Giant Scorpion,Giant Spider,Giant Rat,Wolf,Great Wolf,Direwolf
        increment=1
        act=1
        number={NUMBER}
        x={X}
        y={Y}
        side=9
    [/spawn]
#enddef
#define A1_WOLF_SPAWN X Y NUMBER
    [spawn]
        range=25
        spawn_type=Wolf,Wolf,Wolf,Great Wolf,Great Wolf,Direwolf
        increment=1
        act=1
        number={NUMBER}
        x={X}
        y={Y}
        side=9
    [/spawn]
#enddef
#define A1_LESSER_UNDEAD_SPAWN X Y NUMBER
    [spawn]
        range=25
        spawn_type=Walking Corpse,Soulless,Skeleton,Skeleton Archer,Ghoul,Ghost,Walking Corpse,Soulless,Skeleton,Skeleton Archer,Ghoul,Ghost,Revenant,Bone Shooter,Necrophage,Deathblade,Chocobone,Shadow,Wraith
        increment=2
        act=1
        number={NUMBER}
        x={X}
        y={Y}
        side=9
    [/spawn]
#enddef
#define A1_UNDEAD_SPAWN X Y NUMBER
    [spawn]
        range=25
        spawn_type=Walking Corpse,Soulless,Skeleton,Skeleton Archer,Ghoul,Ghost,Revenant,Bone Shooter,Necrophage,Deathblade,Chocobone,Shadow,Wraith,Death Knight,Grim Knight,Banebow,Ghast,Draug,Nightgaunt,Spectre
        increment=1
        act=1
        number={NUMBER}
        x={X}
        y={Y}
        side=6
    [/spawn]
#enddef
#define A1_GREATER_UNDEAD_SPAWN X Y NUMBER
    [spawn]
        range=25
        spawn_type=Soulless,Revenant,Bone Shooter,Necrophage,Deathblade,Chocobone,Shadow,Wraith,Death Knight,Spectre,Ghast,Draug,Nightgaunt,Grim Knight,Banebow
        increment=1
        act=1
        number={NUMBER}
        x={X}
        y={Y}
        side=7
    [/spawn]
#enddef
#define A1_BAT_SPAWN X Y NUMBER
    [spawn]
        range=25
        spawn_type=Vampire Bat,Blood Bat,Dread Bat
        increment=1
        act=1
        number={NUMBER}
        x={X}
        y={Y}
        side=7
    [/spawn]
#enddef
#define A2_SAURIAN_SPAWN X Y NUMBER
    [spawn]
        range=25
        spawn_type=Saurian Skirmisher,Saurian Augur,Saurian Ambusher,Saurian Flanker,Saurian Oracle,Saurian Soothsayer
        increment=2
        act=2
        number={NUMBER}
        x={X}
        y={Y}
        side=6
    [/spawn]
#enddef
#define A2_UNDEAD_SPAWN X Y NUMBER
    [spawn]
        range=25
        spawn_type=Soulless,Revenant,Bone Shooter,Necrophage,Deathblade,Chocobone,Shadow,Wraith,Death Knight,Spectre,Ghast,Draug,Nightgaunt,Grim Knight,Banebow
        increment=2
        act=2
        number={NUMBER}
        x={X}
        y={Y}
        side=7
    [/spawn]
#enddef
#define A2_BANDIT_SPAWN X Y NUMBER
    [spawn]
        range=25
        spawn_type=Poacher,Thug,Bandit,Highwayman,Blackguard,Trapper,Huntsman,Forester,Ranger,Footpad,Outlaw,Fugitive,Shadow Prince,Thief,Rogue,Assassin,Shadowalker
        increment=2
        act=2
        number={NUMBER}
        x={X}
        y={Y}
        side=7
    [/spawn]
#enddef
#define A2_ORCISH_SPAWN X Y NUMBER
    [spawn]
        range=25
        spawn_type=Corrupted Orcish Grunt,Corrupted Orcish Grunt,Corrupted Orcish Assassin,Corrupted Orcish Assassin,Corrupted Orcish Warrior,Corrupted Orcish Slayer, Spell Eater
        increment=1
        act=2
        number={NUMBER}
        x={X}
        y={Y}
        side=8
    [/spawn]
#enddef
#define A2_GREATER_ORCISH_SPAWN X Y NUMBER
    [spawn]
        range=25
        spawn_type=Corrupted Orcish Assassin,Corrupted Orcish Grunt,Corrupted Orcish Warrior,Corrupted Orcish Slayer,Corrupted Orcish Sovereign, Spell Eater
        increment=1
        act=2
        number={NUMBER}
        x={X}
        y={Y}
        side=8
    [/spawn]
#enddef
#define A2_ELF_SPAWN X Y NUMBER
    [spawn]
        range=25
        spawn_type=Corrupted Elvish Fighter,Corrupted Elvish Fighter,Corrupted Elvish Fighter,Corrupted Elvish Scout,Corrupted Elvish Scout,Corrupted Elvish Scout,Corrupted Elvish Hero,Corrupted Elvish Captain, Spell Eater
        increment=1
        act=2
        number={NUMBER}
        x={X}
        y={Y}
        side=6
    [/spawn]
#enddef
#define A2_GREATER_ELF_SPAWN X Y NUMBER
    [spawn]
        range=25
        spawn_type=Corrupted Elvish Fighter,Corrupted Elvish Scout,Corrupted Elvish Hero,Corrupted Elvish Captain,Corrupted Elvish Champion, Spell Eater
        increment=1
        act=2
        number={NUMBER}
        x={X}
        y={Y}
        side=6
    [/spawn]
#enddef
#define A2_NAGA_SPAWN X Y NUMBER
    [spawn]
        range=25
        spawn_type=Corrupted Naga Fighter,Corrupted Naga Warrior, Spell Eater
        increment=1
        act=2
        number={NUMBER}
        x={X}
        y={Y}
        side=7
    [/spawn]
#enddef
#define A2_BLACK_SOUL_SPAWN X Y NUMBER
    [spawn]
        range=25
        spawn_type=Bowman,Spearman,Heavy Infantryman,Cavalryman,Horseman,Dark Adept
        increment=1
        act=2
        number={NUMBER}
        x={X}
        y={Y}
        blacken=yes
        side=9
    [/spawn]
#enddef
#define A3_LESSER_BLACK_SOUL_SPAWN X Y NUMBER
    [spawn]
        range=25
        spawn_type=Bowman,Spearman,Heavy Infantryman,Cavalryman,Horseman,Dark Adept
        increment=2
        act=3
        number={NUMBER}
        x={X}
        y={Y}
        blacken=yes
        side=9
    [/spawn]
#enddef
#define A3_BLACK_SOUL_SPAWN X Y NUMBER
    [spawn]
        range=25
        spawn_type=Bowman,Spearman,Heavy Infantryman,Cavalryman,Horseman,Dark Adept,Longbowman,Swordsman,Javelineer,Pikeman,Shock Trooper,Dragoon,Knight,Lancer,Dark Sorcerer
        increment=1
        act=3
        number={NUMBER}
        x={X}
        y={Y}
        blacken=yes
        side=6
    [/spawn]
#enddef
#define A3_GREATER_BLACK_SOUL_SPAWN X Y NUMBER
    [spawn]
        range=25
        spawn_type=Bowman,Spearman,Heavy Infantryman,Cavalryman,Horseman,Dark Adept,Longbowman,Swordsman,Javelineer,Pikeman,Shock Trooper,Dragoon,Knight,Lancer,Dark Sorcerer,Master Bowman,Royal Guard,Halberdier,Grand Marshal,General,Iron Mauler,Cavalier,Grand Knight,Necromancer
        increment=1
        act=3
        number={NUMBER}
        x={X}
        y={Y}
        blacken=yes
        side=8
    [/spawn]
#enddef
#define A3_DEMON_SPAWN X Y NUMBER
    [spawn]
        range=25
        spawn_type=Demon
        increment=1
        act=3
        number={NUMBER}
        x={X}
        y={Y}
        side=7
    [/spawn]
#enddef
#define A3_GREATER_DEMON_SPAWN X Y NUMBER
    [spawn]
        range=25
        spawn_type=Demon,Demon,Demon,Demon Warrior
        increment=2
        act=3
        number={NUMBER}
        x={X}
        y={Y}
        side=8
    [/spawn]
#enddef
#define A4_BLACK_SOUL_SPAWN X Y NUMBER
    [spawn]
        range=25
        spawn_type=Bowman,Spearman,Heavy Infantryman,Cavalryman,Horseman,Dark Adept,Longbowman,Swordsman,Javelineer,Pikeman,Shock Trooper,Dragoon,Knight,Lancer,Dark Sorcerer,Master Bowman,Royal Guard,Halberdier,Grand Marshal,General,Iron Mauler,Cavalier,Grand Knight,Necromancer
        increment=2
        act=4
        number={NUMBER}
        x={X}
        y={Y}
        blacken=yes
        side=8
    [/spawn]
#enddef
#define TRAVEL_TO X Y
    [if]
        [have_unit]
            [filter_location]
                x,y={X},{Y}
                radius=4
                count=5-99
            [/filter_location]
        [/have_unit]
        [then]
            [chat]
                speaker= _ "Issue"
                message= _ "Cannot teleport to that keep. There are too many units near the destination."
            [/chat]
        [/then]
        [else]
            [teleport]
                [filter]
                    side=$side_number
                    canrecruit=yes
                [/filter]
                x,y={X},{Y}
                clear_shroud=yes
                animate=no
            [/teleport]
            [store_unit]
                [filter]
                    side=$side_number
                [/filter]
                kill=no
                variable=teleport_store
            [/store_unit]
            {FOREACH teleport_store i}
                [teleport]
                    [filter]
                        id=$teleport_store[$i].id
                    [/filter]
                    x,y={X},{Y}
                    clear_shroud=yes
                    animate=no
                [/teleport]
            {NEXT i}
            {CLEAR_VARIABLE teleport_store}
            [scroll_to]
                x,y={X},{Y}
                check_fogged=false
            [/scroll_to]
        [/else]
    [/if]
#enddef
#define KEEP_DISCOVER X Y NAME VARIABLE_NAME
    [event]
        name=moveto
        [filter]
            side=1,2,3,4,5
            x,y={X},{Y}
        [/filter]
        [chat]
            speaker="Information"
            message="{NAME} discovered. Now you can move there at any time."
        [/chat]
        {VARIABLE {VARIABLE_NAME} 1}
    [/event]
#enddef

[multiplayer]
    id=Hordes_of_the_Other_World
    name= _ "LotI - Hordes of the Other World"
    description= _ "This is a multiplayer scenario designed to be a multiplayer version of the Legend of the Invincibles campaign.

After closing the portal into the world of the dead and defeating the uprising of dragons, a new threat has arisen. While the barrier between the worlds was still faint, a spirit of unimaginable power, known only as Shadowlord, opened a portal from the world of the dead into Irdya, and started threatening every living soul with his immense power. As the darkness spread into the known world, five heroes (well known from chapter 3) and their brave soldiers came to stop this danger.

The scenario is as long as a regular campaign, difficulty is adjustable, for 1-5 players. Uses regular units. Use map settings or you're screwed at the start, eras and factions will have no effect on this (side 1 is always Efraim and undead, side 2 Lethalia and elves, side 3 Argan and humans, side 4 Stormrider and other humans and side 5 is always Delly and outlaws)."
    turns="-1"
    experience_modifier="60"
    map_data="{~add-ons/Legend_of_the_Invincibles/multiplayer/HotOW.map}"
    victory_when_enemies_defeated=no
    fog=no
    {DUSK}
    {FIRST_WATCH}
    {SECOND_WATCH}
    {DAWN}
    {MORNING}
    {AFTERNOON}
    [time_area]
        x=0-162
        y=94-132
        {UNDERGROUND}
    [/time_area]
    [time_area]
        x=133-201
        y=146-201
        {UNDERGROUND}
    [/time_area]
    [time_area]
        x=132-137
        y=185-197
        {UNDERGROUND}
    [/time_area]
    [time_area]
        x=129-133
        y=164-184
        {UNDERGROUND}
    [/time_area]
    [time_area]
        x=129-141
        y=146-179
        {UNDERGROUND}
    [/time_area]
    [time_area]
        x=123-129
        y=146-181
        {UNDERGROUND}
    [/time_area]
    [time_area]
        x=121-125
        y=171-175
        {UNDERGROUND}
    [/time_area]
    [time_area]
        x=115-133
        y=164-170
        {UNDERGROUND}
    [/time_area]
    [time_area]
        x=91-165
        y=102-166
        {UNDERGROUND}
    [/time_area]
    [time_area]
        x=86-94
        y=156-163
        {UNDERGROUND}
    [/time_area]
    [time_area]
        x=81-91
        y=156-159
        {UNDERGROUND}
    [/time_area]
    [time_area]
        x=64-82
        y=151-156
        {UNDERGROUND}
    [/time_area]
    [time_area]
        x=49-103
        y=145-152
        {UNDERGROUND}
    [/time_area]
    [time_area]
        x=55-103
        y=134-142
        {UNDERGROUND}
    [/time_area]
    [time_area]
        x=48-103
        y=132-137
        {UNDERGROUND}
    [/time_area]
    [time_area]
        x=0-78
        y=82-93
        {UNDERGROUND}
    [/time_area]
    [time_area]
        x=49-53
        y=80-84
        {UNDERGROUND}
    [/time_area]
    [time_area]
        x=74-77
        y=80-93
        {UNDERGROUND}
    [/time_area]
    [time_area]
        x=76-88
        y=89-93
        {UNDERGROUND}
    [/time_area]
    [time_area]
        x=88-95
        y=90-93
        {UNDERGROUND}
    [/time_area]
    [time_area]
        x=75-80
        y=74-77
        {UNDERGROUND}
    [/time_area]
    [time_area]
        x=0-55
        y=0-23
        {UNDERGROUND}
    [/time_area]
    [time_area]
        x=81-91
        y=152-156
        {UNDERGROUND}
    [/time_area]
    [time_area]
        x=29
        y=133
        {UNDERGROUND}
    [/time_area]
    [time_area]
        x=58-92
        y=142-145
        {UNDERGROUND}
    [/time_area]
    [time_area]
        x=0-6
        y=21-81
        {SCHEDULE_HELL}
    [/time_area]
    [time_area]
        x=5-25
        y=23-82
        {SCHEDULE_HELL}
    [/time_area]
    [time_area]
        x=26-38
        y=19-81
        {SCHEDULE_HELL}
    [/time_area]
    [time_area]
        x=37-53
        y=22-81
        {SCHEDULE_HELL}
    [/time_area]
    [time_area]
        x=52-54
        y=54-66
        {SCHEDULE_HELL}
    [/time_area]
    [time_area]
        x=55
        y=52-53
        {SCHEDULE_HELL}
    [/time_area]
    [time_area]
        x=52-56
        y=23-55
        {SCHEDULE_HELL}
    [/time_area]
    [time_area]
        x=56
        y=26-30
        {SCHEDULE_HELL}
    [/time_area]
    [time_area]
        x=57
        y=28-29
        {SCHEDULE_HELL}
    [/time_area]
    [time_area]
        x=163-201
        y=94-146
        [time]
            id="no sky"
            name= _ "No sky"
        [/time]
    [/time_area]
    [time_area]
        x=160-162
        y=124-126
        [time]
            id="no sky"
            name= _ "No sky"
        [/time]
    [/time_area]
    [time_area]
        x=160-162
        y=138-141
        [time]
            id="no sky"
            name= _ "No sky"
        [/time]
    [/time_area]
    [time_area]
        x=56
        y=32-55
        {DUSK}
        {FIRST_WATCH}
        {SECOND_WATCH}
        {DAWN}
        {MORNING}
        {AFTERNOON}
    [/time_area]
    [time_area]
        x=55
        y=40-42
        {DUSK}
        {FIRST_WATCH}
        {SECOND_WATCH}
        {DAWN}
        {MORNING}
        {AFTERNOON}
    [/time_area]
    [time_area]
        x=55
        y=47-49
        {DUSK}
        {FIRST_WATCH}
        {SECOND_WATCH}
        {DAWN}
        {MORNING}
        {AFTERNOON}
    [/time_area]
    [side]
        side=1
        id=Efraim
        type=Efraim_lich
        gender=male
        canrecruit=yes
        team_name="heroes"
        user_team_name= _ "teamname^Heroes"
        controller="human"
        save_id="Efraim"
        name=_"Efraim"
        description= _ "Efraim and his skeletal hordes"
        recruit=Walking Corpse,Ghost,Skeleton Archer,Skeleton,Dark Adept
        village_gold=0
        gold=150
        color=red
        income=-2
        gold_lock="true"
        income_lock="true"
        team_lock="true"
        fog="yes"
        share_view="yes"
        share_maps=yes
        shroud=yes
    [/side]
    [side]
        side=2
        id=Lethalia
        canrecruit=yes
        team_name="heroes"
        type=Lethalia_lich
        user_team_name= _ "teamname^Heroes"
        controller="human"
        save_id="Lethalia"
        name=_"Lethalia"
        description= _ "Lethalia and her loyal elves"
        recruit=Elvish Archer,Elvish Fighter,Elvish Scout,Elvish Shaman
        village_gold=0
        color=blue
        gold=150
        income=-2
        gold_lock="true"
        income_lock="true"
        team_lock="true"
        fog="yes"
        share_view="yes"
        share_maps=yes
        shroud=yes
    [/side]
    [side]
        side=3
        id=Argan
        type=Argan_lich
        canrecruit=yes
        team_name="heroes"
        user_team_name= _ "teamname^Heroes"
        controller="human"
        save_id="Argan"
        name=_"Argan"
        description= _ "Argan and his army"
        recruit=Cavalryman,Spearman,,Heavy Infantryman,Bowman
        village_gold=0
        gold=150
        color=green
        income=-2
        gold_lock="true"
        income_lock="true"
        team_lock="true"
        fog="yes"
        share_view="yes"
        share_maps=yes
        shroud=yes
    [/side]
    [side]
        side=4
        id=Stormrider
        type=Stormrider
        canrecruit=yes
        team_name="heroes"
        user_team_name= _ "teamname^Heroes"
        controller="human"
        save_id="Stormrider"
        name=_"Stormrider"
        description= _ "Stormrider and his noble army"
        recruit=Horseman,Fencer,Mage,Sergeant
        village_gold=0
        gold=150
        color=white
        income=-2
        gold_lock="true"
        income_lock="true"
        team_lock="true"
        fog="yes"
        share_view="yes"
        share_maps=yes
        shroud=yes
    [/side]
    [side]
        side=5
        id=Delly
        type=Delly_lich
        canrecruit=yes
        team_name="heroes"
        user_team_name= _ "teamname^Heroes"
        controller="human"
        save_id="Delly"
        name=_"Delly"
        description= _ "Delly and her criminal band"
        recruit=Footpad,Thief,Poacher,Thug
        village_gold=0
        gold=150
        income=-2
        color=purple
        gold_lock="true"
        income_lock="true"
        team_lock="true"
        fog="yes"
        share_view="yes"
        share_maps=yes
        shroud=yes
    [/side]
    [side]
        side=6
        canrecruit=yes
        team_name="evil"
        user_team_name= _ "teamname^Evil"
        allow_player=no
        color=black
        gold=0
        type=Ancient Lich
        id=Cave Guardian
        recruit=Draug,Banebow,Death Knight,Spectre,Nightgaunt,Ghast
        name= _ "Cave Guardian"
        [modifications]
            [object]
                [effect]
                    apply_to=defense
                    replace=true
                    [defense]
                        frozen=30
                        shallow_water=30
                        coastal_reef=30
                        flat=20
                        castle=20
                        village=20
                        forest=20
                        cave=20
                        hills=20
                        mountains=20
                        mushroom_groove=20
                        swamp=30
                        sand=30
                    [/defense]
                [/effect]
                [effect]
                    apply_to=attack
                    increase_damage=70%
                [/effect]
                [effect]
                    apply_to=hitpoints
                    increase_total=120%
                [/effect]
            [/object]
        [/modifications]
        disallow_observers=yes
        controller="ai"
        village_gold=0
        income=-2
        {FLAG_VARIANT undead}
        {ENEMY_AI}
    [/side]
    [side]
        side=7
        canrecruit=yes
        team_name="evil"
        user_team_name= _ "teamname^Evil"
        allow_player=no
        color=black
        gold=0
        type=Corrupted Elvish Champion
        recruit=Corrupted Elvish Fighter,Corrupted Elvish Scout, Spell Eater
        id=Forest Guardian
        name= _ "Forest Guardian"
        disallow_observers=yes
        controller="ai"
        village_gold=0
        income=-2
        {FLAG_VARIANT undead}
        {ENEMY_AI}
    [/side]
    [side]
        side=8
        canrecruit=yes
        team_name="evil"
        user_team_name= _ "teamname^Evil"
        allow_player=no
        color=black
        type=Ice Dragon
        id=Ice Guardian
        name= _ "Ice Guardian"
        recruit=Yeti,Ice Spirit,Ice Wraith
        disallow_observers=yes
        controller="ai"
        gold=0
        village_gold=0
        income=-2
        {FLAG_VARIANT undead}
        [modifications]
            [object]
                [effect]
                    apply_to=attack
                    increase_damage=70%
                [/effect]
                [effect]
                    apply_to=hitpoints
                    increase_total=120%
                [/effect]
            [/object]
        [/modifications]
        {ENEMY_AI}
    [/side]
    [side]
        side=9
        canrecruit=yes
        team_name="evil"
        user_team_name= _ "teamname^Evil"
        allow_player=no
        color=black
        type=Fire Dragon loti
        recruit=Inferno Drake,Drake Warden,Drake Blademaster,Drake Enforcer
        id=Fire Guardian
        name= _ "Fire Guardian"
        disallow_observers=yes
        controller="ai"
        gold=0
        village_gold=0
        income=-2
        {FLAG_VARIANT undead}
        [modifications]
            [object]
                [effect]
                    apply_to=attack
                    increase_damage=70%
                [/effect]
                [effect]
                    apply_to=hitpoints
                    increase_total=120%
                [/effect]
            [/object]
        [/modifications]
        {ENEMY_AI}
    [/side]

    [event]
        name=prestart
        [objectives]
            [objective]
                description= _ "Defeat the Shadowlord"
                condition=win
            [/objective]
            [note]
                description= _ "You cannot lose, but the enemy spawns may get too strong to handle if you will not do well"
            [/note]
        [/objectives]
    [/event]
    [event]
        name=side turn
        first_time_only=no
        [if]
            [variable]
                name=side_number
                equals=1
            [/variable]
            [then]
                {VARIABLE difficulty.act1 0}
                {VARIABLE difficulty.act2 0}
                {VARIABLE difficulty.act3 0}
                {VARIABLE difficulty.act4 0}
                {VARIABLE side_calculated 1}
                [while]
                    [variable]
                        name=side_calculated
                        less_than_equal_to=5
                    [/variable]
                    [do]
                        [if]
                            [variable]
                                name=difficulty[$side_calculated].act
                                equals=1
                            [/variable]
                            [then]
                                {VARIABLE_OP difficulty.act1 add "$($difficulty[$side_calculated].base * $difficulty[$side_calculated].multiply /100)"}
                            [/then]
                        [/if]
                        [if]
                            [variable]
                                name=difficulty[$side_calculated].act
                                equals=2
                            [/variable]
                            [then]
                                {VARIABLE_OP difficulty.act2 add "$($difficulty[$side_calculated].base * $difficulty[$side_calculated].multiply /100)"}
                            [/then]
                        [/if]
                        [if]
                            [variable]
                                name=difficulty[$side_calculated].act
                                equals=3
                            [/variable]
                            [then]
                                {VARIABLE_OP difficulty.act3 add "$($difficulty[$side_calculated].base * $difficulty[$side_calculated].multiply /100)"}
                            [/then]
                        [/if]
                        [if]
                            [variable]
                                name=difficulty[$side_calculated].act
                                equals=4
                            [/variable]
                            [then]
                                {VARIABLE_OP difficulty.act4 add "$($difficulty[$side_calculated].base * $difficulty[$side_calculated].multiply /100)"}
                            [/then]
                        [/if]
                        [if]
                            [variable]
                                name=difficulty[$side_calculated].kills
                                greater_than_equal_to=20
                            [/variable]
                            [and]
                                [variable]
                                    name=difficulty[$side_calculated].kills
                                    less_than=50
                                [/variable]
                            [/and]
                            [then]
                                {VARIABLE difficulty[$side_calculated].multiply 150)}
                            [/then]
                        [/if]
                        [if]
                            [variable]
                                name=difficulty[$side_calculated].kills
                                greater_than_equal_to=50
                            [/variable]
                            [and]
                                [variable]
                                    name=difficulty[$side_calculated].kills
                                    less_than=100
                                [/variable]
                            [/and]
                            [then]
                                {VARIABLE difficulty[$side_calculated].multiply 230)}
                            [/then]
                        [/if]
                        [if]
                            [variable]
                                name=difficulty[$side_calculated].kills
                                greater_than_equal_to=100
                            [/variable]
                            [and]
                                [variable]
                                    name=difficulty[$side_calculated].kills
                                    less_than=200
                                [/variable]
                            [/and]
                            [then]
                                {VARIABLE difficulty[$side_calculated].multiply 320)}
                            [/then]
                        [/if]
                        [if]
                            [variable]
                                name=difficulty[$side_calculated].kills
                                greater_than_equal_to=200
                            [/variable]
                            [and]
                                [variable]
                                    name=difficulty[$side_calculated].kills
                                    less_than=350
                                [/variable]
                            [/and]
                            [then]
                                {VARIABLE difficulty[$side_calculated].multiply 450)}
                            [/then]
                        [/if]
                        [if]
                            [variable]
                                name=difficulty[$side_calculated].kills
                                greater_than_equal_to=350
                            [/variable]
                            [and]
                                [variable]
                                    name=difficulty[$side_calculated].kills
                                    less_than=500
                                [/variable]
                            [/and]
                            [then]
                                {VARIABLE difficulty[$side_calculated].multiply 600)}
                            [/then]
                        [/if]
                        [if]
                            [variable]
                                name=difficulty[$side_calculated].kills
                                greater_than_equal_to=500
                            [/variable]
                            [then]
                                {VARIABLE difficulty[$side_calculated].multiply 800)}
                            [/then]
                        [/if]
                        [set_variable]
                            name=side_calculated
                            add=1
                        [/set_variable]
                    [/do]
                [/while]
                {CLEAR_VARIABLE side_calculated}
                {VARIABLE difficulty.overall "$($difficulty.act1 + $difficulty.act2 + $difficulty.act3 + $difficulty.act4)"}
            [/then]
        [/if]
    [/event]
    [event]
        name=start
        [micro_ai]
            side=6
            ai_type=fast_ai
            action=add
        [/micro_ai]
        [micro_ai]
            side=7
            ai_type=fast_ai
            action=add
        [/micro_ai]
        [micro_ai]
            side=8
            ai_type=fast_ai
            action=add
        [/micro_ai]
        [micro_ai]
            side=9
            ai_type=fast_ai
            action=add
        [/micro_ai]
        [message]
            caption= _"Hordes of the Other World"
            speaker=narrator
            image=wesnoth-icon.png
            message= _ "This is a multiplayer one-scenario campaign. At the beginning, you will choose your difficulty. The difficulty affects almost everything, and is calculated as the sum of the difficulties of all players in the Act or of the difficulties of all players.

The campaign is divided into 4 acts, loads of enemies are filling the areas and will attack when you approach them, so it may be good to step back to prevent alerting too many enemies. Other enemies are just coming, and when you approach a boss, he will start recruiting as a regular enemy leader.

You can choose at any time to move into one of discovered keeps, and you also have to travel into one of the keeps when you leader is close to death.

There is <b>no upkeep and no gold gain, although it shows differently</b>, you can obtain gold from chests that are quite numerous."
        [/message]
        [chat]
            speaker="Efraim"
            message= _"So, this is the land we were supposed to save. The corruption of this place seems to be... strong."
        [/chat]
        [set_menu_item]
            id=xtravel
            description= _ "Move to keep"
            [command]
                {VARIABLE may_stay 1}
                [fire_event]
                    name=travel
                [/fire_event]
            [/command]
        [/set_menu_item]
        #Variable initialisation
        {VARIABLE difficulty.act1 0}
        {VARIABLE difficulty.act2 0}
        {VARIABLE difficulty.act3 0}
        {VARIABLE difficulty.act4 0}
        {VARIABLE difficulty.overall 0}
        {VARIABLE difficulty[1].base 60}
        {VARIABLE difficulty[1].multiply 100}
        {VARIABLE difficulty[1].act 1}
        {VARIABLE difficulty[1].kills 0}
        {VARIABLE difficulty[2].base 60}
        {VARIABLE difficulty[2].multiply 100}
        {VARIABLE difficulty[2].act 1}
        {VARIABLE difficulty[2].kills 0}
        {VARIABLE difficulty[3].base 60}
        {VARIABLE difficulty[3].multiply 100}
        {VARIABLE difficulty[3].act 1}
        {VARIABLE difficulty[3].kills 0}
        {VARIABLE difficulty[4].base 60}
        {VARIABLE difficulty[4].multiply 100}
        {VARIABLE difficulty[4].act 1}
        {VARIABLE difficulty[4].kills 0}
        {VARIABLE difficulty[5].base 60}
        {VARIABLE difficulty[5].multiply 100}
        {VARIABLE difficulty[5].act 1}
        {VARIABLE difficulty[5].kills 0}

        [set_variables]
            name=spawn_list
            mode=replace
            [value]
                #ENEMY SPAWNS
                #Act 1
                {A1_SAURIAN_SPAWN 7 179 5}
                {A1_SAURIAN_SPAWN 1 171 6}
                {A1_SAURIAN_SPAWN 21 177 6}
                {A1_SAURIAN_SPAWN 13 184 5}
                {A1_LESSER_ORCISH_SPAWN 41 195 5}
                {A1_TROLL_SPAWN 50 197 6}
                {A1_LESSER_ORCISH_SPAWN 39 180 6}
                {A1_LESSER_ORCISH_SPAWN 34 169 6}
                {A1_WOLF_SPAWN 21 169 4}
                {A1_LESSER_ORCISH_SPAWN 59 196 5}
                {A1_LESSER_ORCISH_SPAWN 31 166 5}
                {A1_WOLF_SPAWN 34 161 6}
                {A1_LESSER_ORCISH_SPAWN 47 162 7}
                {A1_LESSER_ORCISH_SPAWN 47 172 7}
                {A1_GOBLIN_SPAWN 39 159 13}
                {A1_TROLL_SPAWN 59 161 6}
                {A1_LESSER_ORCISH_SPAWN 76 168 8}
                {A1_GOBLIN_SPAWN 70 176 7}
                {A1_LESSER_ORCISH_SPAWN 59 180 6}
                {A1_GREATER_GOBLIN_SPAWN 65 199 9}
                {A1_LESSER_ORCISH_SPAWN 71 184 10}
                {A1_LESSER_ORCISH_SPAWN 61 185 8}
                {A1_WOLF_SPAWN 21 155 8}
                {A1_WOLF_SPAWN 15 147 7}
                {A1_LESSER_ORCISH_SPAWN 31 151 9}
                {A1_ORCISH_SPAWN 41 146 9}
                {A1_WOLF_SPAWN 43 136 11}
                {A1_WOLF_SPAWN 11 140 9}
                {A1_WOLF_SPAWN 99 195 7}
                {A1_WOLF_SPAWN 111 184 8}
                {A1_DESERT_SPAWN 81 197 9}
                {A1_DESERT_SPAWN 82 186 8}
                {A1_GOBLIN_SPAWN 93 183 7}
                {A1_DESERT_SPAWN 90 193 7}
                {A1_DESERT_SPAWN 107 196 8}
                {A1_DESERT_SPAWN 122 192 7}
                {A1_DESERT_SPAWN 112 197 6}
                {A1_LESSER_ORCISH_SPAWN 105 173 6}
                {A1_LESSER_ORCISH_SPAWN 87 174 9}
                {A1_ORCISH_SPAWN 2 128 6}
                {A1_LESSER_UNDEAD_SPAWN 12 123 6}
                {A1_TROLL_SPAWN 24 127 6}
                {A1_ORCISH_SPAWN 6 117 5}
                {A1_GOBLIN_SPAWN 23 120 13}
                {A1_ORCISH_SPAWN 26 137 5}
                {A1_LESSER_ORCISH_SPAWN 389 123 12}
                {A1_GREATER_ORCISH_SPAWN 43 124 4}
                {A1_LESSER_UNDEAD_SPAWN 57 122 7}
                {A1_LESSER_ORCISH_SPAWN 71 138 8}
                {A1_ORCISH_SPAWN 73 125 4}
                {A1_GREATER_GOBLIN_SPAWN 63 145 5}
                {A1_ORCISH_SPAWN 77 145 6}
                {A1_GREATER_ORCISH_SPAWN 74 151 5}
                {A1_ORCISH_SPAWN 89 150 6}
                {A1_GREATER_TROLL_SPAWN 92 160 3}
                {A1_ORCISH_SPAWN 101 154 5}
                {A1_TROLL_SPAWN 118 152 7}
                {A1_UNDEAD_SPAWN 128 161 7}
                {A1_LESSER_ORCISH_SPAWN 133 154 11}
                {A1_ORCISH_SPAWN 134 170 5}
                {A1_GOBLIN_SPAWN 142 181 14}
                {A1_ORCISH_SPAWN 149 189 5}
                {A1_LESSER_ORCISH_SPAWN 135 192 13}
                {A1_GREATER_GOBLIN_SPAWN 172 197 6}
                {A1_ORCISH_SPAWN 158 177 4}
                {A1_GREATER_ORCISH_SPAWN 5 108 5}
                {A1_GREATER_TROLL_SPAWN 5 115 4}
                {A1_GREATER_ORCISH_SPAWN 25 98 4}
                {A1_GREATER_GOBLIN_SPAWN 44 102 10}
                {A1_LESSER_ORCISH_SPAWN 34 111 14}
                {A1_GREATER_ORCISH_SPAWN 49 111 4}
                {A1_GREATER_UNDEAD_SPAWN 41 118 5}
                {A1_UNDEAD_SPAWN 51 100 7}
                {A1_GREATER_ORCISH_SPAWN 60 107 6}
                {A1_ORCISH_SPAWN 62 116 6}
                {A1_GREATER_ORCISH_SPAWN 71 100 4}
                {A1_GREATER_TROLL_SPAWN 98 98 4}
                {A1_TROLL_SPAWN 94 120 5}
                {A1_GREATER_ORCISH_SPAWN 99 131 4}
                {A1_BAT_SPAWN 99 143 8}
                {A1_GREATER_ORCISH_SPAWN 105 148 6}
                {A1_GOBLIN_SPAWN 105 98 14}
                {A1_GREATER_ORCISH_SPAWN 108 112 5}
                {A1_ORCISH_SPAWN 115 117 6}
                {A1_GREATER_UNDEAD_SPAWN 101 131 5}
                {A1_GREATER_TROLL_SPAWN 101 144 4}
                {A1_GREATER_ORCISH_SPAWN 104 154 4}
                {A1_BAT_SPAWN 116 98 9}
                {A1_BAT_SPAWN 123 100 10}
                {A1_BAT_SPAWN 120 108 9}
                {A1_BAT_SPAWN 134 107 11}
                {A1_BAT_SPAWN 127 99 10}
                {A1_BAT_SPAWN 129 100 11}
                {A1_BAT_SPAWN 141 99 12}
                {A1_BAT_SPAWN 141 108 11}
                {A1_GREATER_TROLL_SPAWN 153 113 5}
                {A1_GREATER_ORCISH_SPAWN 156 124 6}
                {A1_ORCISH_SPAWN 155 139 8}
                {A1_LESSER_ORCISH_SPAWN 129 123 11}
                {A1_GREATER_ORCISH_SPAWN 137 132 4}
                {A1_UNDEAD_SPAWN 156 136 7}
                {A1_LESSER_UNDEAD_SPAWN 159 151 6}
                {A1_GREATER_ORCISH_SPAWN 133 144 4}
                {A1_GREATER_GOBLIN_SPAWN 154 147 6}
                {A1_ORCISH_SPAWN 150 167 6}
                {A1_GREATER_ORCISH_SPAWN 161 168 5}
                {A1_ORCISH_SPAWN 196 150 6}
                {A1_GREATER_ORCISH_SPAWN 186 156 4}
                {A1_BAT_SPAWN 165 157 11}
                {A1_GREATER_ORCISH_SPAWN 174 166 5}
                {A1_ORCISH_SPAWN 169 177 7}
                {A1_GOBLIN_SPAWN 180 185 14}
                {A1_ORCISH_SPAWN 194 195 7}
                {A1_GREATER_ORCISH_SPAWN 175 197 5}
                {A1_TROLL_SPAWN 157 185 6}

                #Act2
                {A2_ORCISH_SPAWN 185 78 4}
                {A2_ORCISH_SPAWN 189 71 3}
                {A2_ORCISH_SPAWN 168 71 3}
                {A2_ORCISH_SPAWN 167 64 4}
                {A2_ORCISH_SPAWN 192 62 5}
                {A2_ORCISH_SPAWN 164 54 5}
                {A2_UNDEAD_SPAWN 186 50 7}
                {A2_ORCISH_SPAWN 195 49 3}
                {A2_ORCISH_SPAWN 192 34 3}
                {A2_ORCISH_SPAWN 160 71 2}
                {A2_ORCISH_SPAWN 152 65 5}
                {A2_UNDEAD_SPAWN 145 54 9}
                {A2_ORCISH_SPAWN 136 64 4}
                {A2_ORCISH_SPAWN 143 54 5}
                {A2_ORCISH_SPAWN 120 52 5}
                {A2_GREATER_ORCISH_SPAWN 154 37 4}
                {A2_GREATER_ORCISH_SPAWN 168 37 5}
                {A2_GREATER_ORCISH_SPAWN 185 37 6}
                {A2_UNDEAD_SPAWN 194 32 10}
                {A2_GREATER_ORCISH_SPAWN 193 22 5}
                {A2_GREATER_ORCISH_SPAWN 159 28 5}
                {A2_BANDIT_SPAWN 150 23 11}
                {A2_GREATER_ORCISH_SPAWN 149 20 3}
                {A2_GREATER_ORCISH_SPAWN 167 16 4}
                {A2_UNDEAD_SPAWN 184 16 12}
                {A2_GREATER_ORCISH_SPAWN 193 12 7}
                {A2_GREATER_ORCISH_SPAWN 120 15 4}
                {A2_GREATER_ORCISH_SPAWN 110 18 3}
                {A2_GREATER_ORCISH_SPAWN 124 27 6}
                {A2_GREATER_ORCISH_SPAWN 126 36 5}
                {A2_GREATER_ORCISH_SPAWN 135 43 3}
                {A2_BANDIT_SPAWN 196 5 9}
                {A2_ELF_SPAWN 169 85 4}
                {A2_ELF_SPAWN 157 87 5}
                {A2_ELF_SPAWN 140 79 4}
                {A2_BANDIT_SPAWN 132 85 14}
                {A2_ELF_SPAWN 121 83 4}
                {A2_ELF_SPAWN 113 74 3}
                {A2_ELF_SPAWN 111 64 5}
                {A2_GREATER_ELF_SPAWN 105 82 4}
                {A2_GREATER_ELF_SPAWN 94 82 5}
                {A2_BANDIT_SPAWN 98 75 9}
                {A2_GREATER_ELF_SPAWN 95 70 3}
                {A2_GREATER_ELF_SPAWN 103 67 7}
                {A2_UNDEAD_SPAWN 97 62 11}
                {A2_GREATER_ELF_SPAWN 92 55 6}
                {A2_NAGA_SPAWN 177 3 4}
                {A2_NAGA_SPAWN 163 2 5}
                {A2_NAGA_SPAWN 138 2 4}
                {A2_NAGA_SPAWN 113 3 3}
                {A2_NAGA_SPAWN 100 3 5}
                {A2_NAGA_SPAWN 95 7 3}
                {A2_NAGA_SPAWN 89 10 6}
                {A2_NAGA_SPAWN 80 10 3}
                {A2_NAGA_SPAWN 81 6 4}
                {A2_NAGA_SPAWN 77 3 5}
                {A2_SAURIAN_SPAWN 136 32 13}
                {A2_SAURIAN_SPAWN 138 26 13}
                {A2_SAURIAN_SPAWN 135 18 14}
                {A2_SAURIAN_SPAWN 108 41 12}
                {A2_BANDIT_SPAWN 66 5 9}
                {A2_BANDIT_SPAWN 72 15 11}
                {A2_UNDEAD_SPAWN 86 20 9}
                {A2_UNDEAD_SPAWN 100 26 13}
                {A2_BANDIT_SPAWN 100 37 8}
                {A2_UNDEAD_SPAWN 104 47 10}
                {A2_BANDIT_SPAWN 105 51 9}
                {A2_BANDIT_SPAWN 103 36 14}
                {A2_UNDEAD_SPAWN 142 57 13}
                {A2_BANDIT_SPAWN 121 46 11}
                {A2_UNDEAD_SPAWN 103 25 9}
                {A2_BANDIT_SPAWN 102 18 12}
                {A2_BLACK_SOUL_SPAWN 67 21 4}
                {A2_BLACK_SOUL_SPAWN 69 26 4}
                {A2_BLACK_SOUL_SPAWN 61 34 4}
                {A2_BLACK_SOUL_SPAWN 70 40 4}
                {A2_BLACK_SOUL_SPAWN 62 46 4}
                {A2_BLACK_SOUL_SPAWN 71 56 4}
                {A2_BLACK_SOUL_SPAWN 62 63 4}
                {A2_BLACK_SOUL_SPAWN 66 70 4}
                {A2_BLACK_SOUL_SPAWN 60 75 4}
                {A2_BLACK_SOUL_SPAWN 66 81 4}

                #Act3
                {A3_LESSER_BLACK_SOUL_SPAWN 42 17 6}
                {A3_LESSER_BLACK_SOUL_SPAWN 35 10 6}
                {A3_LESSER_BLACK_SOUL_SPAWN 28 15 7}
                {A3_LESSER_BLACK_SOUL_SPAWN 25 14 5}
                {A3_LESSER_BLACK_SOUL_SPAWN 18 4 6}
                {A3_LESSER_BLACK_SOUL_SPAWN 9 8 7}
                {A3_LESSER_BLACK_SOUL_SPAWN 6 15 5}
                {A3_LESSER_BLACK_SOUL_SPAWN 10 22 4}
                {A3_LESSER_BLACK_SOUL_SPAWN 11 28 6}
                {A3_DEMON_SPAWN 5 30 4}
                {A3_BLACK_SOUL_SPAWN 15 33 5}
                {A3_DEMON_SPAWN 29 33 4}
                {A3_GREATER_DEMON_SPAWN 44 34 6}
                {A3_DEMON_SPAWN 40 44 4}
                {A3_DEMON_SPAWN 41 60 3}
                {A3_GREATER_DEMON_SPAWN 30 40 6}
                {A3_BLACK_SOUL_SPAWN 6 40 4}
                {A3_DEMON_SPAWN 3 45 4}
                {A3_DEMON_SPAWN 12 60 4}
                {A3_GREATER_DEMON_SPAWN 17 67 6}
                {A3_GREATER_DEMON_SPAWN 43 65 5}
                {A3_DEMON_SPAWN 28 65 4}
                {A3_GREATER_DEMON_SPAWN 3 65 4}
                {A3_GREATER_DEMON_SPAWN 18 73 5}
                {A3_GREATER_DEMON_SPAWN 9 77 6}
                {A3_BLACK_SOUL_SPAWN 8 85 4}
                {A3_GREATER_BLACK_SOUL_SPAWN 21 89 3}
                {A3_BLACK_SOUL_SPAWN 22 88 5}
                {A3_BLACK_SOUL_SPAWN 29 90 4}
                {A3_GREATER_DEMON_SPAWN 38 89 7}
                {A3_GREATER_BLACK_SOUL_SPAWN 45 86 4}

                #Act4
                {A4_BLACK_SOUL_SPAWN 184 102 5}
                {A4_BLACK_SOUL_SPAWN 166 97 4}
                {A4_BLACK_SOUL_SPAWN 168 113 5}
                {A4_BLACK_SOUL_SPAWN 184 119 4}
                {A4_BLACK_SOUL_SPAWN 187 125 6}
                {A4_BLACK_SOUL_SPAWN 196 133 6}
                {A4_BLACK_SOUL_SPAWN 165 135 7}
            [/value]
        [/set_variables]
        {FOREACH spawns.spawn i}
            {VARIABLE spawn_list.spawn[$i].free 1}
        {NEXT i}
        {PLACE_SPAWNS 1}

        #Treasures - their deposition takes quite long, so let's spread the chat between them.
        {GOLD_CHEST 40 170}
        {RARE_ITEM 68 183}
        {GOLD_CHEST 109 172}
        {RARE_ITEM 23 187}
        {GOLD_CHEST 71 199}
        {RARE_ITEM 83 172}
        {GOLD_CHEST 30 95}
        {RARE_ITEM 19 99}
        {GOLD_CHEST 35 97}
        {RARE_ITEM 36 97}
        {GOLD_CHEST 34 97}
        {RARE_ITEM 34 96}
        {GOLD_CHEST 36 96}
        {RARE_ITEM 35 96}
        {GOLD_CHEST 37 95}
        {RARE_ITEM 105 95}
        {GOLD_CHEST 63 98}
        {RARE_ITEM 64 98}
        {GOLD_CHEST 93 96}
        {RARE_ITEM 128 100}
        {GOLD_CHEST 140 112}
        {RARE_ITEM 142 112}
        {GOLD_CHEST 138 111}
        {RARE_ITEM 139 113}
        {GOLD_CHEST 140 113}
        {RARE_ITEM 139 112}
        {GOLD_CHEST 77 129}
        {GOLD_CHEST 4 129}
        {RARE_ITEM 61 135}
        {GOLD_CHEST 29 133}
        {RARE_ITEM 56 127}
        {GOLD_CHEST 57 141}
        {RARE_ITEM 59 139}
        {GOLD_CHEST 56 140}
        {RARE_ITEM 58 139}
        {GOLD_CHEST 53 148}
        {RARE_ITEM 55 148}
        {GOLD_CHEST 51 149}
        {RARE_ITEM 56 149}
        {GOLD_CHEST 53 149}
        {RARE_ITEM 50 149}
        {GOLD_CHEST 74 148}
        {RARE_ITEM 98 149}
        {GOLD_CHEST 119 167}
        {RARE_ITEM 123 167}
        {GOLD_CHEST 117 169}
        {RARE_ITEM 123 168}

        [chat]
            speaker="Lethalia"
            message= _"(casts some sort of spell) They invaded this land using a portal, but because they were not sure if we will not get through it, they sealed it. There are four seals, each of them has one Guardian. Only all of them together can open it, and if one of them dies, the seal is open, because otherwise it would prevent them from returning. They consider killing any of them impossible."
        [/chat]

        {GOLD_CHEST 121 169}
        {RARE_ITEM 125 173}
        {GOLD_CHEST 123 173}
        {RARE_ITEM 134 196}
        {GOLD_CHEST 146 196}
        {RARE_ITEM 148 196}
        {GOLD_CHEST 149 194}
        {RARE_ITEM 146 197}
        {GOLD_CHEST 188 199}
        {RARE_ITEM 199 196}
        {GOLD_CHEST 197 161}
        {RARE_ITEM 150 121}
        {GOLD_CHEST 141 113}
        {RARE_ITEM 138 111}
        {GOLD_CHEST 139 112}
        {RARE_ITEM 141 112}
        {GOLD_CHEST 184 166}
        {RARE_ITEM 144 139}
        {GOLD_CHEST 100 90}
        {RARE_ITEM 77 34}
        {GOLD_CHEST 199 2}
        {RARE_ITEM 157 25}
        {GOLD_CHEST 109 19}
        {RARE_ITEM 77 76}
        {GOLD_CHEST 78 75}
        {RARE_ITEM 76 75}
        {GOLD_CHEST 78 76}
        {RARE_ITEM 76 76}
        {GOLD_CHEST 77 77}
        {RARE_ITEM 3 4}
        {GOLD_CHEST 15 3}
        {RARE_ITEM 36 50}
        {GOLD_CHEST 48 61}
        {RARE_ITEM 26 75}
        {GOLD_CHEST 13 93}
        {RARE_ITEM 1 91}
        {GOLD_CHEST 69 91}
        {RARE_ITEM 68 89}
        {GOLD_CHEST 70 91}
        {RARE_ITEM 76 81}
        {GOLD_CHEST 76 82}
        {RARE_ITEM 95 92}
        {GOLD_CHEST 94 92}
        {RARE_ITEM 93 92}
        {GOLD_CHEST 82 91}
        {RARE_ITEM 80 91}
        {GOLD_CHEST 162 124}
        {RARE_ITEM 161 126}
        {GOLD_CHEST 161 125}
        {RARE_ITEM 162 125}
        {GOLD_CHEST 160 141}
        {RARE_ITEM 161 141}
        {GOLD_CHEST 160 140}
        {RARE_ITEM 161 140}
        {GOLD_CHEST 160 139}
        {RARE_ITEM 161 139}
        {GOLD_CHEST 162 139}
        {GOLD_CHEST 108 101}
        {RARE_ITEM 107 102}
        {GOLD_CHEST 108 102}
        {RARE_ITEM 31 124}

        [chat]
            speaker="Argan"
            message= _"The creatures here don't seem to be friendly, they are misguided by this evil. There will be no chance to get an agreement of any kind with them. We will have to slaughter them mercilessly."
        [/chat]
    [/event]
    #Decoration
    {PLACE_IMAGE items/orcish-flag.png 11 135}
    {PLACE_IMAGE items/orcish-flag.png 8 135}
    {PLACE_IMAGE items/orcish-flag.png 9 130}
    {PLACE_IMAGE items/orcish-flag.png 50 137}
    {PLACE_IMAGE items/orcish-flag.png 53 136}
    {PLACE_IMAGE items/orcish-flag.png 74 163}
    {PLACE_IMAGE items/orcish-flag.png 85 159}
    {PLACE_IMAGE items/orcish-flag.png 125 185}
    {PLACE_IMAGE items/orcish-flag.png 129 182}
    {PLACE_IMAGE items/orcish-flag.png 134 180}
    {PLACE_IMAGE items/orcish-flag.png 142 169}
    {PLACE_IMAGE items/orcish-flag.png 185 192}
    {PLACE_IMAGE items/orcish-flag.png 138 132}
    {PLACE_IMAGE items/orcish-flag.png 39 117}
    {PLACE_IMAGE items/orcish-flag.png 180 53}
    {PLACE_IMAGE items/orcish-flag.png 159 40}
    {PLACE_IMAGE items/orcish-flag.png 134 169}
    {PLACE_IMAGE items/orcish-flag.png 122 19}
    {PLACE_IMAGE items/orcish-flag.png 180 25}
    {PLACE_IMAGE items/orcish-flag.png 168 20}
    {PLACE_IMAGE items/burial.png 8 130}
    {PLACE_IMAGE items/burial.png 19 127}
    {PLACE_IMAGE items/burial.png 51 133}
    {PLACE_IMAGE items/burial.png 49 138}
    {PLACE_IMAGE items/burial.png 80 160}
    {PLACE_IMAGE items/burial.png 87 157}
    {PLACE_IMAGE items/burial.png 128 182}
    {PLACE_IMAGE items/burial.png 144 186}
    {PLACE_IMAGE items/burial.png 161 198}
    {PLACE_IMAGE items/burial.png 163 157}
    {PLACE_IMAGE items/burial.png 152 132}
    {PLACE_IMAGE items/burial.png 132 128}
    {PLACE_IMAGE items/burial.png 111 109}
    {PLACE_IMAGE items/burial.png 20 107}
    {PLACE_IMAGE items/burial.png 8 102}
    {PLACE_IMAGE items/burial.png 170 28}
    {PLACE_IMAGE items/burial.png 173 19}
    {PLACE_IMAGE items/bonestack.png 171 26}
    {PLACE_IMAGE items/bonestack.png 171 22}
    {PLACE_IMAGE items/bonestack.png 16 100}
    {PLACE_IMAGE items/bonestack.png 10 123}
    {PLACE_IMAGE items/bonestack.png 61 130}
    {PLACE_IMAGE items/bonestack.png 85 157}
    {PLACE_IMAGE items/bonestack.png 131 181}
    {PLACE_IMAGE items/bonestack.png 153 152}
    {PLACE_IMAGE items/bonestack.png 123 124}
    {PLACE_IMAGE items/bones.png 79 194}
    {PLACE_IMAGE items/bones.png 100 197}
    {PLACE_IMAGE items/bones.png 93 130}
    {PLACE_IMAGE items/bones.png 94 179}
    {PLACE_IMAGE items/bones.png 107 177}
    {PLACE_IMAGE items/bones.png 120 186}
    {PLACE_IMAGE items/bones.png 106 188}
    {PLACE_IMAGE items/bones.png 110 199}
    {PLACE_IMAGE items/bones.png 93 138}
    {PLACE_IMAGE items/bones.png 157 33}
    {PLACE_IMAGE items/bones.png 64 53}
    {PLACE_IMAGE items/straw-bale1.png 153 10}
    {PLACE_IMAGE items/straw-bale2.png 154 14}
    {PLACE_IMAGE items/straw-bale1.png 138 13}
    {PLACE_IMAGE items/straw-bale2.png 130 9}
    {PLACE_IMAGE items/straw-bale1.png 129 6}
    {PLACE_IMAGE scenery/dwarven-doors-closed.png 74 35}
    {PLACE_IMAGE scenery/lighthouse.png 123 1}
    {PLACE_IMAGE scenery/lighthouse.png 145 2}
    {PLACE_IMAGE scenery/lighthouse.png 84 1}
    {PLACE_IMAGE scenery/icepack-1.png 63 80}
    {PLACE_IMAGE scenery/rock3.png 146 53}
    {PLACE_IMAGE scenery/well.png 147 10}
    {PLACE_IMAGE scenery/portal-red.png 51 97}
    {PLACE_IMAGE scenery/portal-red.png 57 90}

    #Keeps
    {KEEP_DISCOVER 21 147 "Act1 - Forest Keep" k11}
    {KEEP_DISCOVER 99 182 "Act1 - Desert Keep" k12}
    {KEEP_DISCOVER 111 118 "Act1 - Central Cave Keep" k13}
    {KEEP_DISCOVER 135 129 "Act1 - Northeast Cave Keep" k14}
    {KEEP_DISCOVER 139 159 "Act1 - Southern Cave Keep" k15}
    {KEEP_DISCOVER 147 179 "Act1 - Near-Desert Cave Keep" k16}
    {KEEP_DISCOVER 13 99 "Act1 - Cave Guardian's Keep" k17}
    {KEEP_DISCOVER 79 109 "Act1 - Forest Guardian's Keep" k18}
    {KEEP_DISCOVER 158 96 "Act1 - Fire Guardian's Keep" k19}
    {KEEP_DISCOVER 196 169 "Act1 - Ice Guardian's Keep" k20}
    {KEEP_DISCOVER 137 41 "Act2 - Central Keep" k22}
    {KEEP_DISCOVER 175 24 "Act2 - Orcish Keep" k23}
    {KEEP_DISCOVER 108 40 "Act2 - Swamp Keep" k24}
    {KEEP_DISCOVER 145 7 "Act2 - City Keep" k25}
    {KEEP_DISCOVER 85 82 "Act2 - Elven Keep" k26}
    {KEEP_DISCOVER 90 2 "Act2 - Naga Keep" k27}
    {KEEP_DISCOVER 66 93 "Act2 - Mountain Keep" k28}
    {KEEP_DISCOVER 59 87 "Act2 - Fortress of Ultimate Darkness" k29}
    {KEEP_DISCOVER 16 13 "Act3 - Courtyard Entrance Keep" k31}
    {KEEP_DISCOVER 23 56 "Act3 - Courtyard Keep" k32}
    {KEEP_DISCOVER 5 76 "Act3 - Inner Fortress Entrance Keep" k33}
    {KEEP_DISCOVER 51 82 "Act3 - Shadowlord's Keep" k34}

    [event]
        name=spawn_enemy
        first_time_only=no
        {VARIABLE spawn_count $spawn.number}
        [if]
            [variable]
                name=$spawn.act
                equals=1
            [/variable]
            [then]
                [if]
                    [variable]
                        name=difficulty.overall
                        greater_than=500
                    [/variable]
                    [then]
                        {VARIABLE_OP spawn_count add $spawn.increment}
                    [/then]
                [/if]
                [if]
                    [variable]
                        name=difficulty.overall
                        greater_than=600
                    [/variable]
                    [then]
                        {VARIABLE_OP spawn_count add $spawn.increment}
                    [/then]
                [/if]
                [if]
                    [variable]
                        name=difficulty.overall
                        greater_than=700
                    [/variable]
                    [then]
                        {VARIABLE_OP spawn_count add $spawn.increment}
                    [/then]
                [/if]
                [if]
                    [variable]
                        name=difficulty.overall
                        greater_than=800
                    [/variable]
                    [then]
                        {VARIABLE_OP spawn_count add $spawn.increment}
                    [/then]
                [/if]
                [if]
                    [variable]
                        name=difficulty.overall
                        greater_than=900
                    [/variable]
                    [then]
                        {VARIABLE_OP spawn_count add $spawn.increment}
                    [/then]
                [/if]
                [if]
                    [variable]
                        name=difficulty.overall
                        greater_than=1200
                    [/variable]
                    [then]
                        {VARIABLE_OP spawn_count add $spawn.increment}
                    [/then]
                [/if]
                [if]
                    [variable]
                        name=difficulty.overall
                        greater_than=1600
                    [/variable]
                    [then]
                        {VARIABLE_OP spawn_count add $spawn.increment}
                    [/then]
                [/if]
                [if]
                    [variable]
                        name=difficulty.overall
                        greater_than=2000
                    [/variable]
                    [then]
                        {VARIABLE_OP spawn_count add $spawn.increment}
                    [/then]
                [/if]
                [if]
                    [variable]
                        name=difficulty.overall
                        greater_than=2400
                    [/variable]
                    [then]
                        {VARIABLE_OP spawn_count add $spawn.increment}
                    [/then]
                [/if]
                [if]
                    [variable]
                        name=difficulty.overall
                        greater_than=2800
                    [/variable]
                    [then]
                        {VARIABLE_OP spawn_count add $spawn.increment}
                    [/then]
                [/if]
                [if]
                    [variable]
                        name=difficulty.overall
                        greater_than=3300
                    [/variable]
                    [then]
                        {VARIABLE_OP spawn_count add $spawn.increment}
                    [/then]
                [/if]
                [if]
                    [variable]
                        name=difficulty.overall
                        greater_than=3900
                    [/variable]
                    [then]
                        {VARIABLE_OP spawn_count add $spawn.increment}
                    [/then]
                [/if]
                [if]
                    [variable]
                        name=difficulty.overall
                        greater_than=4500
                    [/variable]
                    [then]
                        {VARIABLE_OP spawn_count add $spawn.increment}
                    [/then]
                [/if]
            [/then]
        [/if]
        [if]
            [variable]
                name=$spawn.act
                equals=2
            [/variable]
            [then]
                [if]
                    [variable]
                        name=difficulty.overall
                        greater_than=800
                    [/variable]
                    [then]
                        {VARIABLE_OP spawn_count add $spawn.increment}
                    [/then]
                [/if]
                [if]
                    [variable]
                        name=difficulty.overall
                        greater_than=1000
                    [/variable]
                    [then]
                        {VARIABLE_OP spawn_count add $spawn.increment}
                    [/then]
                [/if]
                [if]
                    [variable]
                        name=difficulty.overall
                        greater_than=1200
                    [/variable]
                    [then]
                        {VARIABLE_OP spawn_count add $spawn.increment}
                    [/then]
                [/if]
                [if]
                    [variable]
                        name=difficulty.overall
                        greater_than=1500
                    [/variable]
                    [then]
                        {VARIABLE_OP spawn_count add $spawn.increment}
                    [/then]
                [/if]
                [if]
                    [variable]
                        name=difficulty.overall
                        greater_than=1700
                    [/variable]
                    [then]
                        {VARIABLE_OP spawn_count add $spawn.increment}
                    [/then]
                [/if]
                [if]
                    [variable]
                        name=difficulty.overall
                        greater_than=2000
                    [/variable]
                    [then]
                        {VARIABLE_OP spawn_count add $spawn.increment}
                    [/then]
                [/if]
                [if]
                    [variable]
                        name=difficulty.overall
                        greater_than=2300
                    [/variable]
                    [then]
                        {VARIABLE_OP spawn_count add $spawn.increment}
                    [/then]
                [/if]
                [if]
                    [variable]
                        name=difficulty.overall
                        greater_than=2700
                    [/variable]
                    [then]
                        {VARIABLE_OP spawn_count add $spawn.increment}
                    [/then]
                [/if]
                [if]
                    [variable]
                        name=difficulty.overall
                        greater_than=3200
                    [/variable]
                    [then]
                        {VARIABLE_OP spawn_count add $spawn.increment}
                    [/then]
                [/if]
                [if]
                    [variable]
                        name=difficulty.overall
                        greater_than=3800
                    [/variable]
                    [then]
                        {VARIABLE_OP spawn_count add $spawn.increment}
                    [/then]
                [/if]
                [if]
                    [variable]
                        name=difficulty.overall
                        greater_than=4500
                    [/variable]
                    [then]
                        {VARIABLE_OP spawn_count add $spawn.increment}
                    [/then]
                [/if]
            [/then]
        [/if]
        [if]
            [variable]
                name=$spawn.act
                equals=3
            [/variable]
            [then]
                [if]
                    [variable]
                        name=difficulty.overall
                        greater_than=2500
                    [/variable]
                    [then]
                        {VARIABLE_OP spawn_count add $spawn.increment}
                    [/then]
                [/if]
                [if]
                    [variable]
                        name=difficulty.overall
                        greater_than=2700
                    [/variable]
                    [then]
                        {VARIABLE_OP spawn_count add $spawn.increment}
                    [/then]
                [/if]
                [if]
                    [variable]
                        name=difficulty.overall
                        greater_than=2900
                    [/variable]
                    [then]
                        {VARIABLE_OP spawn_count add $spawn.increment}
                    [/then]
                [/if]
                [if]
                    [variable]
                        name=difficulty.overall
                        greater_than=3100
                    [/variable]
                    [then]
                        {VARIABLE_OP spawn_count add $spawn.increment}
                    [/then]
                [/if]
                [if]
                    [variable]
                        name=difficulty.overall
                        greater_than=3300
                    [/variable]
                    [then]
                        {VARIABLE_OP spawn_count add $spawn.increment}
                    [/then]
                [/if]
                [if]
                    [variable]
                        name=difficulty.overall
                        greater_than=3500
                    [/variable]
                    [then]
                        {VARIABLE_OP spawn_count add $spawn.increment}
                    [/then]
                [/if]
                [if]
                    [variable]
                        name=difficulty.overall
                        greater_than=3700
                    [/variable]
                    [then]
                        {VARIABLE_OP spawn_count add $spawn.increment}
                    [/then]
                [/if]
                [if]
                    [variable]
                        name=difficulty.overall
                        greater_than=4000
                    [/variable]
                    [then]
                        {VARIABLE_OP spawn_count add $spawn.increment}
                    [/then]
                [/if]
                [if]
                    [variable]
                        name=difficulty.overall
                        greater_than=4500
                    [/variable]
                    [then]
                        {VARIABLE_OP spawn_count add $spawn.increment}
                    [/then]
                [/if]
            [/then]
        [/if]
        [if]
            [variable]
                name=$spawn.act
                equals=4
            [/variable]
            [then]
                [if]
                    [variable]
                        name=difficulty.overall
                        greater_than=3000
                    [/variable]
                    [then]
                        {VARIABLE_OP spawn_count add $spawn.increment}
                    [/then]
                [/if]
                [if]
                    [variable]
                        name=difficulty.overall
                        greater_than=3200
                    [/variable]
                    [then]
                        {VARIABLE_OP spawn_count add $spawn.increment}
                    [/then]
                [/if]
                [if]
                    [variable]
                        name=difficulty.overall
                        greater_than=3400
                    [/variable]
                    [then]
                        {VARIABLE_OP spawn_count add $spawn.increment}
                    [/then]
                [/if]
                [if]
                    [variable]
                        name=difficulty.overall
                        greater_than=3600
                    [/variable]
                    [then]
                        {VARIABLE_OP spawn_count add $spawn.increment}
                    [/then]
                [/if]
                [if]
                    [variable]
                        name=difficulty.overall
                        greater_than=3800
                    [/variable]
                    [then]
                        {VARIABLE_OP spawn_count add $spawn.increment}
                    [/then]
                [/if]
                [if]
                    [variable]
                        name=difficulty.overall
                        greater_than=4000
                    [/variable]
                    [then]
                        {VARIABLE_OP spawn_count add $spawn.increment}
                    [/then]
                [/if]
                [if]
                    [variable]
                        name=difficulty.overall
                        greater_than=4200
                    [/variable]
                    [then]
                        {VARIABLE_OP spawn_count add $spawn.increment}
                    [/then]
                [/if]
                [if]
                    [variable]
                        name=difficulty.overall
                        greater_than=4500
                    [/variable]
                    [then]
                        {VARIABLE_OP spawn_count add $spawn.increment}
                    [/then]
                [/if]
                [if]
                    [variable]
                        name=difficulty.overall
                        greater_than=4800
                    [/variable]
                    [then]
                        {VARIABLE_OP spawn_count add $spawn.increment}
                    [/then]
                [/if]
                [if]
                    [variable]
                        name=difficulty.overall
                        greater_than=5500
                    [/variable]
                    [then]
                        {VARIABLE_OP spawn_count add $spawn.increment}
                    [/then]
                [/if]
            [/then]
        [/if]
        [while]
            [variable]
                name=spawn_count
                greater_than=0
            [/variable]
            [do]
                {VARIABLE_OP spawn_type rand $spawn.spawn_type}
                [if]
                    [variable]
                        name=spawn.blacken
                        equals=yes
                    [/variable]
                    [then]
                        [unit]
                            type=$spawn_type
                            x,y=$spawn.x,$spawn.y
                            side=$spawn.side
                            to_variable=blackening_store
                            generate_name=yes
                            random_traits=yes
                            random_gender=yes
                        [/unit]
                        {MAKE_BLACK_SOUL}
                        [clear_variable]
                            name=blackening_store
                        [/clear_variable]
                    [/then]
                    [else]
                        {GENERIC_UNIT $spawn.side $spawn_type $spawn.x $spawn.y}
                    [/else]
                [/if]
                {VARIABLE_OP spawn_count sub 1}
            [/do]
        [/while]
        [allow_undo]
        [/allow_undo]
        {CLEAR_VARIABLE spawn_count,spawn_type,spawn}
    [/event]

    [event]
        name=turn refresh
        first_time_only=no
        [if]
            [variable]
                name=turn_number
                equals=1
            [/variable]
            [and]
                [variable]
                    name=side_number
                    less_than=6
                [/variable]
            [/and]
            [then]
                [message]
                    speaker=narrator
                    message= _ "Which difficulty do you prefer?"
                    side_for=$side_number
                    image=wesnoth-icon.png
                    [option]
                        label= _ "Very hard"
                        [command]
                            {VARIABLE difficulty[$side_number].base 150}
                        [/command]
                    [/option]
                    [option]
                        label= _ "Quite hard"
                        [command]
                            {VARIABLE difficulty[$side_number].base 125}
                        [/command]
                    [/option]
                    [option]
                        label= _ "Normal"
                        [command]
                            {VARIABLE difficulty[$side_number].base 100}
                        [/command]
                    [/option]
                    [option]
                        label= _ "Rather easy"
                        [command]
                            {VARIABLE difficulty[$side_number].base 75}
                        [/command]
                    [/option]
                    [option]
                        label= _ "Very easy"
                        [command]
                            {VARIABLE difficulty[$side_number].base 50}
                        [/command]
                    [/option]
                [/message]
            [/then]
        [/if]
    [/event]

    [event]
        name=last breath
        [filter]
            canrecruit=yes
            side=1,2,3,4,5
        [/filter]
        {VARIABLE unit.hitpoints 1}
        {VARIABLE unit.status.slowed yes}
        [unstore_unit]
            variable=unit
            find_vacant=no
        [/unstore_unit]
        {VARIABLE may_stay 0}
        [fire_event]
            name=travel
        [/fire_event]
    [/event]

    [event]
        name=travel
        first_time_only=no
        {VARIABLE keep_chosen 10}
        [message]
            speaker=narrator
            message= _ "Where do you want to travel?"
            image=wesnoth-icon.png
            side_for=$side_number
            [option]
                label= _ "Act4 - Entrance Keep"
                [show_if]
                    [variable]
                        name=k40
                        equals=1
                    [/variable]
                [/show_if]
                [command]
                    {VARIABLE keep_chosen 40}
                [/command]
            [/option]
            [option]
                label= _ "Act3 - Shadowlord's Keep"
                [show_if]
                    [variable]
                        name=k34
                        equals=1
                    [/variable]
                [/show_if]
                [command]
                    {VARIABLE keep_chosen 34}
                [/command]
            [/option]
            [option]
                label= _ "Act3 - Inner Fortress Entrance Keep"
                [show_if]
                    [variable]
                        name=k33
                        equals=1
                    [/variable]
                [/show_if]
                [command]
                    {VARIABLE keep_chosen 33}
                [/command]
            [/option]
            [option]
                label= _ "Act3 - Courtyard Keep"
                [show_if]
                    [variable]
                        name=k32
                        equals=1
                    [/variable]
                [/show_if]
                [command]
                    {VARIABLE keep_chosen 32}
                [/command]
            [/option]
            [option]
                label= _ "Act3 - Courtyard Entrance Keep"
                [show_if]
                    [variable]
                        name=k31
                        equals=1
                    [/variable]
                [/show_if]
                [command]
                    {VARIABLE keep_chosen 31}
                [/command]
            [/option]
            [option]
                label= _ "Act3 - Starting Keep"
                [show_if]
                    [variable]
                        name=k30
                        equals=1
                    [/variable]
                [/show_if]
                [command]
                    {VARIABLE keep_chosen 30}
                [/command]
            [/option]
            [option]
                label= _ "Act2 - Keep of Ultimate Darkness"
                [show_if]
                    [variable]
                        name=k29
                        equals=1
                    [/variable]
                [/show_if]
                [command]
                    {VARIABLE keep_chosen 29}
                [/command]
            [/option]
            [option]
                label= _ "Act2 - Mountain Keep"
                [show_if]
                    [variable]
                        name=k28
                        equals=1
                    [/variable]
                [/show_if]
                [command]
                    {VARIABLE keep_chosen 28}
                [/command]
            [/option]
            [option]
                label= _ "Act2 - Naga Keep"
                [show_if]
                    [variable]
                        name=k27
                        equals=1
                    [/variable]
                [/show_if]
                [command]
                    {VARIABLE keep_chosen 27}
                [/command]
            [/option]
            [option]
                label= _ "Act2 - Elven Keep"
                [show_if]
                    [variable]
                        name=k26
                        equals=1
                    [/variable]
                [/show_if]
                [command]
                    {VARIABLE keep_chosen 26}
                [/command]
            [/option]
            [option]
                label= _ "Act2 - Town Keep"
                [show_if]
                    [variable]
                        name=k25
                        equals=1
                    [/variable]
                [/show_if]
                [command]
                    {VARIABLE keep_chosen 25}
                [/command]
            [/option]
            [option]
                label= _ "Act2 - Swamp Keep"
                [show_if]
                    [variable]
                        name=k24
                        equals=1
                    [/variable]
                [/show_if]
                [command]
                    {VARIABLE keep_chosen 24}
                [/command]
            [/option]
            [option]
                label= _ "Act2 - Orcish Keep"
                [show_if]
                    [variable]
                        name=k23
                        equals=1
                    [/variable]
                [/show_if]
                [command]
                    {VARIABLE keep_chosen 23}
                [/command]
            [/option]
            [option]
                label= _ "Act2 - Central Keep"
                [show_if]
                    [variable]
                        name=k22
                        equals=1
                    [/variable]
                [/show_if]
                [command]
                    {VARIABLE keep_chosen 22}
                [/command]
            [/option]
            [option]
                label= _ "Act2 - Starting Keep"
                [show_if]
                    [variable]
                        name=k21
                        equals=1
                    [/variable]
                [/show_if]
                [command]
                    {VARIABLE keep_chosen 21}
                [/command]
            [/option]
            [option]
                label= _ "Act1 - Ice Guardian's Keep"
                [show_if]
                    [variable]
                        name=k20
                        equals=1
                    [/variable]
                [/show_if]
                [command]
                    {VARIABLE keep_chosen 20}
                [/command]
            [/option]
            [option]
                label= _ "Act1 - Fire Guardian's Keep"
                [show_if]
                    [variable]
                        name=k19
                        equals=1
                    [/variable]
                [/show_if]
                [command]
                    {VARIABLE keep_chosen 19}
                [/command]
            [/option]
            [option]
                label= _ "Act1 - Forest Guardian's Keep"
                [show_if]
                    [variable]
                        name=k18
                        equals=1
                    [/variable]
                [/show_if]
                [command]
                    {VARIABLE keep_chosen 18}
                [/command]
            [/option]
            [option]
                label= _ "Act1 - Cave Guardian's Keep"
                [show_if]
                    [variable]
                        name=k17
                        equals=1
                    [/variable]
                [/show_if]
                [command]
                    {VARIABLE keep_chosen 17}
                [/command]
            [/option]
            [option]
                label= _ "Act1 - Near-Desert Cave Keep"
                [show_if]
                    [variable]
                        name=k16
                        equals=1
                    [/variable]
                [/show_if]
                [command]
                    {VARIABLE keep_chosen 16}
                [/command]
            [/option]
            [option]
                label= _ "Act1 - Southern Cave Keep"
                [show_if]
                    [variable]
                        name=k15
                        equals=1
                    [/variable]
                [/show_if]
                [command]
                    {VARIABLE keep_chosen 15}
                [/command]
            [/option]
            [option]
                label= _ "Act1 - Northeastern Cave Keep"
                [show_if]
                    [variable]
                        name=k14
                        equals=1
                    [/variable]
                [/show_if]
                [command]
                    {VARIABLE keep_chosen 14}
                [/command]
            [/option]
            [option]
                label= _ "Act1 - Central Cave Keep"
                [show_if]
                    [variable]
                        name=k13
                        equals=1
                    [/variable]
                [/show_if]
                [command]
                    {VARIABLE keep_chosen 13}
                [/command]
            [/option]
            [option]
                label= _ "Act1 - Desert Keep"
                [show_if]
                    [variable]
                        name=k12
                        equals=1
                    [/variable]
                [/show_if]
                [command]
                    {VARIABLE keep_chosen 12}
                [/command]
            [/option]
            [option]
                label= _ "Act1 - Forest Keep"
                [show_if]
                    [variable]
                        name=k11
                        equals=1
                    [/variable]
                [/show_if]
                [command]
                    {VARIABLE keep_chosen 11}
                [/command]
            [/option]
            [option]
                label= _ "Act1 - Starting Keep"
                [command]
                    {VARIABLE keep_chosen 10}
                [/command]
            [/option]
            [option]
                label= _ "Stay here."
                [show_if]
                    [variable]
                        name=may_stay
                        equals=1
                    [/variable]
                [/show_if]
                [command]
                    {VARIABLE keep_chosen 0}
                [/command]
            [/option]
        [/message]

        [switch]
            variable=keep_chosen
            [case]
                value=10
                {VARIABLE difficulty[$side_number].act 1}
                [switch]
                    variable=side_number
                    [case]
                        value=1
                        {TRAVEL_TO 3 193}
                    [/case]
                    [case]
                        value=2
                        {TRAVEL_TO 6 199}
                    [/case]
                    [case]
                        value=3
                        {TRAVEL_TO 2 196}
                    [/case]
                    [case]
                        value=4
                        {TRAVEL_TO 13 199}
                    [/case]
                    [case]
                        value=5
                        {TRAVEL_TO 18 198}
                    [/case]
                [/switch]
            [/case]
            [case]
                value=11
                {VARIABLE difficulty[$side_number].act 1}
                {TRAVEL_TO 21 147}
            [/case]
            [case]
                value=12
                {VARIABLE difficulty[$side_number].act 1}
                {TRAVEL_TO 99 182}
            [/case]
            [case]
                value=13
                {VARIABLE difficulty[$side_number].act 1}
                {TRAVEL_TO 111 118}
            [/case]
            [case]
                value=14
                {VARIABLE difficulty[$side_number].act 1}
                {TRAVEL_TO 135 129}
            [/case]
            [case]
                value=15
                {VARIABLE difficulty[$side_number].act 1}
                {TRAVEL_TO 139 159}
            [/case]
            [case]
                value=16
                {VARIABLE difficulty[$side_number].act 1}
                {TRAVEL_TO 147 179}
            [/case]
            [case]
                value=17
                {VARIABLE difficulty[$side_number].act 1}
                {TRAVEL_TO 13 99}
            [/case]
            [case]
                value=18
                {VARIABLE difficulty[$side_number].act 1}
                {TRAVEL_TO 79 109}
            [/case]
            [case]
                value=19
                {VARIABLE difficulty[$side_number].act 1}
                {TRAVEL_TO 158 96}
            [/case]
            [case]
                value=20
                {VARIABLE difficulty[$side_number].act 1}
                {TRAVEL_TO 196 169}
            [/case]
            [case]
                value=21
                {VARIABLE difficulty[$side_number].act 2}
                [switch]
                    variable=side_number

                    [case]
                        value=1
                        {TRAVEL_TO 194 86}
                    [/case]
                    [case]
                        value=2
                        {TRAVEL_TO 193 85}
                    [/case]
                    [case]
                        value=3
                        {TRAVEL_TO 195 85}
                    [/case]
                    [case]
                        value=4
                        {TRAVEL_TO 193 88}
                    [/case]
                    [case]
                        value=5
                        {TRAVEL_TO 195 88}
                    [/case]
                [/switch]
            [/case]
            [case]
                value=22
                {VARIABLE difficulty[$side_number].act 2}
                {TRAVEL_TO 137 41}
            [/case]
            [case]
                value=23
                {VARIABLE difficulty[$side_number].act 2}
                {TRAVEL_TO 175 24}
            [/case]
            [case]
                value=24
                {VARIABLE difficulty[$side_number].act 2}
                {TRAVEL_TO 108 40}
            [/case]
            [case]
                value=25
                {VARIABLE difficulty[$side_number].act 2}
                {TRAVEL_TO 145 7}
            [/case]
            [case]
                value=26
                {VARIABLE difficulty[$side_number].act 2}
                {TRAVEL_TO 85 82}
            [/case]
            [case]
                value=27
                {VARIABLE difficulty[$side_number].act 2}
                {TRAVEL_TO 90 2}
            [/case]
            [case]
                value=28
                {VARIABLE difficulty[$side_number].act 2}
                {TRAVEL_TO 66 93}
            [/case]
            [case]
                value=29
                {VARIABLE difficulty[$side_number].act 2}
                {TRAVEL_TO 59 87}
            [/case]
            [case]
                value=30
                {VARIABLE difficulty[$side_number].act 3}
                [switch]
                    variable=side_number
                    [case]
                        value=1
                        {TRAVEL_TO 50 5}
                    [/case]
                    [case]
                        value=2
                        {TRAVEL_TO 49 7}
                    [/case]
                    [case]
                        value=3
                        {TRAVEL_TO 49 4}
                    [/case]
                    [case]
                        value=4
                        {TRAVEL_TO 51 4}
                    [/case]
                    [case]
                        value=5
                        {TRAVEL_TO 51 7}
                    [/case]
                [/switch]
            [/case]
            [case]
                value=31
                {VARIABLE difficulty[$side_number].act 3}
                {TRAVEL_TO 16 13}
            [/case]
            [case]
                value=32
                {VARIABLE difficulty[$side_number].act 3}
                {TRAVEL_TO 23 56}
            [/case]
            [case]
                value=33
                {VARIABLE difficulty[$side_number].act 3}
                {TRAVEL_TO 5 76}
            [/case]
            [case]
                value=34
                {VARIABLE difficulty[$side_number].act 3}
                {TRAVEL_TO 51 82}
            [/case]
            [case]
                value=40
                {VARIABLE difficulty[$side_number].act 4}
                [switch]
                    variable=side_number
                    [case]
                        value=1
                        {TRAVEL_TO 197 98}
                    [/case]
                    [case]
                        value=2
                        {TRAVEL_TO 196 99}
                    [/case]
                    [case]
                        value=3
                        {TRAVEL_TO 196 96}
                    [/case]
                    [case]
                        value=4
                        {TRAVEL_TO 198 96}
                    [/case]
                    [case]
                        value=5
                        {TRAVEL_TO 198 99}
                    [/case]
                [/switch]
            [/case]
        [/switch]
    [/event]
    #[event]
    #	name=moveto
    #	first_time_only=no
    #	[filter]
    #	side=1,2,3,4,5
    #	[/filter]
    #	{MODIFY_UNIT id=$unit.id moves 99}
    #	{MODIFY_UNIT id=$unit.id attacks_left 1}
    #[/event]
    [event]
        name=sighted

        [filter]
            side=1,2,3,4,5
        [/filter]

        [filter_second]
            race=Elf
            [not]
                side=1,2,3,4,5,10
            [/not]
        [/filter_second]
        [chat]
            speaker="Stormrider"
            message= _"Have a look at that thing! It is an elf possessed by an evil spirit. These rare creations have terrible strength and can use devastating magic. It seems that this corruption is worse than I expected..."
        [/chat]
    [/event]
    [event]
        name=moveto
        [filter]
            side=1,2,3,4,5
            [filter_location]
                x,y=13,99
                radius=25
                [filter_radius]
                    terrain=!,X*,X*^*,*^X*
                [/filter_radius]
            [/filter_location]
        [/filter]
        [chat]
            speaker= _ "Information"
            message= _ "A Guardian has been awakened."
        [/chat]
        [chat]
            speaker= _ "Cave Guardian"
            message= _ "You should never have come here! I will tear your flesh from your bones, and make servants from your weak bodies."
        [/chat]
        [gold]
            side=6
            amount=$difficulty.overall
        [/gold]
    [/event]
    [event]
        name=die
        [filter]
            id=Cave Guardian
        [/filter]
        [chat]
            speaker="Cave Guardian"
            message= _"Aaaeeeeiiiaaaaah! I am sent into the world of the dead now... but I will return, Shadowlord shall punish me, but I will surely return... and you will fully understand the meaning of the word 'suffer'!"
        [/chat]
        {QUAKE rumble.ogg}
        [terrain]
            x,y=49,96
            terrain=Qxu^Ii
        [/terrain]
        [redraw]
        [/redraw]
        [chat]
            speaker="$second_unit.name"
            message= _"We will slay you again, have no fear."
        [/chat]
        {VARIABLE a11 1}
        {A1BOSSES_KILL_CHECK}
    [/event]
    [event]
        name=moveto
        [filter]
            side=1,2,3,4,5
            [filter_location]
                x,y=79,109
                radius=25
                [filter_radius]
                    terrain=!,X*,X*^*,*^X*
                [/filter_radius]
            [/filter_location]
        [/filter]
        [chat]
            speaker= _ "Information"
            message= _ "A Guardian has been awakened."
        [/chat]
        [chat]
            speaker= _ "Forest Guardian"
            message= _ "See the destiny that awaits you!!!"
        [/chat]
        [gold]
            side=7
            amount=$difficulty.overall
        [/gold]
    [/event]
    [event]
        name=die
        [filter]
            id=Forest Guardian
        [/filter]
        [chat]
            speaker="Forest Guardian"
            message= _"Arrgh.. you have defeated me... but I will return and kill you! Then I will pull you back and kill you again, and again, and again!"
        [/chat]
        {QUAKE rumble.ogg}
        [terrain]
            x,y=53,96
            terrain=Qxu^Ii
        [/terrain]
        [redraw]
        [/redraw]
        [chat]
            speaker="Stormrider"
            message= _"That will not happen, admit it."
        [/chat]
        {VARIABLE a12 1}
        {A1BOSSES_KILL_CHECK}
    [/event]
    [event]
        name=moveto
        [filter]
            side=1,2,3,4,5
            [filter_location]
                x,y=158,96
                radius=25
                [filter_radius]
                    terrain=!,X*,X*^*,*^X*
                [/filter_radius]
            [/filter_location]
        [/filter]
        [chat]
            speaker= _ "Information"
            message= _ "A Guardian has been awakened."
        [/chat]
        [gold]
            side=9
            amount=$difficulty.overall
        [/gold]
    [/event]
    [event]
        name=die
        [filter]
            id=Fire Guardian
        [/filter]
        [chat]
            speaker= _ "Fire Guardian"
            message= _"You have killed me, but you shall be slain by others... and then you will burn in hell forever!"
        [/chat]
        {QUAKE rumble.ogg}
        [terrain]
            x,y=49,99
            terrain=Qxu^Ii
        [/terrain]
        [redraw]
        [/redraw]
        [chat]
            speaker="$second_unit.name"
            message= _"Nobody can stop me, $second_unit.name the Dragonslayer!"
        [/chat]
        {VARIABLE a13 1}
        {A1BOSSES_KILL_CHECK}
    [/event]
    [event]
        name=moveto
        [filter]
            side=1,2,3,4,5
            [filter_location]
                x,y=196,169
                radius=25
                [filter_radius]
                    terrain=!,X*,X*^*,*^X*
                [/filter_radius]
            [/filter_location]
        [/filter]
        [chat]
            speaker= _ "Information"
            message= _ "A Guardian has been awakened."
        [/chat]
        [gold]
            side=8
            amount=$difficulty.overall
        [/gold]
    [/event]
    [event]
        name=die
        [filter]
            id=Ice Guardian
        [/filter]
        [chat]
            speaker= _ "Ice Guardian"
            message= _"I will meet you again in the world of the dead. And you will suffer eternal pain then!"
        [/chat]
        {QUAKE rumble.ogg}
        [terrain]
            x,y=53,99
            terrain=Qxu^Ii
        [/terrain]
        [redraw]
        [/redraw]
        [chat]
            speaker= _ "Lethalia"
            message= _"He just cannot shut up?"
        [/chat]
        {VARIABLE a14 1}
        {A1BOSSES_KILL_CHECK}
    [/event]
    [event]
        name=moveto
        [filter]
            side=1,2,3,4,5
            x,y=51,97
        [/filter]
        first_time_only=no
        [if]
            [variable]
                name=a15
                equals=1
            [/variable]
            [then]
                {TRAVEL_TO 194 86}
                {VARIABLE k21 1}
                [unit]
                    type=Corrupted Orcish Sovereign
                    x=175
                    y=24
                    side=6
                    canrecruit=yes
                    name= _ "Orcish Seal Guardian"
                    id=Orcish Seal Guardian
                [/unit]
                {MODIFY_SIDE 6 recruit (Corrupted Orcish Warrior,Corrupted Orcish Slayer,Spell Eater)}
                [unit]
                    type=Corrupted Elvish Nightprowler
                    x=85
                    y=82
                    side=7
                    canrecruit=yes
                    name= _ "Elvish Seal Guardian"
                    id=Elvish Seal Guardian
                [/unit]
                {MODIFY_SIDE 7 recruit (Corrupted Elvish Hero,Corrupted Elvish Captain,Corrupted Elvish Rider,Spell Eater)}
                [chat]
                    speaker="Stormrider"
                    message= _"This place... the vileness of these monstrosities is radiating from the ground... I am afraid that we may encounter incredible abominations in this place."
                [/chat]
                [unit]
                    type=Corrupted Naga Myrmidon
                    x=90
                    y=2
                    side=8
                    canrecruit=yes
                    name= _ "Naga Seal Guardian"
                    id=Naga Seal Guardian
                [/unit]
                {MODIFY_SIDE 8 recruit (Corrupted Naga Fighter,Corrupted Naga Warrior,Spell Eater)}
                [unit]
                    type=Destroyer
                    x=59
                    y=87
                    side=9
                    canrecruit=yes
                    name= _ "Dark Seal Guardian"
                    id=Dark Seal Guardian
                    [modifications]
                        [object]
                            [effect]
                                apply_to=image_mod
                                replace="CS(-255,-255,-255)"
                            [/effect]
                            [effect]
                                apply_to=attack
                                increase_damage=50%
                                increase_attacks=50%
                                [set_specials]
                                    mode=append
                                    {WEAPON_SPECIAL_LETHARGY}
                                [/set_specials]
                            [/effect]
                            [effect]
                                apply_to=hitpoints
                                increase=100%
                                increase_total=100%
                            [/effect]
                            [effect]
                                apply_to=max_experience
                                increase=150%
                            [/effect]
                            [effect]
                                apply_to=resistance
                                replace=false
                                [resistance]
                                    fire=-30
                                    cold=-30
                                    arcane=50
                                    blade=-30
                                    pierce=-30
                                    impact=-30
                                [/resistance]
                            [/effect]
                        [/object]
                    [/modifications]
                [/unit]
                [store_unit]
                    [filter]
                        id=Dark Seal Guardian
                    [/filter]
                    kill=no
                    variable=blackening_store
                [/store_unit]
                {BLACKEN}
                [unstore_unit]
                    variable=blackening_store
                    find_vacant=no
                [/unstore_unit]
                [clear_variable]
                    name=blackening_store
                [/clear_variable]
                {VARIABLE difficulty[$side_number].act 2}
                {MODIFY_SIDE 9 recruit (Spearman,Swordsman,Bowman,Longbowman,Pikeman,Javelineer,Horseman,Knight,Lancer,Cavalryman,Dragoon,Dark Adept,Dark Sorcerer,Heavy Infantryman,Shock Trooper)}
                {PLACE_SPAWNS 2}
                [chat]
                    speaker="Efraim"
                    message= _"I fear that everything in this place will be something similar to the Corrupted Elves we have already seen."
                [/chat]
            [/then]
        [/if]
    [/event]
    [event]
        name=moveto
        [filter]
            side=1,2,3,4,5
            x,y=131-150,1-10
        [/filter]
        [chat]
            speaker="Stormrider"
            message= _"Look at this town. Everybody slaughtered, maybe even converted into some of these monstrosities."
        [/chat]
    [/event]
    [event]
        name=sighted

        [filter]
            side=1,2,3,4,5
        [/filter]

        [filter_second]
            race=black soul-loti
        [/filter_second]
        [chat]
            speaker="Stormrider"
            message= _"Noooo! The previous gates into the world of the dead were just necromantic portals, but this one must have been opened by these. This is a Black Soul. A terrible spirit that seeks to conquest and destroy all the living world. If they have found a way to get into our world, the consequences might be terrible. They may have been assembling there for all eternity, planning this invasion for ages. I fear that there is just too many of them and there is nothing in this world that can stop them."
        [/chat]
    [/event]
    [event]
        name=moveto
        [filter]
            side=1,2,3,4,5
            [filter_location]
                x,y=175,24
                radius=25
                [filter_radius]
                    terrain=!,X*,X*^*,*^X*
                [/filter_radius]
            [/filter_location]
        [/filter]
        [chat]
            speaker=_ "Information"
            message= _ "A Seal Guardian has been awakened."
        [/chat]
        [chat]
            speaker= _ "Orcish Seal Guardian"
            message= _ "Feast on their spirits, my loyal servants!"
        [/chat]
        [gold]
            side=6
            amount=$difficulty.overall
        [/gold]
    [/event]
    [event]
        name=die
        [filter]
            id=Orcish Seal Guardian
        [/filter]
        [chat]
            speaker= _ "Orcish Seal Guardian"
            message= _"I will be soon bind to another mortal and have my revenge!"
        [/chat]
        {QUAKE rumble.ogg}
        [terrain]
            x,y=59,90
            terrain=Qxu^Ii
        [/terrain]
        [redraw]
        [/redraw]
        [chat]
            speaker= _ "Efraim"
            message= _"You would just die again. Trust me, it is not worth it."
        [/chat]
        {VARIABLE a21 1}
        {A2BOSSES_KILL_CHECK}
    [/event]
    [event]
        name=moveto
        [filter]
            side=1,2,3,4,5
            [filter_location]
                x,y=90,2
                radius=25
                [filter_radius]
                    terrain=!,X*,X*^*,*^X*
                [/filter_radius]
            [/filter_location]
        [/filter]
        [chat]
            speaker= _ "Information"
            message= _ "A Seal Guardian has been awakened."
        [/chat]
        [chat]
            speaker= _ "Naga Seal Guardian"
            message= _ "Your weak flesh will serve us."
        [/chat]
        [gold]
            side=8
            amount=$difficulty.overall
        [/gold]
    [/event]
    [event]
        name=die
        [filter]
            id=Naga Seal Guardian
        [/filter]
        [chat]
            speaker= _ "Naga Seal Guardian"
            message= _"I will meet you again. And you will learn what the real pain is!"
        [/chat]
        {QUAKE rumble.ogg}
        [terrain]
            x,y=57,89
            terrain=Qxu^Ii
        [/terrain]
        [redraw]
        [/redraw]
        [chat]
            speaker= _ "Delly"
            message= _"You can tell us also the story about the Snow White and Seven Gnomes."
        [/chat]
        {VARIABLE a22 1}
        {A2BOSSES_KILL_CHECK}
    [/event]
    [event]
        name=moveto
        [filter]
            side=1,2,3,4,5
            [filter_location]
                x,y=85,82
                radius=25
                [filter_radius]
                    terrain=!,X*,X*^*,*^X*
                [/filter_radius]
            [/filter_location]
        [/filter]
        [chat]
            speaker= _ "Information"
            message= _ "A Seal Guardian has been awakened."
        [/chat]
        [chat]
            speaker= _ "Elvish Seal Guardian"
            message= _ "You have come too far. Now, you will be stopped!"
        [/chat]
        [gold]
            side=7
            amount=$difficulty.overall
        [/gold]
    [/event]
    [event]
        name=die
        [filter]
            id=Elvish Seal Guardian
        [/filter]
        [chat]
            speaker= _ "Elvish Seal Guardian"
            message= _"Once, you will die too. And I can assure you that I will arrange that you will go right into Lilith's torture cells."
        [/chat]
        {QUAKE rumble.ogg}
        [terrain]
            x,y=57,91
            terrain=Qxu^Ii
        [/terrain]
        [redraw]
        [/redraw]
        [chat]
            speaker= _ "Efraim"
            message= _"Lilith will be dead before I die."
        [/chat]
        {VARIABLE a23 1}
        {A2BOSSES_KILL_CHECK}
    [/event]
    [event]
        name=moveto
        [filter]
            side=1,2,3,4,5
            [filter_location]
                x,y=57,87
                radius=25
                [filter_radius]
                    terrain=!,X*,X*^*,*^X*
                [/filter_radius]
            [/filter_location]
        [/filter]
        [chat]
            speaker= _ "Information"
            message= _ "A Seal Guardian has been awakened."
        [/chat]
        [gold]
            side=9
            amount=$($difficulty.overall /3)
        [/gold]
    [/event]
    [event]
        name=die
        [filter]
            id=Dark Seal Guardian
        [/filter]
        [terrain]
            x,y=55,90
            terrain=Qxu^Ii
        [/terrain]
        [chat]
            speaker= _ "Dark Seal Guardian"
            message= _"Proceed... you will face hundreds of things like me down there..."
        [/chat]
        {QUAKE rumble.ogg}
        [redraw]
        [/redraw]
        [chat]
            speaker= _ "$second_unit.name"
            message= _"I will send them where they belong to."
        [/chat]
        {VARIABLE a24 1}
        {A2BOSSES_KILL_CHECK}
    [/event]
    [event]
        name=moveto
        [filter]
            side=1,2,3,4,5
            x,y=57,90
        [/filter]
        first_time_only=no
        [if]
            [variable]
                name=a25
                equals=1
            [/variable]
            [then]
                {TRAVEL_TO 50 5}
                {VARIABLE k30 1}
                [unit]
                    type=Reaper
                    x=16
                    y=13
                    side=6
                    canrecruit=yes
                    name= _ "Harbinger of Death"
                    id=Harbinger of Death
                    [modifications]
                        [object]
                            [effect]
                                apply_to=image_mod
                                replace="CS(-255,-255,-255)"
                            [/effect]
                            [effect]
                                apply_to=attack
                                increase_damage=50%
                                increase_attacks=50%
                            [/effect]
                            [effect]
                                apply_to=hitpoints
                                increase=100%
                                increase_total=100%
                            [/effect]
                        [/object]
                    [/modifications]
                [/unit]
                [store_unit]
                    [filter]
                        x,y=16,13
                    [/filter]
                    kill=no
                    variable=blackening_store
                [/store_unit]
                [set_variable]
                    name=blackening_store.level
                    multiply=2
                [/set_variable]
                [unstore_unit]
                    variable=blackening_store
                    find_vacant=no
                [/unstore_unit]
                [clear_variable]
                    name=blackening_store
                [/clear_variable]
                {MODIFY_SIDE 6 recruit (Reaper,Deathlord,Soul Shooter,Grim Knight)}
                [unit]
                    type=Demon Overlord
                    x=23
                    y=56
                    side=7
                    canrecruit=yes
                    name= _ "Tormentor of Souls"
                    id=Demon Boss
                    [modifications]
                        [trait]
                            id=brutal
                            male_name= _ "brutal"
                            female_name= _ "female^brutal"
                            [effect]
                                apply_to=attack
                                range=melee
                                [set_specials]
                                    mode=append
                                    {WEAPON_SPECIAL_LESSER_BERSERK 3}
                                [/set_specials]
                            [/effect]
                        [/trait]
                        [trait]
                            id=cruel
                            male_name= _ "cruel"
                            female_name= _ "female^cruel"
                            [effect]
                                apply_to=attack
                                range=melee
                                [set_specials]
                                    mode=append
                                    {WEAPON_SPECIAL_CHARGE}
                                [/set_specials]
                            [/effect]
                        [/trait]
                        [trait]
                            id=perverted
                            male_name= _ "perverted"
                            female_name= _ "female^perverted"
                            [effect]
                                apply_to=attack
                                range=melee
                                increase_damage=4
                            [/effect]
                        [/trait]
                    [/modifications]
                [/unit]
                {MODIFY_SIDE 7 recruit (Demon)}
                [unit]
                    type=Dragon Rider
                    x=5
                    y=76
                    side=8
                    canrecruit=yes
                    name= _ "Death Overlord"
                    id=Death Overlord
                    [modifications]
                        [object]
                            [effect]
                                apply_to=image_mod
                                replace="CS(-255,-255,-255)"
                            [/effect]
                            [effect]
                                apply_to=attack
                                increase_damage=50%
                                increase_attacks=50%
                                [set_specials]
                                    mode=append
                                    {WEAPON_SPECIAL_LETHARGY}
                                [/set_specials]
                            [/effect]
                            [effect]
                                apply_to=hitpoints
                                increase=100%
                                increase_total=100%
                            [/effect]
                            [effect]
                                apply_to=max_experience
                                increase=150%
                            [/effect]
                            [effect]
                                apply_to=resistance
                                replace=false
                                [resistance]
                                    fire=-30
                                    cold=-30
                                    arcane=50
                                    blade=-30
                                    pierce=-30
                                    impact=-30
                                [/resistance]
                            [/effect]
                        [/object]
                    [/modifications]
                [/unit]
                [store_unit]
                    [filter]
                        x,y=5,76
                    [/filter]
                    kill=no
                    variable=blackening_store
                [/store_unit]
                {BLACKEN}
                [chat]
                    speaker="Argan"
                    message= _"Bleah! What the hell is this place? How can something live in here? It is like..."
                [/chat]
                [unstore_unit]
                    variable=blackening_store
                    find_vacant=no
                [/unstore_unit]
                [clear_variable]
                    name=blackening_store
                [/clear_variable]
                {MODIFY_SIDE 8 recruit (Iron Mauler,Royal Guard,Necromancer,Grand Knight,Halberdier)}
                [unit]
                    type=Reaper
                    x=51
                    y=82
                    side=9
                    canrecruit=yes
                    name= _ "Shadowlord"
                    id=Shadowlord_first
                    [modifications]
                        [object]
                            [effect]
                                apply_to=image_mod
                                replace="CS(-80,-224,-224)"
                            [/effect]
                            [effect]
                                apply_to=attack
                                increase_damage=100%
                                increase_attacks=100%
                            [/effect]
                            [effect]
                                apply_to=hitpoints
                                increase=200%
                                increase_total=200%
                            [/effect]
                            [effect]
                                apply_to=resistance
                                replace=false
                                [resistance]
                                    fire=-30
                                    cold=-30
                                    arcane=-30
                                    blade=-30
                                    pierce=-30
                                    impact=-30
                                [/resistance]
                            [/effect]
                        [/object]
                    [/modifications]
                [/unit]
                [store_unit]
                    [filter]
                        id=Shadowlord_first
                    [/filter]
                    kill=no
                    variable=blackening_store
                [/store_unit]
                [set_variable]
                    name=blackening_store.level
                    value=20
                [/set_variable]
                [unstore_unit]
                    variable=blackening_store
                    find_vacant=no
                [/unstore_unit]
                [clear_variable]
                    name=blackening_store
                [/clear_variable]
                {MODIFY_SIDE 9 recruit (Iron Mauler,Royal Guard,Necromancer,Grand Knight,Halberdier,Demon,Reaper,Deathlord,Grim Knight,Soul Shooter)}
                {PLACE_SPAWNS 3}
                {VARIABLE difficulty[$side_number].act 3}
                [chat]
                    speaker="Lethalia"
                    message= _"Like if it was in a different world, in the world where the corruption came from. Last time I felt something like this was when we fought Lilith, but that was nothing compared to this... this... fiendish presence..."
                [/chat]
            [/then]
        [/if]
    [/event]
    [event]
        name=recruit
        first_time_only=no
        [filter]
            side=6,7,8,9
            race=human
        [/filter]
        [store_unit]
            [filter]
                x,y=$x1,$y1
            [/filter]
            kill=yes
            variable=blackening_store
        [/store_unit]
        {MAKE_BLACK_SOUL}
        [clear_variable]
            name=blackening_store
        [/clear_variable]
    [/event]
    [event]
        name=sighted

        [filter]
            side=1,2,3,4,5
        [/filter]

        [filter_second]
            race=demon-loti
        [/filter_second]
        [chat]
            speaker="Stormrider"
            message= _"Oh no! You know what is that monster? It is a demon. An incarnation of pure evil. Some spirits here must possess the terrible knowledge of demonology! Revenants of times really long gone must be here. I never knew this plot was something so terrible!"
        [/chat]
    [/event]
    [event]
        name=moveto
        [filter]
            side=1,2,3,4,5
            [filter_location]
                x,y=16,13
                radius=25
                [filter_radius]
                    terrain=!,X*,X*^*,*^X*
                [/filter_radius]
            [/filter_location]
        [/filter]
        [chat]
            speaker= _ "Information"
            message= _ "A great evil has been awakened"
        [/chat]
        [gold]
            side=6
            amount=$difficulty.overall
        [/gold]
    [/event]
    [event]
        name=die
        [filter]
            id=Harbinger of Death
        [/filter]
        [terrain]
            x,y=55,90
            terrain=Qxu^Ii
        [/terrain]
        [chat]
            speaker= _ "Harbinger of Death"
            message= _"I will meet you again soon... and you will suffer!"
        [/chat]
        {QUAKE rumble.ogg}
        [redraw]
        [/redraw]
        [chat]
            speaker= _ "Stormrider"
            message= _"I have heard such unfulfillable promises before."
        [/chat]
    [/event]
    [event]
        name=moveto
        [filter]
            side=1,2,3,4,5
            [filter_location]
                x,y=23,56
                radius=25
                [filter_radius]
                    terrain=!,X*,X*^*,*^X*
                [/filter_radius]
            [/filter_location]
        [/filter]
        [chat]
            speaker= _ "Information"
            message= _ "A great evil has been awakened"
        [/chat]
        [chat]
            speaker= _ "Tormentor of Rightful Souls"
            message= _ "You, who arrive, shall have to abandon all hopes. Your souls will burn and you shall serve us for all eternity!"
        [/chat]
        [gold]
            side=7
            amount=$difficulty.overall
        [/gold]
    [/event]
    [event]
        name=moveto
        [filter]
            side=1,2,3,4,5
            x,y=0-40,20-50
        [/filter]
        [chat]
            speaker= _ "Stormrider"
            message= _ "Blood red skies, deserted rocky wasteland instead of soil, rivers of flame, eternal twilight... this place looks like Inferno... The presence of demons must have converted this courtyard into a place that looks like their world."
        [/chat]
    [/event]
    [event]
        name=die
        [filter]
            id=Tormentor of Souls
        [/filter]
        [terrain]
            x,y=55,90
            terrain=Qxu^Ii
        [/terrain]
        [chat]
            speaker= _ "Tormentor of Rightful Souls"
            message= _"Argh... I have failed... but I am free at last from my binding. Thank you, mortals."
        [/chat]
        {QUAKE rumble.ogg}
        [redraw]
        [/redraw]
        [chat]
            speaker="$second_unit.name"
            message= _"The pleasure is ours. It is the first time we were not promised great revenges and terrible pain."
        [/chat]
    [/event]
    [event]
        name=moveto
        [filter]
            side=1,2,3,4,5
            [filter_location]
                x,y=5,76
                radius=25
                [filter_radius]
                    terrain=!,X*,X*^*,*^X*
                [/filter_radius]
            [/filter_location]
        [/filter]
        [chat]
            speaker= _ "Information"
            message= _ "A great evil has been awakened"
        [/chat]
        [gold]
            side=8
            amount="$($difficulty.overall /3)"
        [/gold]
    [/event]
    [event]
        name=die
        [filter]
            id=Death Overlord
        [/filter]
        [terrain]
            x,y=55,90
            terrain=Qxu^Ii
        [/terrain]
        [chat]
            speaker= _ "Death Overlord"
            message= _"Shadowlord will maul you very soon, you shall see..."
        [/chat]
        {QUAKE rumble.ogg}
        [redraw]
        [/redraw]
        [chat]
            speaker="$second_unit.name"
            message= _"He is no match for us."
        [/chat]
    [/event]
    [event]
        name=moveto
        [filter]
            side=1,2,3,4,5
            [filter_location]
                x,y=51,82
                radius=25
                [filter_radius]
                    terrain=!,X*,X*^*,*^X*
                [/filter_radius]
            [/filter_location]
        [/filter]
        [chat]
            speaker= _ "Shadowlord"
            message= _ "You have arrived into my keep, hidden deep inside the Fortress of Ultimate Darkness, swarming with demons and black souls... Impressive... Hrrrr.... But I will kill you without issues, have no fear... Maybe even my pets shall suffice."
        [/chat]
        [sound]
            name=dwarf-laugh.wav
        [/sound]
        {COLOR_ADJUST -10 -10 -10}
        [delay]
            time=300
        [/delay]
        [chat]
            speaker=$unit.name
            message= _ "Where are you hiding, fiend?"
        [/chat]
        [gold]
            side=9
            amount="$($difficulty.overall /3)"
        [/gold]
    [/event]
    [event]
        name=die
        [filter]
            id=Shadowlord_first
        [/filter]
        [chat]
            speaker= _ "Shadowlord"
            message= _ "Hrrrrr. You have defeated me... for now... but this was not my strongest form... come to face me into the world of the dead, he he he... hrrrrr..."
        [/chat]
        [chat]
            speaker= _ "Information"
            message= _ "Shadowlord has been repulsed. Portal to act 4 has been opened."
        [/chat]
        {QUAKE rumble.ogg}
        {PLACE_IMAGE scenery/portal.png 51 84}
        {VARIABLE a4 1}
        {PLACE_SPAWNS 4}
    [/event]
    [event]
        name=moveto
        [filter]
            side=1,2,3,4,5
            x,y=51,84
        [/filter]
        first_time_only=no
        [if]
            [variable]
                name=a4
                equals=1
            [/variable]
            [then]
                {TRAVEL_TO 197 98}
                {VARIABLE k40 1}
                {VARIABLE difficulty[$side_number].act 4}
                [unit]
                    type=Reaper
                    x=175
                    y=141
                    side=9
                    canrecruit=yes
                    name= _ "Shadowlord"
                    id=Shadowlord
                    [modifications]
                        [object]
                            [effect]
                                apply_to=image_mod
                                replace="CS(-80,-224,-224)"
                            [/effect]
                            [effect]
                                apply_to=attack
                                increase_damage=200%
                                increase_attacks=200%
                            [/effect]
                            [effect]
                                apply_to=hitpoints
                                increase=200%
                                increase_total=200%
                            [/effect]
                            [effect]
                                apply_to=resistance
                                replace=false
                                [resistance]
                                    fire=-30
                                    cold=-30
                                    arcane=-30
                                    blade=-30
                                    pierce=-30
                                    impact=-30
                                [/resistance]
                            [/effect]
                        [/object]
                    [/modifications]
                [/unit]
                [store_unit]
                    [filter]
                        id=Shadowlord
                    [/filter]
                    kill=no
                    variable=blackening_store
                [/store_unit]
                [set_variable]
                    name=blackening_store.level
                    value=30
                [/set_variable]
                [unstore_unit]
                    variable=blackening_store
                    find_vacant=no
                [/unstore_unit]
                [clear_variable]
                    name=blackening_store
                [/clear_variable]
            [/then]
        [/if]
    [/event]
    [event]
        name=moveto
        [filter]
            side=1,2,3,4,5
            [filter_location]
                x,y=175,141
                radius=25
                [filter_radius]
                    terrain=!,X*,X*^*,*^X*
                [/filter_radius]
            [/filter_location]
        [/filter]
        [chat]
            speaker=_ "Shadowlord"
            message= _ "You have followed me into the world of the dead, but this pitiful attempt to destroy me forever will be punished severely. Prepare to suffer... and remain here forever!"
        [/chat]
        [sound]
            name=dwarf-laugh.wav
        [/sound]
        {COLOR_ADJUST -20 -20 -20}
        [delay]
            time=300
        [/delay]
        [chat]
            speaker=$unit.name
            message= _ "I will never give up!"
        [/chat]
        [gold]
            side=9
            amount="$($difficulty.overall /2)"
        [/gold]
    [/event]
    [event]
        name=last breath
        [filter]
            id=Shadowlord
        [/filter]
        [message]
            speaker=Shadowlord
            message= _ "You have... defeated me..."
        [/message]
        [message]
            speaker=second_unit
            message= _ "The world has been saved."
        [/message]
        [endlevel]
            result=victory
            bonus=no
        [/endlevel]
    [/event]

    {DROPS 10 13 (sword,sword,sword,bow,bow,bow,staff,staff,staff,axe,axe,axe,xbow,dagger,knife,mace,mace,spear) yes 6,7,8,9}
    {GLOBAL_EVENTS}
    {LOTI_EXTRA_ADVANCEMENT_LINES}
    {DISABLE_UPKEEP 1}
    {DISABLE_UPKEEP 2}
    {DISABLE_UPKEEP 3}
    {DISABLE_UPKEEP 4}
    {DISABLE_UPKEEP 5}
    {DISABLE_UPKEEP 6}
    {DISABLE_UPKEEP 7}
    {DISABLE_UPKEEP 8}
    {DISABLE_UPKEEP 9}
    [event]
        name=turn refresh
        first_time_only=no
        [if]
            [variable]
                name=side_number
                equals=6
            [/variable]
            [then]
                [gold]
                    side=6
                    amount=$($difficulty.overall /50)
                [/gold]
            [/then]
        [/if]
        [if]
            [variable]
                name=side_number
                equals=7
            [/variable]
            [then]
                [gold]
                    side=7
                    amount=$($difficulty.overall /50)
                [/gold]
            [/then]
        [/if]
        [if]
            [variable]
                name=side_number
                equals=8
            [/variable]
            [then]
                [gold]
                    side=8
                    amount=$($difficulty.overall /50)
                [/gold]
            [/then]
        [/if]
        [if]
            [variable]
                name=side_number
                equals=9
            [/variable]
            [then]
                [gold]
                    side=9
                    amount=$($difficulty.overall /50)
                [/gold]
            [/then]
        [/if]
        [if]
            [variable]
                name=turn_number
                equals=1
            [/variable]
            [and]
                [variable]
                    name=side_number
                    equals=6
                [/variable]
            [/and]
            [then]
                {VARIABLE count 1}
                [while]
                    [variable]
                        name=count
                        less_than_equal_to=5
                    [/variable]
                    [do]
                        [if]
                            [variable]
                                name=difficulty[$count].base
                                equals=60
                            [/variable]
                            [then]
                                {VARIABLE difficulty[$count].base 0}
                                [gold]
                                    side=1
                                    amount=20
                                [/gold]
                                [gold]
                                    side=2
                                    amount=20
                                [/gold]
                                [gold]
                                    side=3
                                    amount=20
                                [/gold]
                                [gold]
                                    side=4
                                    amount=20
                                [/gold]
                                [gold]
                                    side=5
                                    amount=20
                                [/gold]
                            [/then]
                        [/if]
                        {VARIABLE_OP count add 1}
                    [/do]
                [/while]
                {CLEAR_VARIABLE count}
            [/then]
        [/if]
        [if]
            [variable]
                name=side_number
                equals=1
            [/variable]
            [then]
                {VARIABLE respawn_count 1}
                [while]
                    [variable]
                        name=respawn_count
                        less_than_equal_to=5
                    [/variable]
                    [do]
                        {VARIABLE_OP k rand (1..$spawn_list.spawn.length)}
                        [if]
                            [variable]
                                name=spawn_list.spawn.free
                                equals=1
                            [/variable]
                            [then]
                                [if]
                                    [variable]
                                        name=spawn_list.spawn.act
                                        equals=1
                                    [/variable]
                                    [and]
                                        [variable]
                                            name=difficulty.act1
                                            equals=0
                                        [/variable]
                                    [/and]
                                    [and]
                                        [variable]
                                            name=k21
                                            equals=1
                                        [/variable]
                                    [/and]
                                    [then]
                                        {VARIABLE can_spawn 1}
                                    [/then]
                                [/if]
                                [if]
                                    [variable]
                                        name=spawn_list.spawn.act
                                        equals=2
                                    [/variable]
                                    [and]
                                        [variable]
                                            name=difficulty.act2
                                            equals=0
                                        [/variable]
                                    [/and]
                                    [and]
                                        [variable]
                                            name=k30
                                            equals=1
                                        [/variable]
                                    [/and]
                                    [then]
                                        {VARIABLE can_spawn 1}
                                    [/then]
                                [/if]
                                [if]
                                    [variable]
                                        name=spawn_list.spawn.act
                                        equals=3
                                    [/variable]
                                    [and]
                                        [variable]
                                            name=difficulty.act3
                                            equals=0
                                        [/variable]
                                    [/and]
                                    [and]
                                        [variable]
                                            name=k40
                                            equals=1
                                        [/variable]
                                    [/and]
                                    [then]
                                        {VARIABLE can_spawn 1}
                                    [/then]
                                [/if]
                                [if]
                                    [variable]
                                        name=can_spawn
                                        equals=1
                                    [/variable]
                                    [then]
                                        {PLACE_SPAWN}
                                    [/then]
                                [/if]
                            [/then]
                        [/if]
                        {VARIABLE_OP respawn_count add 1}
                    [/do]
                [/while]
                {CLEAR_VARIABLE respawn_count,can_spawn,k}

                [if]
                    [variable]
                        name=difficulty.act1
                        greater_than=100
                    [/variable]
                    [then]
                        {VARIABLE spawn_chance 8}
                        [if]
                            [variable]
                                name=difficulty.act1
                                greater_than=300
                            [/variable]
                            [then]
                                {VARIABLE_OP spawn_chance sub 1}
                            [/then]
                        [/if]
                        [if]
                            [variable]
                                name=difficulty.act1
                                greater_than=500
                            [/variable]
                            [then]
                                {VARIABLE_OP spawn_chance sub 1}
                            [/then]
                        [/if]
                        [if]
                            [variable]
                                name=difficulty.act1
                                greater_than=700
                            [/variable]
                            [then]
                                {VARIABLE_OP spawn_chance sub 1}
                            [/then]
                        [/if]
                        [if]
                            [variable]
                                name=difficulty.act1
                                greater_than=900
                            [/variable]
                            [then]
                                {VARIABLE_OP spawn_chance sub 1}
                            [/then]
                        [/if]
                        [if]
                            [variable]
                                name=difficulty.act1
                                greater_than=1200
                            [/variable]
                            [then]
                                {VARIABLE_OP spawn_chance sub 1}
                            [/then]
                        [/if]
                        [if]
                            [variable]
                                name=difficulty.act1
                                greater_than=1500
                            [/variable]
                            [then]
                                {VARIABLE_OP spawn_chance sub 1}
                            [/then]
                        [/if]
                        [if]
                            [variable]
                                name=difficulty.act1
                                greater_than=2000
                            [/variable]
                            [then]
                                {VARIABLE_OP spawn_chance sub 1}
                            [/then]
                        [/if]
                        {VARIABLE_OP did_spawn rand "(1..$spawn_chance)"}
                        [if]
                            [variable]
                                name=did_spawn
                                equals=1
                            [/variable]
                            [then]
                                {VARIABLE_OP spawn_type rand (Giant Rat,Giant Scorpion,Giant Spider,Wolf,Direwolf,Great Wolf)}
                                {VARIABLE_OP spawn_x rand (83..110)}
                                {VARIABLE_OP spawn_y rand (185..200)}
                                {GENERIC_UNIT 7 $spawn_type $spawn_x $spawn_y}
                            [/then]
                        [/if]
                        {VARIABLE_OP did_spawn rand "(1..$spawn_chance)"}
                        [if]
                            [variable]
                                name=did_spawn
                                equals=1
                            [/variable]
                            [then]
                                [if]
                                    [variable]
                                        name=difficulty.act1
                                        greater_than=1300
                                    [/variable]
                                    [then]
                                        {VARIABLE_OP spawn_type rand (Orcish Warlord,Orcish Warrior,Orcish Slurbow,Orcish Crossbowman,Orcish Assassin,Orcish Slayer)}
                                    [/then]
                                    [else]
                                        {VARIABLE_OP spawn_type rand (Orcish Grunt,Orcish Warrior,Orcish Archer,Orcish Crossbowman,Orcish Assassin,Orcish Slayer)}
                                    [/else]
                                [/if]
                                {VARIABLE_OP spawn_x rand (171..178)}
                                {VARIABLE_OP spawn_y rand (194..199)}
                                {GENERIC_UNIT 8 $spawn_type $spawn_x $spawn_y}
                            [/then]
                        [/if]
                        {VARIABLE_OP did_spawn rand "(1..$spawn_chance)"}
                        [if]
                            [variable]
                                name=did_spawn
                                equals=1
                            [/variable]
                            [then]
                                [if]
                                    [variable]
                                        name=difficulty.act1
                                        greater_than=1500
                                    [/variable]
                                    [then]
                                        {VARIABLE_OP spawn_type rand (Skeleton,Skeleton Archer,Revenant,Bone Shooter,Deathblade,Ghoul,Necrophage,Ghost,Wraith,Shadow)}
                                    [/then]
                                    [else]
                                        {VARIABLE_OP spawn_type rand (Draug,Death Knight,Banebow,Revenant,Bone Shooter,Deathblade,Ghast,Necrophage,Reaper,Wraith,Shadow)}
                                    [/else]
                                [/if]
                                {VARIABLE_OP spawn_x rand (1..6)}
                                {VARIABLE_OP spawn_y rand (113..117)}
                                {GENERIC_UNIT 9 $spawn_type $spawn_x $spawn_y}
                            [/then]
                        [/if]
                        {VARIABLE_OP did_spawn rand "(1..$spawn_chance)"}
                        [if]
                            [variable]
                                name=did_spawn
                                equals=1
                            [/variable]
                            [then]
                                [if]
                                    [variable]
                                        name=difficulty.act1
                                        greater_than=1700
                                    [/variable]
                                    [then]
                                        {VARIABLE_OP spawn_type rand (Troll,Troll Shaman,Troll Whelp)}
                                    [/then]
                                    [else]
                                        {VARIABLE_OP spawn_type rand (Troll Warior,Troll Shaman,Troll Whelp,Great Troll)}
                                    [/else]
                                [/if]
                                {VARIABLE_OP spawn_x rand (91..98)}
                                {VARIABLE_OP spawn_y rand (109..113)}
                                {GENERIC_UNIT 6 $spawn_type $spawn_x $spawn_y}
                            [/then]
                        [/if]
                    [/then]
                [/if]

                [if]
                    [variable]
                        name=difficulty.act2
                        greater_than=200
                    [/variable]
                    [then]
                        {VARIABLE spawn_chance 8}
                        [if]
                            [variable]
                                name=difficulty.act2
                                greater_than=500
                            [/variable]
                            [then]
                                {VARIABLE_OP spawn_chance sub 1}
                            [/then]
                        [/if]
                        [if]
                            [variable]
                                name=difficulty.act2
                                greater_than=800
                            [/variable]
                            [then]
                                {VARIABLE_OP spawn_chance sub 1}
                            [/then]
                        [/if]
                        [if]
                            [variable]
                                name=difficulty.act2
                                greater_than=1100
                            [/variable]
                            [then]
                                {VARIABLE_OP spawn_chance sub 1}
                            [/then]
                        [/if]
                        [if]
                            [variable]
                                name=difficulty.act2
                                greater_than=1500
                            [/variable]
                            [then]
                                {VARIABLE_OP spawn_chance sub 1}
                            [/then]
                        [/if]
                        [if]
                            [variable]
                                name=difficulty.act2
                                greater_than=2000
                            [/variable]
                            [then]
                                {VARIABLE_OP spawn_chance sub 1}
                            [/then]
                        [/if]
                        [if]
                            [variable]
                                name=difficulty.act2
                                greater_than=2500
                            [/variable]
                            [then]
                                {VARIABLE_OP spawn_chance sub 1}
                            [/then]
                        [/if]
                        [if]
                            [variable]
                                name=difficulty.act2
                                greater_than=3500
                            [/variable]
                            [then]
                                {VARIABLE_OP spawn_chance sub 1}
                            [/then]
                        [/if]
                        {VARIABLE_OP did_spawn rand "(1..$spawn_chance)"}
                        [if]
                            [variable]
                                name=did_spawn
                                equals=1
                            [/variable]
                            [then]
                                {VARIABLE_OP spawn_type rand (Corrupted Orcish Grunt,Corrupted Orcish Grunt,Corrupted Orcish Assassin,Corrupted Orcish Assassin,Corrupted Orcish Warrior,Corrupted Orcish Slayer,Spell Eater)}
                                {VARIABLE_OP spawn_x rand (185..200)}
                                {VARIABLE_OP spawn_y rand (6..18)}
                                {GENERIC_UNIT 7 $spawn_type $spawn_x $spawn_y}
                            [/then]
                        [/if]
                        {VARIABLE_OP did_spawn rand "(1..$spawn_chance)"}
                        [if]
                            [variable]
                                name=did_spawn
                                equals=1
                            [/variable]
                            [then]
                                [if]
                                    [variable]
                                        name=difficulty.act2
                                        greater_than=2200
                                    [/variable]
                                    [then]
                                        {VARIABLE_OP spawn_type rand (Corrupted Elvish Fighter,Corrupted Elvish Fighter,Corrupted Elvish Fighter,Corrupted Elvish Scout,Corrupted Elvish Scout,Corrupted Elvish Scout,Corrupted Elvish Hero,Corrupted Elvish Captain,Spell Eater)}
                                    [/then]
                                    [else]
                                        {VARIABLE_OP spawn_type rand (Corrupted Elvish Fighter,Corrupted Elvish Scout,Corrupted Elvish Hero,Corrupted Elvish Captain,Spell Eater)}
                                    [/else]
                                [/if]
                                {VARIABLE_OP spawn_x rand (105..125)}
                                {VARIABLE_OP spawn_y rand (72..83)}
                                {GENERIC_UNIT 8 $spawn_type $spawn_x $spawn_y}
                            [/then]
                        [/if]
                        {VARIABLE_OP did_spawn rand "(1..$spawn_chance)"}
                        [if]
                            [variable]
                                name=did_spawn
                                equals=1
                            [/variable]
                            [then]
                                [if]
                                    [variable]
                                        name=difficulty.act2
                                        greater_than=2300
                                    [/variable]
                                    [then]
                                        {VARIABLE_OP spawn_type rand (Corrupted Naga Fighter,Corrupted Naga Warrior)}
                                    [/then]
                                    [else]
                                        {VARIABLE_OP spawn_type rand (Corrupted Naga Fighter,Corrupted Naga Warrior,Corrupted Naga Myrmidon)}
                                    [/else]
                                [/if]
                                {VARIABLE_OP spawn_x rand (96..110)}
                                {VARIABLE_OP spawn_y rand (1..10)}
                                {GENERIC_UNIT 9 $spawn_type $spawn_x $spawn_y}
                            [/then]
                        [/if]
                        {VARIABLE_OP did_spawn rand "(1..$spawn_chance)"}
                        [if]
                            [variable]
                                name=did_spawn
                                equals=1
                            [/variable]
                            [then]
                                [if]
                                    [variable]
                                        name=difficulty.act2
                                        greater_than=2800
                                    [/variable]
                                    [then]
                                        {VARIABLE_OP spawn_type rand (Bowman,Spearman,Heavy Infantryman,Cavalryman,Horseman,Dark Adept)}
                                    [/then]
                                    [else]
                                        {VARIABLE_OP spawn_type rand (Bowman,Spearman,Heavy Infantryman,Cavalryman,Horseman,Dark Adept,Longbowman,Swordsman,Javelineer,Pikeman,Shock Trooper,Dragoon,Knight,Lancer,Dark Sorcerer)}
                                    [/else]
                                [/if]
                                {VARIABLE_OP spawn_x rand (60..73)}
                                {VARIABLE_OP spawn_y rand (33..42)}
                                [unit]
                                    type=$spawn_type
                                    x,y=$spawn_x,$spawn_y
                                    side=9
                                    to_variable=blackening_store
                                    generate_name=yes
                                    random_traits=yes
                                    random_gender=yes
                                [/unit]
                                {MAKE_BLACK_SOUL}
                                [clear_variable]
                                    name=blackening_store
                                [/clear_variable]
                            [/then]
                        [/if]
                    [/then]
                [/if]
                [if]
                    [variable]
                        name=difficulty.act3
                        greater_than=300
                    [/variable]
                    [then]
                        {VARIABLE spawn_chance 8}
                        [if]
                            [variable]
                                name=difficulty.act3
                                greater_than=700
                            [/variable]
                            [then]
                                {VARIABLE_OP spawn_chance sub 1}
                            [/then]
                        [/if]
                        [if]
                            [variable]
                                name=difficulty.act3
                                greater_than=1100
                            [/variable]
                            [then]
                                {VARIABLE_OP spawn_chance sub 1}
                            [/then]
                        [/if]
                        [if]
                            [variable]
                                name=difficulty.act3
                                greater_than=1500
                            [/variable]
                            [then]
                                {VARIABLE_OP spawn_chance sub 1}
                            [/then]
                        [/if]
                        [if]
                            [variable]
                                name=difficulty.act3
                                greater_than=2200
                            [/variable]
                            [then]
                                {VARIABLE_OP spawn_chance sub 1}
                            [/then]
                        [/if]
                        [if]
                            [variable]
                                name=difficulty.act3
                                greater_than=3000
                            [/variable]
                            [then]
                                {VARIABLE_OP spawn_chance sub 1}
                            [/then]
                        [/if]
                        [if]
                            [variable]
                                name=difficulty.act3
                                greater_than=4000
                            [/variable]
                            [then]
                                {VARIABLE_OP spawn_chance sub 1}
                            [/then]
                        [/if]
                        [if]
                            [variable]
                                name=difficulty.act3
                                greater_than=5000
                            [/variable]
                            [then]
                                {VARIABLE_OP spawn_chance sub 1}
                            [/then]
                        [/if]
                        {VARIABLE_OP did_spawn rand "(1..$spawn_chance)"}
                        [if]
                            [variable]
                                name=did_spawn
                                equals=1
                            [/variable]
                            [then]
                                {VARIABLE_OP spawn_type rand (Bowman,Spearman,Heavy Infantryman,Cavalryman,Horseman,Dark Adept)}
                                {VARIABLE_OP spawn_x rand (17..20)}
                                {VARIABLE_OP spawn_y rand (3..6)}
                                [unit]
                                    type=$spawn_type
                                    x,y=$spawn_x,$spawn_y
                                    side=8
                                    to_variable=blackening_store
                                    generate_name=yes
                                    random_traits=yes
                                    random_gender=yes
                                [/unit]
                                {MAKE_BLACK_SOUL}
                                [clear_variable]
                                    name=blackening_store
                                [/clear_variable]
                            [/then]
                        [/if]
                        {VARIABLE_OP did_spawn rand "(1..$spawn_chance)"}
                        [if]
                            [variable]
                                name=did_spawn
                                equals=1
                            [/variable]
                            [then]
                                [if]
                                    [variable]
                                        name=difficulty.act3
                                        greater_than=3500
                                    [/variable]
                                    [then]
                                        {VARIABLE spawn_type Demon}
                                    [/then]
                                    [else]
                                        {VARIABLE_OP spawn_type rand (Demon Warrior,Demon,Demon)}
                                    [/else]
                                [/if]
                                {VARIABLE_OP spawn_x rand (31..39)}
                                {VARIABLE_OP spawn_y rand (49..54)}
                                {GENERIC_UNIT 12 $spawn_type $spawn_x $spawn_y}
                            [/then]
                        [/if]
                        {VARIABLE_OP did_spawn rand "(1..$spawn_chance)"}
                        [if]
                            [variable]
                                name=did_spawn
                                equals=1
                            [/variable]
                            [then]
                                [if]
                                    [variable]
                                        name=difficulty.act3
                                        greater_than=3700
                                    [/variable]
                                    [then]
                                        {VARIABLE spawn_type Demon}
                                    [/then]
                                    [else]
                                        {VARIABLE_OP spawn_type rand (Demon Warrior,Demon,Demon)}
                                    [/else]
                                [/if]
                                {VARIABLE_OP spawn_x rand (22..32)}
                                {VARIABLE_OP spawn_y rand (78..86)}
                                {GENERIC_UNIT 13 $spawn_type $spawn_x $spawn_y}
                            [/then]
                        [/if]
                        {VARIABLE_OP did_spawn rand "(1..$spawn_chance)"}
                        [if]
                            [variable]
                                name=did_spawn
                                equals=1
                            [/variable]
                            [then]
                                [if]
                                    [variable]
                                        name=difficulty.act3
                                        greater_than=3800
                                    [/variable]
                                    [then]
                                        {VARIABLE_OP spawn_type rand (Bowman,Spearman,Heavy Infantryman,Cavalryman,Horseman,Dark Adept,Longbowman,Swordsman,Javelineer,Pikeman,Shock Trooper,Dragoon,Knight,Lancer,Dark Sorcerer)}
                                    [/then]
                                    [else]
                                        {VARIABLE_OP spawn_type rand (Bowman,Spearman,Heavy Infantryman,Cavalryman,Horseman,Dark Adept,Longbowman,Swordsman,Javelineer,Pikeman,Shock Trooper,Dragoon,Knight,Lancer,Dark Sorcerer,Master Bowman,Royal Guard,Halberdier,Grand Marshal,General,Iron Mauler,Cavalier,Grand Knight,Necromancer)}
                                    [/else]
                                [/if]
                                {VARIABLE_OP spawn_x rand (36..39)}
                                {VARIABLE_OP spawn_y rand (88..91)}
                                [unit]
                                    type=$spawn_type
                                    x,y=$spawn_x,$spawn_y
                                    side=7
                                    to_variable=blackening_store
                                    generate_name=yes
                                    random_traits=yes
                                    random_gender=yes
                                [/unit]
                                {MAKE_BLACK_SOUL}
                                [clear_variable]
                                    name=blackening_store
                                [/clear_variable]
                            [/then]
                        [/if]
                    [/then]
                [/if]
                [if]
                    [variable]
                        name=difficulty.act4
                        greater_than=500
                    [/variable]
                    [then]
                        {VARIABLE spawn_chance 8}
                        [if]
                            [variable]
                                name=difficulty.act4
                                greater_than=1100
                            [/variable]
                            [then]
                                {VARIABLE_OP spawn_chance sub 1}
                            [/then]
                        [/if]
                        [if]
                            [variable]
                                name=difficulty.act4
                                greater_than=1500
                            [/variable]
                            [then]
                                {VARIABLE_OP spawn_chance sub 1}
                            [/then]
                        [/if]
                        [if]
                            [variable]
                                name=difficulty.act4
                                greater_than=2200
                            [/variable]
                            [then]
                                {VARIABLE_OP spawn_chance sub 1}
                            [/then]
                        [/if]
                        [if]
                            [variable]
                                name=difficulty.act4
                                greater_than=3000
                            [/variable]
                            [then]
                                {VARIABLE_OP spawn_chance sub 1}
                            [/then]
                        [/if]
                        [if]
                            [variable]
                                name=difficulty.act4
                                greater_than=4000
                            [/variable]
                            [then]
                                {VARIABLE_OP spawn_chance sub 1}
                            [/then]
                        [/if]
                        [if]
                            [variable]
                                name=difficulty.act4
                                greater_than=5000
                            [/variable]
                            [then]
                                {VARIABLE_OP spawn_chance sub 1}
                            [/then]
                        [/if]
                        [if]
                            [variable]
                                name=difficulty.act4
                                greater_than=5500
                            [/variable]
                            [then]
                                {VARIABLE_OP spawn_chance sub 1}
                            [/then]
                        [/if]
                        {VARIABLE_OP did_spawn rand "(1..$spawn_chance)"}
                        [if]
                            [variable]
                                name=did_spawn
                                equals=1
                            [/variable]
                            [then]
                                {VARIABLE_OP spawn_type rand (Bowman,Spearman,Heavy Infantryman,Cavalryman,Horseman,Dark Adept,Longbowman,Swordsman,Javelineer,Pikeman,Shock Trooper,Dragoon,Knight,Lancer,Dark Sorcerer,Master Bowman,Royal Guard,Halberdier,Grand Marshal,General,Iron Mauler,Cavalier,Grand Knight,Necromancer)}
                                {VARIABLE_OP spawn_x rand (164..167)}
                                {VARIABLE_OP spawn_y rand (95..99)}
                                [unit]
                                    type=$spawn_type
                                    x,y=$spawn_x,$spawn_y
                                    side=6
                                    to_variable=blackening_store
                                    generate_name=yes
                                    random_traits=yes
                                    random_gender=yes
                                [/unit]
                                {MAKE_BLACK_SOUL}
                                [clear_variable]
                                    name=blackening_store
                                [/clear_variable]
                            [/then]
                        [/if]
                        {VARIABLE_OP did_spawn rand "(1..$spawn_chance)"}
                        [if]
                            [variable]
                                name=did_spawn
                                equals=1
                            [/variable]
                            [then]
                                [if]
                                    [variable]
                                        name=difficulty.act4
                                        greater_than=5300
                                    [/variable]
                                    [then]
                                        {VARIABLE_OP spawn_type rand (Bowman,Spearman,Heavy Infantryman,Cavalryman,Horseman,Dark Adept,Longbowman,Swordsman,Javelineer,Pikeman,Shock Trooper,Dragoon,Knight,Lancer,Dark Sorcerer,Master Bowman,Royal Guard,Halberdier,Grand Marshal,General,Iron Mauler,Cavalier,Grand Knight,Necromancer)}
                                    [/then]
                                    [else]
                                        {VARIABLE_OP spawn_type rand (Bowman,Spearman,Heavy Infantryman,Cavalryman,Horseman,Dark Adept,Longbowman,Swordsman,Javelineer,Pikeman,Shock Trooper,Dragoon,Knight,Lancer,Dark Sorcerer,Master Bowman,Royal Guard,Halberdier,Grand Marshal,General,Iron Mauler,Cavalier,Grand Knight,Necromancer,Destroyer,Dragon Rider,Champion Bowman)}
                                    [/else]
                                [/if]
                                {VARIABLE_OP spawn_x rand (36..39)}
                                {VARIABLE_OP spawn_y rand (88..91)}
                                [unit]
                                    type=$spawn_type
                                    x,y=$spawn_x,$spawn_y
                                    side=9
                                    to_variable=blackening_store
                                    generate_name=yes
                                    random_traits=yes
                                    random_gender=yes
                                [/unit]
                                {MAKE_BLACK_SOUL}
                                [clear_variable]
                                    name=blackening_store
                                [/clear_variable]
                            [/then]
                        [/if]
                    [/then]
                [/if]
            [/then]
        [/if]
    [/event]
    [event]
        name=moveto
        [filter]
            side=1,2,3,4,5
            x,y=1-160,94-200
            canrecruit=no
            [or]
                side=1,2,3,4,5
                x,y=160-200,147-200
                canrecruit=no
            [/or]
        [/filter]
        [if]
            [variable]
                name=difficulty[$side_number].act
                not_equals=1
            [/variable]
            [then]
                [store_unit]
                    [filter]
                        side=$side_number
                        canrecruit=yes
                    [/filter]
                    kill=no
                    variable=leader
                [/store_unit]
                [chat]
                    speaker=Information
                    message= _ "You are not allowed to teleport into another act."
                [/chat]
                [teleport]
                    [filter]
                        id=$unit.id
                    [/filter]
                    x,y=$leader.x,$leader.y
                    clear_shroud=yes
                    animate=no
                [/teleport]
            [/then]
        [/if]

        [allow_undo]
        [/allow_undo]
        {CLEAR_VARIABLE leader}
    [/event]
    [event]
        name=moveto
        [filter]
            side=1,2,3,4,5
            x,y=60-200,0-80
            canrecruit=no
            [or]
                side=1,2,3,4,5
                x,y=95-200,60-93
                canrecruit=no
            [/or]
        [/filter]
        [if]
            [variable]
                name=difficulty[$side_number].act
                not_equals=2
            [/variable]
            [then]
                [store_unit]
                    [filter]
                        side=$side_number
                        canrecruit=yes
                    [/filter]
                    kill=no
                    variable=leader
                [/store_unit]
                [chat]
                    speaker=Information
                    message= _ "You are not allowed to teleport into another act."
                [/chat]
                [teleport]
                    [filter]
                        id=$unit.id
                    [/filter]
                    x,y=$leader.x,$leader.y
                    clear_shroud=yes
                    animate=no
                [/teleport]
            [/then]
        [/if]

        [allow_undo]
        [/allow_undo]
        {CLEAR_VARIABLE leader}
    [/event]
    [event]
        name=moveto
        [filter]
            side=1,2,3,4,5
            x,y=0-53,0-92
            canrecruit=no
        [/filter]
        [if]
            [variable]
                name=difficulty[$side_number].act
                not_equals=3
            [/variable]
            [then]
                [store_unit]
                    [filter]
                        side=$side_number
                        canrecruit=yes
                    [/filter]
                    kill=no
                    variable=leader
                [/store_unit]
                [chat]
                    speaker=Information
                    message= _ "You are not allowed to teleport into another act."
                [/chat]
                [teleport]
                    [filter]
                        id=$unit.id
                    [/filter]
                    x,y=$leader.x,$leader.y
                    clear_shroud=yes
                    animate=no
                [/teleport]
            [/then]
        [/if]

        [allow_undo]
        [/allow_undo]
        {CLEAR_VARIABLE leader}
    [/event]
    [event]
        name=moveto
        [filter]
            side=1,2,3,4,5
            x,y=164-200,94-146
            canrecruit=no
        [/filter]
        [if]
            [variable]
                name=difficulty[$side_number].act
                not_equals=4
            [/variable]
            [then]
                [store_unit]
                    [filter]
                        side=$side_number
                        canrecruit=yes
                    [/filter]
                    kill=no
                    variable=leader
                [/store_unit]
                [chat]
                    speaker=Information
                    message= _ "Illegal penetration into another act."
                [/chat]
                [teleport]
                    [filter]
                        id=$unit.id
                    [/filter]
                    x,y=$leader.x,$leader.y
                    clear_shroud=yes
                    animate=no
                [/teleport]
            [/then]
        [/if]

        [allow_undo]
        [/allow_undo]
        {CLEAR_VARIABLE leader}
    [/event]
[/multiplayer]
#undef PLACE_SPAWN
#undef PLACE_SPAWNS
#undef BLACKEN
#undef A1BOSSES_KILL_CHECK
#undef A2BOSSES_KILL_CHECK
#undef KEEP_DISCOVER
#undef ENEMY_SPAWN
#undef GOLD_CHEST
#undef TRAVEL_TO

#textdomain wesnoth-loti

#define SETUP_LOCATIONS
    [set_variables]
        name=map_locations
        mode=replace
        [value]
            [area]
                number=0
                name= _ "Bugged Area"
                id="00_Bugged_Area"
                x=5
                y=7
            [/area]
            [area]
                number=1
                name= _ "Transporting Facility"
                id="01_Transporting_Facility"
                x=376
                y=547
            [/area]
            [area]
                number=2
                name= _ "Tunnels of Cruelty"
                id="02_Tunnels_of_Cruelty"
                x=348
                y=504
            [/area]
            [area]
                number=3
                name= _ "Shores of Abyss"
                id="03_Shores_of_Abyss"
                x=617
                y=535
            [/area]
            [area]
                number=4
                name= _ "Grim Port"
                id="04_Grim_Port"
                x=727
                y=561
            [/area]
            [area]
                number=5
                name= _ "Stygian Caverns"
                id="05_Stygian_Caverns"
                x=755
                y=542
            [/area]
            [area]
                number=6
                name= _ "Zhangor's Pass"
                id="06_Zhangors_Pass"
                x=652
                y=456
            [/area]
            [area]
                number=7
                name= _ "Wasteland of Lost Eternity"
                id="07_Wasteland_of_Lost_Eternity"
                x=672
                y=350
            [/area]
            [area]
                number=8
                name= _ "Doom Ford"
                id="08_Doom_Ford"
                x=242
                y=438
            [/area]
            [area]
                number=9
                name= _ "Infernal Narrows"
                id="09_Infernal_Narrows"
                x=166
                y=450
            [/area]
            [area]
                number=10
                name= _ "Fortress of Blackened Dreams"
                id="10_Fortress_of_Blackened_Dreams"
                x=76
                y=507
            [/area]
            [area]
                number=11
                name= _ "Fortress of Blackened Dreams (interior)"
                id="11_Fortress_of_Blackened_Dreams_Interior"
                no_map=yes
                x=57
                y=518
            [/area]
            [area]
                number=12
                name= _ "Tainted Shores"
                id="12_Tainted_Shores"
                x=173
                y=346
            [/area]
            [area]
                number=13
                name= _ "Dominion of Evil Terror"
                id="13_Dominion_of_Evil_Terror"
                x=68
                y=357
            [/area]
            [area]
                number=14
                name= _ "Foul Pits"
                id="14_Foul_Pits"
                x=74
                y=315
            [/area]
            [area]
                number=15
                name= _ "Plains of Chaos"
                id="15_Plains_of_Chaos"
                x=345
                y=355
            [/area]
            [area]
                number=16
                name= _ "Sinful Caves"
                id="16_Sinful_Caves"
                x=271
                y=344
            [/area]
            [area]
                number=17
                name= _ "River Styx"
                id="17_River_Styx"
                x=473
                y=309
            [/area]
            [area]
                number=18
                name= _ "Valley of Shattered Souls"
                id="18_Valley_of_Shattered_Souls"
                x=522
                y=402
            [/area]
            [area]
                number=19
                name= _ "Land of Misery"
                id="19_Land_of_Misery"
                x=698
                y=218
            [/area]
            [area]
                number=20
                name= _ "Unholy Realm"
                id="20_Unholy_Realm"
                x=676
                y=90
            [/area]
            [area]
                number=21
                name= _ "Tormentor's Burrow"
                id="21_Tormentors_Burrow"
                x=724
                y=61
            [/area]
            [area]
                number=22
                name= _ "Where the Hatred Grows"
                id="22_Where_the_Hatred_Grows"
                x=288
                y=234
            [/area]
            [area]
                number=23
                name= _ "Empire of Suffering"
                id="23_Empire_of_Suffering"
                x=165
                y=127
            [/area]
            [area]
                number=24
                name= _ "Island of Atrocity"
                id="24_Island_of_Atrocity"
                x=75
                y=176
            [/area]
            [area]
                number=25
                name= _ "Chambers of Oblivion"
                id="25_Chambers_of_Oblivion"
                x=80
                y=151
            [/area]
            [area]
                number=26
                name= _ "Filthy Keep"
                id="26_Filthy_Keep"
                x=204
                y=78
            [/area]
            [area]
                number=27
                name= _ "Stronghold of Tears"
                id="27_Stronghold_of_Tears"
                x=497
                y=217
            [/area]
            [area]
                number=28
                name= _ "Twilit Fortress"
                id="28_Twilit_Fortress"
                x=645
                y=204
            [/area]
            [area]
                number=29
                name= _ "Wicked Barony"
                id="29_Wicked_Barony"
                x=276
                y=108
            [/area]
            [area]
                number=30
                name= _ "Nightmare Cellar"
                id="30_Nightmare_Cellar"
                x=272
                y=44
            [/area]
            [area]
                number=31
                name= _ "Bank of Ill Luck"
                id="31_Bank_of_Ill_Luck"
                x=599
                y=135
            [/area]
            [area]
                number=32
                name= _ "Domain of Disaster"
                id="32_Domain_of_Disaster"
                x=526
                y=116
            [/area]
            [area]
                number=33
                name= _ "Pandemonium"
                id="33_Pandemonium"
                x=403
                y=104
            [/area]
            [area]
                number=34
                name= _ "Uria's Den"
                id="34_Urias_Den"
                x=404
                y=55
            [/area]
            [area]
                number=35
                name= _ "Antechambers of Ultimate Evil"
                id="35_Antechambers_of_Ultimate_Evil"
                x=404
                y=55
                no_map=yes
                outside_map=yes
            [/area]
            [area]
                number=36
                name= _ "Temple of Ultimate Evil"
                id="36_Temple_of_Ultimate_Evil"
                no_map=yes
                outside_map=yes
            [/area]
            [area]
                number=37
                name= _ "Catacombs of Prolonged Agony"
                id="37_Catacombs_of_Prolonged_Agony"
                x=404
                y=55
                no_map=yes
                outside_map=yes
            [/area]
            [area]
                number=38
                name= _ "Halls of Miscreation"
                id="38_Halls_of_Miscreation"
                no_map=yes
                outside_map=yes
            [/area]
            [area]
                number=39
                name= _ "Steelhive"
                id="39_Steelhive"
                no_map=yes
                outside_map=yes
            [/area]
            [area]
                number=40
                name= _ "Steelhive Depths"
                id="40_Steelhive_Depths"
                no_map=yes
                outside_map=yes
            [/area]
            [area]
                number=41
                name= _ "Heart of Steelhive"
                id="41_Heart_of_Steelhive"
                no_map=yes
                outside_map=yes
            [/area]
            [area]
                number=42
                name= _ "Passage of Detriment"
                id="42_Passage_of_Detriment"
                no_map=yes
                outside_map=yes
            [/area]
            [area]
                number=43
                name= _ "Verminous Sewers"
                id="43_Verminous_Sewers"
                no_map=yes
                outside_map=yes
            [/area]
            [area]
                number=44
                name= _ "Gathering Alcove"
                id="44_Gathering_Alcove"
                no_map=yes
                outside_map=yes
            [/area]
            [area]
                number=45
                name= _ "Refuge of Black Hope"
                id="45_Refuge_of_Black_Hope"
                no_map=yes
                outside_map=yes
            [/area]
            [area]
                number=46
                name= _ "Sepulcher of the Nefarious"
                id="46_Sepulcher_of_the_Nefarious"
                no_map=yes
                outside_map=yes
            [/area]
            [area]
                number=47
                name= _ "Basilica of Imperfection"
                id="47_Basilica_of_Imperfection"
                no_map=yes
                outside_map=yes
            [/area]
            [area]
                number=48
                name= _ "Execrable Sanctum"
                id="48_Execrable_Sanctum"
                no_map=yes
                outside_map=yes
            [/area]
        [/value]
    [/set_variables]
#enddef

#define STEELHIVE_PORTAL SIDE X Y
    [event]
        name=prestart
        [if]
            [variable]
                name=quests.destroyed_steelhive
                equals=yes
            [/variable]
            [else]
                [item]
                    image=scenery/portal-steelhive.png
                    halo=scenery/portal-steelhive-1.png:100,scenery/portal-steelhive-2.png:100,scenery/portal-steelhive-3.png:100,scenery/portal-steelhive-4.png:100,scenery/portal-steelhive-5.png:100,scenery/portal-steelhive-6.png:100
                    x,y={X},{Y}
                [/item]
                [event]
                    name=steelhive_spawn
                    id=steelhive_spawn
                    first_time_only=no
                    [if]
                        [variable]
                            name=quests.destroyed_steelhive
                            equals=yes
                        [/variable]
                        [else]
#ifdef HARD
                            {VARIABLE_OP spawn_type rand (Machine Oculus,Machine Vector,Machine Drone,Machine Sparkgazer,Machine Vorpal,Machine Welder)}
#endif
#ifdef NORMAL
                            {VARIABLE_OP spawn_type rand (Machine Oculus,Machine Vector,Machine Drone,Machine Oculus,Machine Vector,Machine Drone,Machine Oculus,Machine Vector,Machine Drone,Machine Sparkgazer,Machine Vorpal,Machine Welder,Machine Sparkgazer,Machine Vorpal,Machine Welder)}
#endif
#ifdef EASY
                            {VARIABLE_OP spawn_type rand (Machine Oculus,Machine Vector,Machine Drone,Machine Oculus,Machine Vector,Machine Drone,Machine Sparkgazer,Machine Vorpal,Machine Welder)}
#endif
                            {GENERIC_UNIT {SIDE} $spawn_type {X} {Y}}
                            {CLEAR_VARIABLE spawn_type}
                        [/else]
                    [/if]
                [/event]
            [/else]
        [/if]
    [/event]

#enddef

#define INFERNO_SPAWN COORDINATES X Y TYPES COUNT VAR SIDE
    [event]
        name=moveto
        [filter]
            side=1
            x,y={COORDINATES}
        [/filter]
        [if]
            [variable]
                name=quests.{VAR}
                equals=yes
            [/variable]
            [else]
                {VARIABLE spawn_count {COUNT}}
#ifdef HARD
                {VARIABLE_OP spawn_count multiply "1.2"}
#endif
#ifdef EASY
                {VARIABLE_OP spawn_count divide "1.2"}
#endif
                [while]
                    [variable]
                        name=spawn_count
                        greater_than=0
                    [/variable]
                    [do]
                        {VARIABLE_OP spawn_type rand {TYPES}}
                        {GENERIC_UNIT {SIDE} $spawn_type {X} {Y}}
                        {VARIABLE_OP spawn_count sub 1}
                    [/do]
                [/while]
                {VARIABLE quests.{VAR} yes}
            [/else]
        [/if]

        {CLEAR_VARIABLE spawn_count,spawn_type}
    [/event]
#enddef

#define INFERNO_LEADER_ONLY_SOMETIMES EVENT_NAME ID TYPE
    [event]
        name={EVENT_NAME}
        [modify_unit]
            [filter]
                id={ID}
            [/filter]
            canrecruit=no
        [/modify_unit]
    [/event]
    [event]
        name=attacker hits
        id=attacker hits {ID} leader only sometimes
        [filter_second]
            id={ID}
            type={TYPE}
        [/filter_second]
        [filter_condition]
            [variable]
                name=second_unit.hitpoints
                less_than="$($second_unit.max_hitpoints/3)"
            [/variable]
        [/filter_condition]
        [modify_unit]
            [filter]
                id={ID}
            [/filter]
            canrecruit=yes
        [/modify_unit]
    [/event]
    [event]
        name=defender hits
        id=defender hits {ID} leader only sometimes
        [filter]
            id={ID}
            type={TYPE}
        [/filter]
        [filter_condition]
            [variable]
                name=unit.hitpoints
                less_than="$($unit.max_hitpoints/3)"
            [/variable]
        [/filter_condition]
        [modify_unit]
            [filter]
                id={ID}
            [/filter]
            canrecruit=yes
        [/modify_unit]
    [/event]
#enddef

#define INFERNO_LILITH_SPAWN COORDINATES X Y SIDE
    [event]
        name=moveto
        [filter]
            side=1
            x,y={COORDINATES}
        [/filter]
        [if]
            [variable]
                name=quests.lilith
                greater_than=2
            [/variable]
            [else]
                {VARIABLE spawn_count 10}
                [if]
                    [variable]
                        name=quests.met_lilith
                        greater_than=0
                    [/variable]
                    [then]
                        {VARIABLE_OP did_spawn rand (yes,no,no)}
                        {VARIABLE_OP spawn_count add "$(2*$quests.seen_lilith)"}
                    [/then]
                    [else]
                        {VARIABLE quests.lilith 1}
                        {VARIABLE did_spawn yes}
                    [/else]
                [/if]
                [if]
                    [variable]
                        name=did_spawn
                        equals=yes
                    [/variable]
                    [then]
                        [if]
                            [variable]
                                name=quests.met_lilith
                                greater_than=0
                            [/variable]
                            [then]
                                {VARIABLE_OP quests.met_lilith add 1}
                            [/then]
                            [else]
                                {VARIABLE quests.met_lilith 1}
                            [/else]
                        [/if]

#ifdef HARD
                        {VARIABLE_OP spawn_count multiply "1.2"}
#endif
#ifdef EASY
                        {VARIABLE_OP spawn_count divide "1.2"}
#endif
                        [unit]
                            x,y={X},{Y}
                            side={SIDE}
                            type=Lilith
                            id=Lilith
                            name= _ "Lilith"
                            random_traits=yes
                        [/unit]
                        [modify_unit]
                            [filter]
                                id=Lilith
                            [/filter]
                            canrecruit=yes
                        [/modify_unit]
                        [modify_side]
                            side={SIDE}
                            {INCOME 40 55 70}
                        [/modify_side]
                        [object]
                            silent=yes
                            [filter]
                                id=Lilith
                            [/filter]
                            [effect]
                                apply_to=attack
                                increase_damage="$($quests.met_lilith*2-$quests.lilith_deaths)"
                            [/effect]
                            [effect]
                                apply_to=hitpoints
                                increase_total="$($quests.met_lilith*60-$quests.lilith_deaths*30)"
                                heal_full=yes
                            [/effect]
                        [/object]
                        [remove_shroud]
                            x,y={X},{Y}
                            radius=2
                            side=1
                        [/remove_shroud]
                        [while]
                            [variable]
                                name=spawn_count
                                greater_than=0
                            [/variable]
                            [do]
                                {VARIABLE_OP spawn_type rand (Knight of Disaster,Knight of Disaster,Doom Knight,Knight of Pain,Knight of Disaster,Knight of Disaster,Doom Knight,Knight of Pain,Knight of Annihilation,Knight of Oblivion)}
                                {GENERIC_UNIT {SIDE} $spawn_type {X} {Y}}
                                {VARIABLE_OP spawn_count sub 1}
                            [/do]
                        [/while]
                        [modify_side]
                            side=1
                            fog=no
                        [/modify_side]
                        [fire_event]
                            name=lilith chat
                        [/fire_event]
                        [modify_side]
                            side=1
                            fog=yes
                        [/modify_side]
                    [/then]
                [/if]
                {CLEAR_VARIABLE spawn_count,spawn_type,did_spawn}
            [/else]
        [/if]
    [/event]
#enddef

#define INFERNO_ABADDON_SPAWN COORDINATES X Y SIDE
    [event]
        name=moveto
        [filter]
            side=1
            x,y={COORDINATES}
        [/filter]
        [if]
            [variable]
                name=quests.abaddon
                greater_than=2
            [/variable]
            [else]
                {VARIABLE spawn_count 10}
                [if]
                    [variable]
                        name=quests.met_abaddon
                        greater_than=0
                    [/variable]
                    [then]
                        {VARIABLE_OP did_spawn rand (yes,no,no)}
                        {VARIABLE_OP spawn_count add "$(2*$quests.seen_abaddon)"}
                    [/then]
                    [else]
                        {VARIABLE did_spawn yes}
                    [/else]
                [/if]
                [if]
                    [variable]
                        name=did_spawn
                        equals=yes
                    [/variable]
                    [then]
                        [if]
                            [variable]
                                name=quests.abaddon
                                greater_than=1
                            [/variable]
                            [else]
                                {VARIABLE quests.abaddon 1}
                            [/else]
                        [/if]
                        [if]
                            [variable]
                                name=quests.met_abaddon
                                greater_than=0
                            [/variable]
                            [then]
                                {VARIABLE_OP quests.met_abaddon add 1}
                            [/then]
                            [else]
                                {VARIABLE quests.met_abaddon 1}
                            [/else]
                        [/if]

#ifdef HARD
                        {VARIABLE_OP spawn_count multiply "1.2"}
#endif
#ifdef EASY
                        {VARIABLE_OP spawn_count divide "1.2"}
#endif
                        [unit]
                            x,y={X},{Y}
                            side={SIDE}
                            type=Abaddon
                            id=Abaddon
                            name= _ "Abaddon"
                            random_traits=yes
                        [/unit]
                        [modify_unit]
                            [filter]
                                id=Abaddon
                            [/filter]
                            canrecruit=yes
                        [/modify_unit]
                        [modify_side]
                            side={SIDE}
                            {INCOME 40 55 70}
                        [/modify_side]
                        [object]
                            silent=yes
                            [filter]
                                id=Abaddon
                            [/filter]
                            [effect]
                                apply_to=attack
                                increase_damage="$($quests.met_abaddon*4-$quests.abaddon_deaths*2)"
                            [/effect]
                            [effect]
                                apply_to=hitpoints
                                increase_total="$($quests.met_abaddon*80-$quests.abaddon_deaths*40)"
                                heal_full=yes
                            [/effect]
                        [/object]
                        [remove_shroud]
                            x,y={X},{Y}
                            radius=2
                            side=1
                        [/remove_shroud]
                        [while]
                            [variable]
                                name=spawn_count
                                greater_than=0
                            [/variable]
                            [do]
                                {VARIABLE_OP spawn_type rand (Demon,Demon Warrior,Demon Manowar,Hellhound,Shadow Hound,Succubus)}
                                {GENERIC_UNIT {SIDE} $spawn_type {X} {Y}}
                                {VARIABLE_OP spawn_count sub 1}
                            [/do]
                        [/while]
                        [modify_side]
                            side=1
                            fog=no
                        [/modify_side]
                        [fire_event]
                            name=abaddon chat
                        [/fire_event]
                        [modify_side]
                            side=1
                            fog=yes
                        [/modify_side]
                    [/then]
                [/if]
                {CLEAR_VARIABLE spawn_count,spawn_type,did_spawn}
            [/else]
        [/if]
    [/event]
#enddef

#define INFERNO_URIA_AVATAR_SPAWN COORDINATES X Y SIDE
    [event]
        name=moveto
        [filter]
            side=1
            x,y={COORDINATES}
        [/filter]
        {VARIABLE spawn_count 20}
        [if]
            [variable]
                name=quests.met_uria_avatar
                greater_than=0
            [/variable]
            [then]
                {VARIABLE_OP did_spawn rand (yes,no,no,no)}
                {VARIABLE_OP spawn_count add "$(4*$quests.met_uria_avatar)"}
            [/then]
            [else]
                {VARIABLE did_spawn yes}
            [/else]
        [/if]
        [if]
            [variable]
                name=did_spawn
                equals=yes
            [/variable]
            [then]
                [if]
                    [variable]
                        name=quests.met_uria_avatar
                        greater_than=0
                    [/variable]
                    [then]
                        {VARIABLE_OP quests.met_uria_avatar add 1}
                    [/then]
                    [else]
                        {VARIABLE quests.met_uria_avatar 1}
                    [/else]
                [/if]

#ifdef HARD
                {VARIABLE_OP spawn_count multiply "1.2"}
#endif
#ifdef EASY
                {VARIABLE_OP spawn_count divide "1.2"}
#endif
                [unit]
                    x,y={X},{Y}
                    side={SIDE}
                    type=Uria_avatar
                    id=Uria
                    name= _ "Uria"
                    canrecruit=yes
                [/unit]
                [modify_side]
                    side={SIDE}
                    {INCOME 40 55 70}
                [/modify_side]
                [object]
                    silent=yes
                    [filter]
                        id=Uria
                    [/filter]
                    [effect]
                        apply_to=attack
                        increase_damage="$($quests.met_uria_avatar*2-$quests.uria_avatar_deaths)"
                    [/effect]
                    [effect]
                        apply_to=hitpoints
                        increase_damage="$($quests.met_uria_avatar*60-$quests.uria_avatar_deaths*30)"
                        heal_full=yes
                        times=per_level
                    [/effect]
                [/object]
                [remove_shroud]
                    x,y={X},{Y}
                    radius=2
                    side=1
                [/remove_shroud]
                [while]
                    [variable]
                        name=spawn_count
                        greater_than=0
                    [/variable]
                    [do]
                        {VARIABLE_OP spawn_type rand (Machine Oculus,Machine Vector,Machine Drone,Machine Sparkgazer,Machine Vorpal,Machine Welder)}
                        {GENERIC_UNIT {SIDE} $spawn_type {X} {Y}}
                        {VARIABLE_OP spawn_count sub 1}
                    [/do]
                [/while]
                {VARIABLE uria_side {SIDE}}
                [modify_side]
                    side=1
                    fog=no
                [/modify_side]
                [fire_event]
                    name=uria avatar initialise
                [/fire_event]
                [fire_event]
                    name=uria avatar chat
                [/fire_event]
                [modify_side]
                    side=1
                    fog=yes
                [/modify_side]
            [/then]
        [/if]
        {CLEAR_VARIABLE spawn_count,spawn_type,did_spawn}
    [/event]
#enddef

#define INFERNO_ENEMY_NO_LEADER_SIDE SIDE
    [side]
        no_leader=yes
        side={SIDE}
        team_name=evil
        user_team_name=_"Evil"
        {AI_OVERHAUL_PLACE {SIDE}}
        {AI_OVERHAUL_PLACE_2 {SIDE}}
        [ai]
            aggression=1.0
        [/ai]
    [/side]
#enddef

#define INFERNO_LILITH_SIDE SIDE
    [side]
        no_leader=yes
        side={SIDE}
        team_name=evil
        user_team_name=_"Evil"
        {AI_OVERHAUL_PLACE {SIDE}}
        {AI_OVERHAUL_PLACE_2 {SIDE}}
        recruit=Knight of Disaster,Knight of Disaster,Doom Knight,Knight of Pain,Knight of Disaster,Knight of Disaster,Doom Knight,Knight of Pain,Knight of Annihilation,Knight of Oblivion
        [ai]
            aggression=1.0
            [avoid]	# Don't waste time to get healing
                terrain=*^Vzps
            [/avoid]
        [/ai]
    [/side]
#enddef

#define INFERNO_ABADDON_SIDE SIDE
    [side]
        no_leader=yes
        side={SIDE}
        team_name=evil
        user_team_name=_"Evil"
        {AI_OVERHAUL_PLACE {SIDE}}
        {AI_OVERHAUL_PLACE_2 {SIDE}}
        recruit=Demon,Demon Warrior,Demon Manowar,Hellhound,Shadow Hound,Succubus
        [ai]
            aggression=1.0
            [avoid]
                terrain=*^Vzps
            [/avoid]
        [/ai]
    [/side]
#enddef

#define INFERNO_URIA_AVATAR_SIDE SIDE
    [side]
        no_leader=yes
        side={SIDE}
        team_name=evil
        user_team_name=_"Evil"
        {AI_OVERHAUL_PLACE {SIDE}}
        {AI_OVERHAUL_PLACE_2 {SIDE}}
        recruit=Machine Oculus,Machine Vector,Machine Drone,Machine Sparkgazer,Machine Vorpal,Machine Welder
        [ai]
            aggression=1.0
            [avoid]
                terrain=*^Vzps
            [/avoid]
        [/ai]
    [/side]
#enddef

#define INFERNO_ROMERO_SIDE SIDE
    [side]
        no_leader=yes
        side={SIDE}
        team_name=evil
        user_team_name=_"Evil"
        {AI_OVERHAUL_PLACE {SIDE}}
        {AI_OVERHAUL_PLACE_2 {SIDE}}
        recruit=Demon,Demon Warrior,Demon Manowar,Hellhound,Shadow Hound,Succubus
        [ai]
            aggression=1.0
            [avoid]
                terrain=*^Vzps
            [/avoid]
        [/ai]
    [/side]
#enddef

#define IN_EVENT_TORTURE FILTER
    [harm_unit]
        [filter]
            id={FILTER}
        [/filter]
        amount=4
        damage_type=cold
        fire_event=no
        kill=no
        animate=yes
    [/harm_unit]
#enddef

#define INFERNO_SHOW_MAP
    [story]
        [insert_tag]
            variable=story_map_new
            name=part
        [/insert_tag]
    [/story]
#enddef

#define INFERNO_ITEM X Y VAR
    [if]
        [variable]
            name=quests.{VAR}
            equals=done
        [/variable]
        [else]
            [set_variable]
                name=item_unknown_x
                value={X}
            [/set_variable]
            [set_variable]
                name=item_unknown_y
                value={Y}
            [/set_variable]
            [if]
                [variable]
                    name=quests.{VAR}
                    greater_than=0
                [/variable]
                [else]
                    [random_item]
                        group=inferno_drop
                        variable=item_type
                    [/random_item]
                    {VARIABLE quests.{VAR} $item_type}
                [/else]
                [then]
                    {VARIABLE item_type $quests.{VAR}}
                [/then]
            [/if]
            [set_variables]
                name=items
                mode=append
                [value]
                    x=$item_unknown_x
                    y=$item_unknown_y
                    type=$quests.{VAR}
                [/value]
            [/set_variables]
            {PLACE_ITEM_EVENT {X} {Y}}
            {DRAW_ITEM}
            [event]
                name=item picked
                [filter]
                    x,y={X},{Y}
                [/filter]
                {VARIABLE quests.{VAR} done}
            [/event]
        [/else]
    [/if]
#enddef

#define INFERNO_CHEST X Y VAR
    [if]
        [variable]
            name=quests.{VAR}
            equals=yes
        [/variable]
        [else]
            {PLACE_IMAGE items/chest-plain-closed.png {X} {Y}}
            [event]
                name=moveto
                [filter]
                    side=1
                    x,y={X},{Y}
                [/filter]
                [sound]
                    name=gold.ogg
                [/sound]
                [message]
                    speaker=unit
                    message= _ "I have found some gold."
                [/message]
                {VARIABLE gold_amount "$(2d50)"}
                [gold]
                    side=$side_number
                    amount=$gold_amount
                [/gold]
                {CLEAR_VARIABLE gold_amount}
                [remove_item]
                    x,y={X},{Y}
                    image=items/chest-plain-closed.png
                [/remove_item]
                {PLACE_IMAGE items/chest-plain-open.png {X} {Y}}
                {VARIABLE quests.{VAR} yes}
            [/event]
        [/else]
    [/if]
#enddef

#define SPAWN_ONLY_ONCE ID VARIABLE_NAME
    [event]
        name=prestart
        [if]
            [variable]
                name=quests.{VARIABLE_NAME}
                equals=yes
            [/variable]
            [then]
                [kill]
                    id={ID}
                    animate=no
                    fire_event=no
                [/kill]
            [/then]
        [/if]
    [/event]
    [event]
        name=die
        [filter]
            id={ID}
        [/filter]
        {VARIABLE quests.{VARIABLE_NAME} yes}
    [/event]
#enddef

#define SEAL_GUARDIAN_WELCOME ID RANGE
    [event]
        name=prestart
        [if]
            [variable]
                name=quests.{ID}
                equals=yes
            [/variable]
            [then]
                [kill]
                    id={ID}
                    animate=no
                    fire_event=no
                [/kill]
            [/then]
            [else]
                [if]
                    [variable]
                        name={ID}_store.type
                        equals="Demon Lord"
                    [/variable]
                    [then]
                        [store_unit]
                            [filter]
                                id={ID}
                            [/filter]
                            variable=guardian_store
                            kill=yes
                        [/store_unit]
                        {VARIABLE {ID}_store.side $guardian_store.side}
                        [unstore_unit]
                            variable={ID}_store
                            find_vacant=no
                        [/unstore_unit]
                        {CLEAR_VARIABLE guardian_store}
                    [/then]
                    [else]
                        [store_unit]
                            [filter]
                                id={ID}
                            [/filter]
                            variable={ID}_store
                            kill=no
                        [/store_unit]
                    [/else]
                [/if]
            [/else]
        [/if]
    [/event]
    [event]
        name=moveto
        [filter]
            side=1
            x,y={RANGE}
        [/filter]
        [if]
            [variable]
                name=quests.{ID}_chat_outside
                equals=yes
            [/variable]
            [else]
                [remove_shroud]
                    x,y=${ID}_store.x,${ID}_store.y
                    radius=2
                    side=1
                [/remove_shroud]
                [modify_side]
                    side=1
                    fog=no
                [/modify_side]
                [fire_event]
                    name=guardian chat
                [/fire_event]
                [modify_side]
                    side=1
                    fog=yes
                [/modify_side]
                {VARIABLE quests.{ID}_chat_outside yes}
            [/else]
        [/if]
    [/event]
#enddef

#define SEAL_GUARDIAN ID
    [event]
        name=prestart
        [if]
            [variable]
                name=quests.{ID}
                equals=yes
            [/variable]
            [then]
                [kill]
                    id={ID}
                    animate=no
                    fire_event=no
                [/kill]
            [/then]
            [else]
                [store_unit]
                    [filter]
                        id={ID}
                    [/filter]
                    variable=guardian_store
                    kill=yes
                [/store_unit]
                {VARIABLE {ID}_store.side $guardian_store.side}
                [unstore_unit]
                    variable={ID}_store
                    x=$guardian_store.x
                    y=$guardian_store.y
                [/unstore_unit]
                {CLEAR_VARIABLE guardian_store}
            [/else]
        [/if]
    [/event]
    [event]
        name=die
        [filter]
            id={ID}
        [/filter]
        {VARIABLE quests.{ID} yes}
        [if]
            [variable]
                name=quests.overall
                equals=1
            [/variable]
            [then]
                {VARIABLE quests.overall 3}
                [message]
                    speaker=Lethalia
                    message= _ "Some kind of magical defence system was partially broken. I can feel that it is a quarter of the entire protection. Maybe it opens a path to Uria."
                [/message]
            [/then]
            [else]
                {VARIABLE_OP quests.overall add 1}
                {CLEAR_VARIABLE quests.guardian_kill_talk}
                [if]
                    [variable]
                        name=quests.overall
                        equals=3
                    [/variable]
                    [then]
                        [message]
                            speaker=Lethalia
                            message= _ "What an incredible release of powerful ethereal power. This must have been a seal guardian. Three more seals remain, and our way to Uria is free. Damn, we still have to defeat Uria..."
                        [/message]
                    [/then]
                [/if]
                [if]
                    [variable]
                        name=quests.overall
                        equals=4
                    [/variable]
                    [then]
                        [message]
                            speaker=Efraim
                            message= _ "Another seal is broken! We are halfway to Pandemonium and we are still standing. You must start believing we will get out of here once."
                        [/message]
                        [message]
                            speaker=Lethalia
                            message= _ "Not really. We have no idea where the other seals might be."
                        [/message]
                    [/then]
                [/if]
                [if]
                    [variable]
                        name=quests.overall
                        equals=5
                    [/variable]
                    [then]
                        [message]
                            speaker=Efraim
                            message= _ "Only one seal remains from now. We are so strong that even Inferno cannot handle us."
                        [/message]
                        [message]
                            speaker=Lethalia
                            message= _ "Uria will pound us... And there is also Yarae that is powerful beyond understanding."
                        [/message]
                    [/then]
                [/if]
                [if]
                    [variable]
                        name=quests.overall
                        equals=6
                    [/variable]
                    [then]
                        [message]
                            speaker=Lethalia
                            message= _ "We have broken the final seal! Our way to Pandemonium is open."
                        [/message]
                        [message]
                            speaker=Efraim
                            message= _ "We have made a great progress. Uria is no longer hidden from us. Are you starting to believe in our survival?"
                        [/message]
                        [message]
                            speaker=Lethalia
                            message= _ "There is still Uria, Yarae, and other countless monstrosities to fight."
                        [/message]
                        [message]
                            speaker=Efraim
                            message= _ "Uria is hiding from us. Yarae is hidden from anyone else than Uria. They are not almighty, and they are afraid of the limitations of their power. We can handle it, believe me."
                        [/message]
                        [message]
                            speaker=Lethalia
                            message= _ "Well, maybe we have a chance to get through them."
                        [/message]
                        [message]
                            caption= _ "Somebody"
                            image=units/unknown-unit.png
                            speaker=narrator
                            message= _ "Congratulations. I have never expected you to get this far."
                        [/message]
                        [message]
                            speaker=Lethalia
                            message= _ "Uria again? I am fed up with you."
                        [/message]
                        [message]
                            caption= _ "Somebody"
                            image=units/unknown-unit.png
                            speaker=narrator
                            message= _ "Indeed, I am Uria, the one who knows everything. I even know about your latest big secret, Lethalia. And I think that it is time for you to tell it to your friend, because he will certainly be upset about not knowing something so important for the very existence of the world you come from and you will never return to."
                        [/message]
                        [message]
                            speaker=Efraim
                            message= _ "What secret?"
                        [/message]
                        [message]
                            speaker=Lethalia
                            message= _ "Uria wants to instill strife into our ranks. I have no idea what secret was she talking about, and because of it, I cannot tell you that secret. Without lying. And you probably would notice that I lied. This would create an impression that I am lying to everybody, and I would be unable to defend myself."
                        [/message]
                        [message]
                            speaker=Efraim
                            message= _ "Your reply sounded strange, you did not use your usual ways to formulate sentences. I would say that you are lying and that you really have a secret. An important secret."
                        [/message]
                        [message]
                            speaker=Lethalia
                            message= _ "There are always things I am keeping for myself. If I tell you one, Uria will tell the same thing again and I will have to tell another one, and so on, until I tell all of my secrets - and Uria is listening all the time, it seems."
                        [/message]
                        [message]
                            speaker=Efraim
                            message= _ "I have been quite stupefied by some of your... secrets. That idea of becoming a lich... I suspect it was your aim in life all along, or at least for several decades. Though I do not understand how I fitted into your scheme. You have censored, or better to say <i>stolen</i>, the whole collection that had been kept under wraps in Wesnothian Library. I am not sure which of those secrets of magic stored away you learned to master yourself! The technique of torturing demons was surely based on your secret research. How am I to know whether you are not planning to move Inferno somewhere, making it land in an ocean, creating a new continent, just to return home?"
                        [/message]
                        [message]
                            speaker=Efraim
                            message= _ "Or – perish the thought! – do you plan to move Inferno into your inner wold? Hoping the problem of its existence would turn, in the worst case, into an issue of yet another dark mirage of yours? The more I think about it... Is that constant whining about being unable to defeat Uria supposed to slowly prepare me to accept such a decision?"
                        [/message]
                        [message]
                            speaker=Lethalia_evil
                            message= _ "Another me? That would be great. I would have a friend."
                        [/message]
                        [message]
                            speaker=Lethalia
                            message= _ "Have no fear, it is nothing like that. It is not related to moving the world of Inferno elsewhere, I cannot do that."
                        [/message]
                        [message]
                            speaker=Efraim
                            message= _ "Another elusive answer. Argh, this uncertainty is driving me crazy! It is something serious, right?"
                        [/message]
                        [message]
                            speaker=Lethalia
                            message= _ "There is no evil in it, I swear. But I really think I should keep this for myself."
                        [/message]
                        [message]
                            speaker=Efraim
                            message= _ "If you die, nobody will know it."
                        [/message]
                        [message]
                            speaker=Lethalia
                            message= _ "That case will not be a problem."
                        [/message]
                        {VARIABLE quests.lethalia_lied 1}
                    [/then]
                [/if]
            [/else]
        [/if]
    [/event]
#enddef

#define INFERNAL_OBJECTIVES
    [objectives]
        side=1
        [objective]
            description=_ "Find out some information"
            condition=win
            [show_if]
                [variable]
                    name=quests.overall
                    equals=1
                [/variable]
            [/show_if]
        [/objective]
        [objective]
            description=_ "Locate and break the 4 seals"
            condition=win
            [show_if]
                [variable]
                    name=quests.overall
                    equals=2
                [/variable]
            [/show_if]
        [/objective]
        [objective]
            description=_ "Locate and break the 3 remaining seals"
            condition=win
            [show_if]
                [variable]
                    name=quests.overall
                    equals=3
                [/variable]
            [/show_if]
        [/objective]
        [objective]
            description=_ "Locate and break the 2 remaining seals"
            condition=win
            [show_if]
                [variable]
                    name=quests.overall
                    equals=4
                [/variable]
            [/show_if]
        [/objective]
        [objective]
            description=_ "Locate and break the remaining seal"
            condition=win
            [show_if]
                [variable]
                    name=quests.overall
                    equals=5
                [/variable]
            [/show_if]
        [/objective]
        [objective]
            description=_ "Invade Uria's Den in Pandemonium"
            condition=win
            [show_if]
                [variable]
                    name=quests.overall
                    equals=6
                [/variable]
            [/show_if]
        [/objective]
        [objective]
            description=_ "Reach Uria"
            condition=win
            [show_if]
                [variable]
                    name=quests.overall
                    equals=7
                [/variable]
            [/show_if]
        [/objective]
        [objective]
            description=_ "Kill Uria"
            condition=win
            [show_if]
                [variable]
                    name=quests.overall
                    equals=8
                [/variable]
            [/show_if]
        [/objective]
        [objective]
            description=_ "Find and kill Yarae"
            condition=win
            [show_if]
                [variable]
                    name=quests.overall
                    equals=9
                [/variable]
            [/show_if]
        [/objective]
        [objective]
            description=_ "Find a way to destroy Uria"
            condition=win
            [show_if]
                [variable]
                    name=quests.overall
                    greater_than=1
                [/variable]
                [and]
                    [variable]
                        name=quests.overall
                        less_than=9
                    [/variable]
                [/and]
                [and]
                    [variable]
                        name=quests.lilith
                        less_than=4
                    [/variable]
                [/and]
            [/show_if]
        [/objective]
        [objective]
            description=_ "Kill Lilith"
            condition=win
            [show_if]
                [variable]
                    name=quests.lilith
                    equals=1
                [/variable]
            [/show_if]
        [/objective]
        [objective]
            description=_ "Destroy Lilith in Foul Pits"
            condition=win
            [show_if]
                [variable]
                    name=quests.lilith
                    equals=2
                [/variable]
            [/show_if]
        [/objective]
        [objective]
            description=_ "Kill Abaddon in the Verminous Sewers (optional)"
            condition=win
            [show_if]
                [variable]
                    name=quests.abaddon
                    equals=2
                [/variable]
                [not]
                    [variable]
                        name=quests.overall
                        greater_than=8
                    [/variable]
                [/not]
            [/show_if]
        [/objective]
        [objective]
            description=_ "Reach the Pillar of Continuum's Alteration in Gathering Alcove"
            condition=win
            [show_if]
                [variable]
                    name=quests.pillar
                    equals=1
                [/variable]
            [/show_if]
        [/objective]
        [objective]
            description=_ "Find the Pillar of Continuum's Alteration"
            condition=win
            [show_if]
                [variable]
                    name=quests.pillar
                    equals=2
                [/variable]
            [/show_if]
        [/objective]
        [objective]
            description=_ "Reach the Pillar of Continuum's Alteration in Sepulcher of the Nefarious"
            condition=win
            [show_if]
                [variable]
                    name=quests.pillar
                    equals=3
                [/variable]
            [/show_if]
        [/objective]
        [objective]
            description=_ "Death of Efraim or Lethalia"
            condition=lose
            [show_if]
                [not]
                    [variable]
                        name=crusade_difficulty
                        greater_than_equal_to=10
                    [/variable]
                [/not]
            [/show_if]
        [/objective]
        [objective]
            description=_ "Death of Lilith"
            condition=lose
            [show_if]
                [variable]
                    name=quests.lilith
                    equals=4
                [/variable]
                [not]
                    [variable]
                        name=quests.overall
                        equals=9
                    [/variable]
                [/not]
            [/show_if]
        [/objective]
        note= _ "No income, no upkeep. You can select the units you want to be autorecalled in the right-click menu.$quests.objectives_comment"
    [/objectives]
#enddef

#define STOP_COMING_ON_VICTORY
    [event]
        name=die
        [filter]
            canrecruit=yes
            side=$enemy_sides
        [/filter]
        [if]
            [have_unit]
                side=$enemy_sides
                canrecruit=yes
            [/have_unit]
            [else]
                [event]
                    id=portal_spawn
                    remove=yes
                [/event]
                [remove_item]
                    image="scenery/portal-evil.png"
                [/remove_item]
            [/else]
        [/if]
    [/event]
    [event]
        name=turn 5
        [if]
            [have_unit]
                canrecruit=yes
                [not]
                    side=1
                [/not]
            [/have_unit]
            [else]
                [event]
                    id=portal_spawn
                    remove=yes
                [/event]
                [remove_item]
                    image="scenery/portal-evil.png"
                [/remove_item]
            [/else]
        [/if]
    [/event]
#enddef

#define INFERNO_ORIGIN NUMBER COORDINATES
    [if]
        [variable]
            name=last_scenario
            equals={NUMBER}
        [/variable]
        [then]
            [teleport]
                [filter]
                    id=Efraim
                [/filter]
                x,y={COORDINATES}
                clear_shroud=yes
                animate=no
            [/teleport]
            [teleport]
                [filter]
                    id=Lethalia
                [/filter]
                x,y={COORDINATES}
                clear_shroud=yes
                animate=no
            [/teleport]
            [place_shroud]
                side=1
                x,y=1-999,1-999
            [/place_shroud]
        [/then]
    [/if]
#enddef

#define INFERNO_TRANSITION LOCATION DESC_LOCATION ACTIVATION
    [label]
        x,y={DESC_LOCATION}
        text=$map_locations.area[{LOCATION}].name
        color=255,255,255
    [/label]
    [event]
        name=moveto
        first_time_only=no
        [filter]
            side=1
            x,y={ACTIVATION}
        [/filter]
        [message]
            speaker=narrator
            message= _ "Do you want to go to location: " + $map_locations.area[{LOCATION}].name + "?"
            [option]
                label= _ "Yes"
                [command]
                    {VARIABLE to_location {LOCATION}}
                    [fire_event]
                        name=go to location
                    [/fire_event]
                    {CLEAR_VARIABLE to_location}
                    [endlevel]
                        result=victory
                        bonus=no
                        next_scenario=$map_locations.area[{LOCATION}].id
                        linger_mode=no
                        carryover_report=no
                        {NEW_GOLD_CARRYOVER 100}
                    [/endlevel]
                [/command]
            [/option]
            [option]
                label= _ "No"
                [command]
                [/command]
            [/option]
        [/message]
    [/event]
#enddef

#define CAMPAIGN9_EVENTS
    [event]
        name=prestart
        [unit]
            type=Chapter9 Event Loader
            side=1
            x,y=1,1
        [/unit]
        [kill]
            type=Chapter9 Event Loader
            animate=no
        [/kill]
    [/event]
#enddef

#define CAMPAIGN9_EVENTS_LIST

    [event]
        name=portal_spawn
        id=portal_spawn
        first_time_only=no
        {FOREACH infernal_portals i}
            {VARIABLE do_spawn $turn_number}
            {VARIABLE_OP do_spawn modulo $infernal_portals[$i].period}
            [if]
                [variable]
                    name=do_spawn
                    equals=1
                [/variable]
                [then]
                    [if]
                        [variable]
                            name=demons_killed
                            less_than=50
                        [/variable]
                        [then]
                            {VARIABLE_OP spawn_type rand (Demon,Demon Warrior,Demon Manowar,Succubus,Hellhound,Shadow Hound)}
                            {VARIABLE did_spawn 1}
                        [/then]
                    [/if]
                    [if]
                        [variable]
                            name=demons_killed
                            greater_than_equal_to=50
                        [/variable]
                        [and]
                            [variable]
                                name=demons_killed
                                less_than=100
                            [/variable]
                        [/and]
                        [then]
                            {VARIABLE_OP spawn_type rand (Demon,Demon,Demon Warrior,Demon Manowar,Succubus,Hellhound,Shadow Hound)}
                            {VARIABLE_OP did_spawn rand (1,1,1,1,1,1,1,1,1,1,1,0)}
                        [/then]
                    [/if]
                    [if]
                        [variable]
                            name=demons_killed
                            greater_than_equal_to=100
                        [/variable]
                        [and]
                            [variable]
                                name=demons_killed
                                less_than=200
                            [/variable]
                        [/and]
                        [then]
                            {VARIABLE_OP spawn_type rand (Demon,Demon,Demon Warrior,Demon Warrior,Demon Manowar,Succubus,Hellhound,Shadow Hound)}
                            {VARIABLE_OP did_spawn rand (1,1,1,1,1,1,1,1,1,0)}
                        [/then]
                    [/if]
                    [if]
                        [variable]
                            name=demons_killed
                            greater_than_equal_to=200
                        [/variable]
                        [and]
                            [variable]
                                name=demons_killed
                                less_than=300
                            [/variable]
                        [/and]
                        [then]
                            {VARIABLE_OP spawn_type rand (Demon,Demon,Demon,Demon Warrior,Demon Warrior,Demon Manowar,Succubus,Hellhound,Shadow Hound)}
                            {VARIABLE_OP did_spawn rand (1,1,1,1,1,1,1,1,0)}
                        [/then]
                    [/if]
                    [if]
                        [variable]
                            name=demons_killed
                            greater_than_equal_to=400
                        [/variable]
                        [and]
                            [variable]
                                name=demons_killed
                                less_than=400
                            [/variable]
                        [/and]
                        [then]
                            {VARIABLE_OP spawn_type rand (Demon,Demon,Demon,Demon,Demon Warrior,Demon Warrior,Demon Warrior,Demon Manowar,Succubus,Hellhound,Hellhound,Shadow Hound)}
                            {VARIABLE_OP did_spawn rand (1,1,1,1,1,1,1,0)}
                        [/then]
                    [/if]
                    [if]
                        [variable]
                            name=demons_killed
                            greater_than_equal_to=400
                        [/variable]
                        [and]
                            [variable]
                                name=demons_killed
                                less_than=500
                            [/variable]
                        [/and]
                        [then]
                            {VARIABLE_OP spawn_type rand (Demon,Demon,Demon,Demon,Demon Warrior,Demon Warrior,Demon Warrior,Demon Manowar,Demon Manowar,Hellhound,Hellhound,Shadow Hound)}
                            {VARIABLE_OP did_spawn rand (1,1,1,1,1,1,1,0)}
                        [/then]
                    [/if]
                    [if]
                        [variable]
                            name=demons_killed
                            greater_than_equal_to=500
                        [/variable]
                        [and]
                            [variable]
                                name=demons_killed
                                less_than=600
                            [/variable]
                        [/and]
                        [then]
                            {VARIABLE_OP spawn_type rand (Demon,Demon,Demon,Demon,Demon,Demon Warrior,Demon Warrior,Demon Warrior,Demon Warrior,Demon Manowar,Demon Manowar,Hellhound,Hellhound,Shadow Hound)}
                            {VARIABLE_OP did_spawn rand (1,1,1,1,1,1,0)}
                        [/then]
                    [/if]
                    [if]
                        [variable]
                            name=demons_killed
                            greater_than_equal_to=600
                        [/variable]
                        [and]
                            [variable]
                                name=demons_killed
                                less_than=700
                            [/variable]
                        [/and]
                        [then]
                            {VARIABLE_OP spawn_type rand (Demon,Demon,Demon,Demon,Demon,Demon Warrior,Demon Warrior,Demon Warrior,Demon Warrior,Demon Manowar,Hellhound,Hellhound)}
                            {VARIABLE_OP did_spawn rand (1,1,1,1,1,0)}
                        [/then]
                    [/if]
                    [if]
                        [variable]
                            name=demons_killed
                            greater_than_equal_to=700
                        [/variable]
                        [and]
                            [variable]
                                name=demons_killed
                                less_than=800
                            [/variable]
                        [/and]
                        [then]
                            {VARIABLE_OP spawn_type rand (Demon,Demon,Demon,Demon,Demon,Demon,Demon Warrior,Demon Warrior,Demon Warrior,Demon Warrior,Demon Manowar,Hellhound,Hellhound)}
                            {VARIABLE_OP did_spawn rand (1,1,1,1,0)}
                        [/then]
                    [/if]
                    [if]
                        [variable]
                            name=demons_killed
                            greater_than_equal_to=800
                        [/variable]
                        [and]
                            [variable]
                                name=demons_killed
                                less_than=900
                            [/variable]
                        [/and]
                        [then]
                            {VARIABLE_OP spawn_type rand (Imp,Demon,Demon,Demon,Demon,Demon,Demon,Demon Warrior,Demon Warrior,Demon Warrior,Demon Warrior,Demon Manowar,Hellhound,Hellhound)}
                            {VARIABLE_OP did_spawn rand (1,1,1,0)}
                        [/then]
                    [/if]
                    [if]
                        [variable]
                            name=demons_killed
                            greater_than_equal_to=900
                        [/variable]
                        [and]
                            [variable]
                                name=demons_killed
                                less_than=1000
                            [/variable]
                        [/and]
                        [then]
                            {VARIABLE_OP spawn_type rand (Imp,Imp,Demon,Demon,Demon,Demon,Demon,Demon,Demon Warrior,Demon Warrior,Demon Warrior,Demon Warrior,Hellhound,Hellhound)}
                            {VARIABLE_OP did_spawn rand (1,1,0)}
                        [/then]
                    [/if]
                    [if]
                        [variable]
                            name=demons_killed
                            greater_than_equal_to=1000
                        [/variable]
                        [and]
                            [variable]
                                name=demons_killed
                                less_than=1100
                            [/variable]
                        [/and]
                        [then]
                            {VARIABLE_OP spawn_type rand (Imp,Imp,Imp,Demon,Demon,Demon,Demon,Demon,Demon,Demon Warrior,Demon Warrior,Demon Warrior,Hellhound,Hellhound)}
                            {VARIABLE_OP did_spawn rand (1,1,1,0,0)}
                        [/then]
                    [/if]
                    [if]
                        [variable]
                            name=demons_killed
                            greater_than_equal_to=1100
                        [/variable]
                        [and]
                            [variable]
                                name=demons_killed
                                less_than=1200
                            [/variable]
                        [/and]
                        [then]
                            {VARIABLE_OP spawn_type rand (Imp,Imp,Imp,Imp,Demon,Demon,Demon,Demon,Demon,Demon,Demon Warrior,Demon Warrior,Demon Warrior,Hellhound,Hellhound)}
                            {VARIABLE_OP did_spawn rand (1,1,0,0,0)}
                        [/then]
                    [/if]
                    [if]
                        [variable]
                            name=demons_killed
                            greater_than_equal_to=1100
                        [/variable]
                        [and]
                            [variable]
                                name=demons_killed
                                less_than=1200
                            [/variable]
                        [/and]
                        [then]
                            {VARIABLE_OP spawn_type rand (Imp,Imp,Imp,Imp,Demon,Demon,Demon,Demon,Demon,Demon,Demon Warrior,Demon Warrior,Hellhound)}
                            {VARIABLE_OP did_spawn rand (1,0,0)}
                        [/then]
                    [/if]
                    [if]
                        [variable]
                            name=demons_killed
                            greater_than_equal_to=1200
                        [/variable]
                        [and]
                            [variable]
                                name=demons_killed
                                less_than=1300
                            [/variable]
                        [/and]
                        [then]
                            {VARIABLE_OP spawn_type rand (Imp,Imp,Imp,Imp,Imp,Demon,Demon,Demon,Demon,Demon,Demon Warrior,Hellhound)}
                            {VARIABLE_OP did_spawn rand (1,0,0,0)}
                        [/then]
                    [/if]
                    [if]
                        [variable]
                            name=demons_killed
                            greater_than_equal_to=1300
                        [/variable]
                        [and]
                            [variable]
                                name=demons_killed
                                less_than=1400
                            [/variable]
                        [/and]
                        [then]
                            {VARIABLE_OP spawn_type rand (Imp,Imp,Imp,Imp,Imp,Imp,Demon,Demon,Demon,Demon,Hellhound)}
                            {VARIABLE_OP did_spawn rand (1,0,0,0,0)}
                        [/then]
                    [/if]
                    [if]
                        [variable]
                            name=demons_killed
                            greater_than_equal_to=1400
                        [/variable]
                        [and]
                            [variable]
                                name=demons_killed
                                less_than=1500
                            [/variable]
                        [/and]
                        [then]
                            {VARIABLE_OP spawn_type rand (Imp,Imp,Imp,Imp,Imp,Imp,Imp,Demon,Demon,Demon,Hellhound)}
                            {VARIABLE_OP did_spawn rand (1,0,0,0,0,0)}
                        [/then]
                    [/if]
                    [if]
                        [variable]
                            name=demons_killed
                            greater_than_equal_to=1500
                        [/variable]
                        [and]
                            [variable]
                                name=demons_killed
                                less_than=1700
                            [/variable]
                        [/and]
                        [then]
                            {VARIABLE_OP spawn_type rand (Imp,Imp,Demon)}
                            {VARIABLE_OP did_spawn rand (1,0,0,0,0,0,0)}
                        [/then]
                    [/if]
                    [if]
                        [variable]
                            name=demons_killed
                            greater_than_equal_to=1700
                        [/variable]
                        [and]
                            [variable]
                                name=demons_killed
                                less_than=1850
                            [/variable]
                        [/and]
                        [then]
                            {VARIABLE_OP spawn_type rand (Imp,Imp,Imp,Demon)}
                            {VARIABLE_OP did_spawn rand (1,0,0,0,0,0,0,0)}
                        [/then]
                    [/if]
                    [if]
                        [variable]
                            name=demons_killed
                            greater_than_equal_to=1850
                        [/variable]
                        [and]
                            [variable]
                                name=demons_killed
                                less_than=2000
                            [/variable]
                        [/and]
                        [then]
                            {VARIABLE spawn_type Imp}
                            {VARIABLE_OP did_spawn rand (1,0,0,0,0,0,0,0,0)}
                        [/then]
                    [/if]
                    [if]
                        [variable]
                            name=demons_killed
                            greater_than_equal_to=2000
                        [/variable]
                        [then]
                            {VARIABLE spawn_type Imp}
                            {VARIABLE did_spawn 0}
                        [/then]
                    [/if]
                    [if]
                        [variable]
                            name=did_spawn
                            equals=1
                        [/variable]
                        [then]
#ifdef HARD
                            {GENERIC_UNIT $infernal_portals[$i].side $spawn_type $infernal_portals[$i].x $infernal_portals[$i].y}
#endif
#ifdef NORMAL
                            {VARIABLE_OP did_really_spawn rand (1,1,1,1,0)}
                            [if]
                                [variable]
                                    name=did_really_spawn
                                    equals=1
                                [/variable]
                                [then]
                                    {GENERIC_UNIT $infernal_portals[$i].side $spawn_type $infernal_portals[$i].x $infernal_portals[$i].y}
                                [/then]
                            [/if]
#endif
#ifdef EASY
                            {VARIABLE_OP did_really_spawn rand (1,1,0)}
                            [if]
                                [variable]
                                    name=did_really_spawn
                                    equals=1
                                [/variable]
                                [then]
                                    {GENERIC_UNIT $infernal_portals[$i].side $spawn_type $infernal_portals[$i].x $infernal_portals[$i].y}
                                [/then]
                            [/if]
#endif
                        [/then]
                    [/if]
                [/then]
            [/if]
        {NEXT i}
        {CLEAR_VARIABLE do_spawn}
        {CLEAR_VARIABLE did_spawn}
        {CLEAR_VARIABLE did_really_spawn}
        {CLEAR_VARIABLE spawn_type}
    [/event]
    [event]
        name=victory
        {CLEAR_VARIABLE infernal_portals}
    [/event]

    [event]
        name=die
        first_time_only=no
        [filter]
            race=demon-loti
        [/filter]
        {VARIABLE_OP demons_killed add 1}
    [/event]
    [event]
        name=side turn
        first_time_only=no
        [if]
            [variable]
                name=side_number
                equals=1
            [/variable]
            [then]
                [fire_event]
                    name=portal_spawn
                [/fire_event]
                [fire_event]
                    name=steelhive_spawn
                [/fire_event]
            [/then]
        [/if]
    [/event]
    [event]
        name=start
        first_time_only=no
        [if]
            [variable]
                name=quests.destroyed_steelhive
                equals=yes
            [/variable]
            [then]
                [event]
                    id=steelhive_spawn
                    remove=yes
                [/event]
            [/then]
        [/if]
    [/event]
    [event]
        name=start
        {SETUP_LOCATIONS}
        [set_menu_item]
            id=5map
            description=_ "Show Map"
            [command]
                [message]
                    speaker=narrator
                    image="$story_map_old.background"
                    message=""
                [/message]
            [/command]
        [/set_menu_item]
        [set_menu_item]
            id=5confautorecall
            description=_ "Configure Autorecall"
            [command]
                [if]
                    [variable]
                        name=max_autorecall
                        greater_than_equal_to=8
                    [/variable]
                    [else]
                        {VARIABLE max_autorecall 8}
                    [/else]
                [/if]
                {VARIABLE next_autorecall_price "$($($max_autorecall-7)*100)"}
#ifdef EASY
                {VARIABLE_OP next_autorecall_price divide 1.5}
#endif
#ifdef NORMAL
                {VARIABLE_OP next_autorecall_price divide 1.2}
#endif
                {VARIABLE_OP next_autorecall_price round floor}
                [store_gold]
                    side=1
                    variable=gold
                [/store_gold]
                #Initialise the variable listing them
                {VARIABLE autorecall_listing[0].entry "Here is a list of all units you have set to be autorecalled. You can add any number of units, but only the first $max_autorecall units are autorecalled."}
                #Clear the units that are already dead from the list, add those who are still alive in the list in the message
                {FOREACH autorecall i}
                    [store_unit]
                        [filter]
                            id=$autorecall[$i].id
                        [/filter]
                        variable=to_autorecall
                        kill=no
                    [/store_unit]
                    [if]
                        [variable]
                            name=to_autorecall.length
                            equals=0
                        [/variable]
                        [then]
                            {CLEAR_VARIABLE autorecall[$i]}
                        [/then]
                        [else]
                            {VARIABLE autorecall_listing[$autorecall_listing.length].entry "$to_autorecall.name| ($to_autorecall.language_name|)"}
                            {VARIABLE "autorecall_listing[$($autorecall_listing.length-1)].id" $to_autorecall.id}
                        [/else]
                    [/if]
                    #Remove duplicates
                    {VARIABLE authentic yes}
                    {FOREACH unique j}
                        [if]
                            [variable]
                                name=unique[$j].id
                                equals=$autorecall[$i].id
                            [/variable]
                            [then]
                                {VARIABLE authentic no}
                            [/then]
                        [/if]
                    {NEXT j}
                    [if]
                        [variable]
                            name=authentic
                            equals=yes
                        [/variable]
                        [then]
                            {VARIABLE unique[$unique.length].id $autorecall[$i].id}
                        [/then]
                        [else]
                            {CLEAR_VARIABLE autorecall[$i]}
                            {VARIABLE_OP i sub 1}
                        [/else]
                    [/if]
                    {CLEAR_VARIABLE to_autorecall}
                {NEXT i}
                {CLEAR_VARIABLE unique}
                #Now, we have the list free of dead units, it's time show a message
                [set_variable]
                    name=intro_message
                    [join]
                        variable=autorecall_listing
                        key=entry
                        separator="
"
                        remove_empty=yes
                    [/join]
                [/set_variable]
                [message]
                    speaker=narrator
                    image="wesnoth-icon.png"
                    message=$intro_message
                    [option]
                        label=_ "Add units"
                        [command]
                            #Repeat until done
                            {VARIABLE done no}
                            [while]
                                [variable]
                                    name=done
                                    equals=no
                                [/variable]
                                [do]
                                    [set_variables]
                                        name=add_message
                                        mode=replace
                                        [value]
                                            speaker=narrator
                                            image="wesnoth-icon.png"
                                            message= _ "Which unit would you like to add?"
                                            [option]
                                                label=_ "Back"
                                                [command]
                                                    {VARIABLE done yes}
                                                [/command]
                                            [/option]
                                        [/value]
                                    [/set_variables]
                                    #Store all units
                                    [store_unit]
                                        [filter]
                                            side=1
                                            [not]
                                                id=Efraim
                                            [/not]
                                            [not]
                                                id=Lethalia
                                            [/not]
                                            [not]
                                                id=Lethalia_evil
                                            [/not]
                                            [not]
                                                id=Lilith
                                            [/not]
                                        [/filter]
                                        variable=unit_list
                                        kill=no
                                    [/store_unit]
                                    #Add them to the list
                                    {FOREACH unit_list i}
                                        [set_variables]
                                            name=add_message.option[$add_message.option.length]
                                            mode=replace
                                            [value]
                                                message=_ "$unit_list[$i].name| ($unit_list[$i].language_name|)"
                                                [command]
                                                    {VARIABLE autorecall[$autorecall.length].id $unit_list[$i].id}
                                                [/command]
                                            [/value]
                                        [/set_variables]
                                    {NEXT i}
                                    {CLEAR_VARIABLE unit_list}
                                    [insert_tag]
                                        name=message
                                        variable=add_message
                                    [/insert_tag]
                                [/do]
                            [/while]
                            {CLEAR_VARIABLE add_message,done}
                            #Remove duplicates
                            {FOREACH autorecall i}
                                [store_unit]
                                    [filter]
                                        id=$autorecall[$i].id
                                    [/filter]
                                    variable=to_autorecall
                                    kill=no
                                [/store_unit]
                                {VARIABLE authentic yes}
                                {FOREACH unique j}
                                    [if]
                                        [variable]
                                            name=unique[$j].id
                                            equals=$autorecall[$i].id
                                        [/variable]
                                        [then]
                                            {VARIABLE authentic no}
                                        [/then]
                                    [/if]
                                {NEXT j}
                                [if]
                                    [variable]
                                        name=authentic
                                        equals=yes
                                    [/variable]
                                    [then]
                                        {VARIABLE unique[$unique.length].id $autorecall[$i].id}
                                    [/then]
                                    [else]
                                        {CLEAR_VARIABLE autorecall[$i]}
                                        {VARIABLE_OP i sub 1}
                                    [/else]
                                [/if]
                                {CLEAR_VARIABLE to_autorecall}
                            {NEXT i}
                            {CLEAR_VARIABLE unique}
                        [/command]
                    [/option]
                    [option]
                        label=_ "Remove units"
                        [command]
                            #Repeat until done
                            {VARIABLE done no}
                            [while]
                                [variable]
                                    name=done
                                    equals=no
                                [/variable]
                                [do]
                                    [set_variables]
                                        name=remove_message
                                        mode=replace
                                        [value]
                                            speaker=narrator
                                            image="wesnoth-icon.png"
                                            message= _ "Which unit would you like to remove?"
                                            [option]
                                                label=_ "Back"
                                                [command]
                                                    {VARIABLE done yes}
                                                [/command]
                                            [/option]
                                        [/value]
                                    [/set_variables]
                                    {FOREACH autorecall i}
                                        [store_unit]
                                            [filter]
                                                id=$autorecall[$i].id
                                            [/filter]
                                            variable=to_autorecall
                                            kill=no
                                        [/store_unit]
                                        [set_variables]
                                            name=remove_message.option[$remove_message.option.length]
                                            mode=replace
                                            [value]
                                                message=_ "$to_autorecall.name| ($to_autorecall.language_name|)"
                                                [command]
                                                    {CLEAR_VARIABLE autorecall[$i]}
                                                [/command]
                                            [/value]
                                        [/set_variables]
                                        {CLEAR_VARIABLE to_autorecall}
                                    {NEXT i}
                                    [insert_tag]
                                        name=message
                                        variable=remove_message
                                    [/insert_tag]
                                [/do]
                            [/while]
                            {CLEAR_VARIABLE remove_message,done}
                        [/command]
                        [show_if]
                            [variable]
                                name=autorecall.length
                                greater_than=0
                            [/variable]
                        [/show_if]
                    [/option]
                    [option]
                        label=_ "Buy space to recall more units automatically ($next_autorecall_price)"
                        [show_if]
                            [variable]
                                name=gold
                                greater_than_equal_to=$next_autorecall_price
                            [/variable]
                        [/show_if]
                        [command]
                            [gold]
                                side=1
                                amount="$(-1*$next_autorecall_price)"
                            [/gold]
                            {VARIABLE_OP max_autorecall add 1}
                        [/command]
                    [/option]
                    [option]
                        label=_ "Back"
                        [command]
                        [/command]
                    [/option]
                [/message]
                {CLEAR_VARIABLE to_autorecall,intro_message,autorecall_listing,authentic,unique,next_autorecall_price,gold}
            [/command]
        [/set_menu_item]
        [if]
            [variable]
                name=quests.seen_a_burning_soul
                equals=yes
            [/variable]
            [else]
                [event]
                    name=attack
                    [filter_second]
                        race=burning soul-loti
                    [/filter_second]
                    [message]
                        speaker=unit
                        message=_"What perverted miscreation is this?"
                    [/message]
                    [message]
                        speaker=Lethalia
                        message=_"A burning soul. Humans, elves, dwarves... condemned to burn and regenerate for ever. A terrible magic, they are fully aware of the torment. Demons got them to Inferno during Götterdämmerung, or long before it. They have them fight, toil with heavy work, torture themselves even more... while all they yearn for is to get out of here. Through death."
                    [/message]
                    [message]
                        speaker=Efraim
                        message=_"I have speculated that we might also release them from their curse. We cannot help them by ourselves, but with some cooperation from their side, usually requiring mustering enough mental force to weaken their bonds. It should be a really strong emotion, and that might require them to kill or harm people who want to help them, as they cannot lose anything themselves and they feel no happiness, so I think that we are not very likely to free a significant part of them."
                    [/message]
                    [message]
                        speaker=Lethalia
                        message=_"Yes, our soldiers are more valuable, considering that the burning souls are probably all insane and want to die anyway, as they have no surviving relatives probably. But occasionally, we might try..."
                    [/message]
                    {VARIABLE quests.seen_a_burning_soul yes}
                [/event]
            [/else]
        [/if]
        [if]
            [variable]
                name=quests.lilith
                greater_than=2
            [/variable]
            [then]
                [event]
                    name=last breath
                    [filter]
                        id=Lilith
                    [/filter]
                    [message]
                        speaker=Lethalia
                        message=_"I am really happy to see this wretch dead, but I must agree that we need her. If not to defeat Uria, using our redeeming ability on her could boost our power quite a lot."
                    [/message]
                    [endlevel]
                        result=defeat
                    [/endlevel]
                [/event]
            [/then]
        [/if]
        [if]
            [variable]
                name=quests.lilith
                greater_than=2
            [/variable]
            [else]
                [if]
                    [variable]
                        name=quests.met_lilith
                        greater_than=0
                    [/variable]
                    [else]
                        [event]
                            name=lilith chat
                            [message]
                                speaker=Lilith
                                message= _ "Time to see who are these intruders... and if a profitable deal... Wait, I know you, preserved liches! You are those despicable heroes that ruined my plan back then!"
                            [/message]
                            [message]
                                speaker=Lethalia
                                message=_"Lilith? Is that you?"
                            [/message]
                            [message]
                                speaker=Lilith
                                message= _ "Yes. You have also ruined Zhangor's plan, is that right?"
                            [/message]
                            [message]
                                speaker=Efraim
                                message=_"What are you talking about? Well, that hardly matters. What matters is that..."
                            [/message]
                            [message]
                                speaker=Lethalia
                                message=_"... is that we have found you finally. You will suffer for the terrible crimes you have done against elvish people! We will kill you to make sure that you will never corrupt any society again!"
                            [/message]
                            [message]
                                caption= _ "Somebody"
                                image=units/unknown-unit.png
                                speaker=narrator
                                message= _ "Morons! It was Zhangor, not Lilith."
                            [/message]
                            [message]
                                speaker=Efraim
                                message=_"Who are you to display your ignorance so openly? There was no Zhangor, I do not even know what are you talking about."
                            [/message]
                            [message]
                                caption= _ "Somebody"
                                image=units/unknown-unit.png
                                speaker=narrator
                                message= _ "I am Uria, and you shall speak of me with reverence!"
                            [/message]
                            [message]
                                speaker=Efraim
                                message=_"This is something you do not know, empty head. You are so stupid. You seem to be completely unaware of events that happened before your birth, am I right?"
                            [/message]
                            [message]
                                caption= _ "Somebody"
                                image=units/unknown-unit.png
                                speaker=narrator
                                message= _ "But it was Zhangor, Lilith..."
                            [/message]
                            [message]
                                speaker=Lethalia
                                message=_"I have heard that a demon named Zhangor corrupted elves in Wesmere forest. I have foretold it eons before. Back then, Lilith controlled a group of elves and led them into an attempt to conquer the world, exterminate all other races, all elves that did not agree with them, and would possibly lead them also to blood sacrifices. I did not want it to happen again, so I tried to create a prophecy binding it to be preceded by something I considered impossible - but that prophecy actually foretold both events."
                            [/message]
                            [message]
                                speaker=Efraim
                                message=_"Psst, Lethalia, Uria is eavesdropping on us, let us make her lose interest in doing so. We cannot worsen the situation by driving her mad, she hates us absolutely. So folks, do not put bridles on your tongues, let her have it! Do the way I do."
                            [/message]
                            [message]
                                speaker=Lethalia
                                message=_"What do you mean?"
                            [/message]
                            [message]
                                speaker=Efraim
                                message=_"Uria, your ignorance is always surprising me. Do you know the name of the world you are invading? Did you write it down or do you read it from a map? Ah, well, I do you wrong. Surely, you can neither read nor write."
                            [/message]
                            [message]
                                speaker=Lethalia_evil
                                message=_"You are so stupid, Uria. I wonder how a creature with brass instead of a brain can rule this place. Maybe she inherited the throne. Haha. Hey, I know what is in the head of Uria. Do you know what? No? There is a brain devouring worm. And let me tell what it is doing: It is starving!"
                            [/message]
                            [message]
                                speaker=Lethalia
                                message=_"Ah, mockery! Uria once found a hammer, she put its head into her hands and then she tried to hurt enemies by clubbing them with the handle. Have you heard of it, Efraim?"
                            [/message]
                            [message]
                                speaker=Lilith
                                message=_"Am I a puny imp? You should not be ignoring me. You are just lucky that I feel like talking."
                            [/message]
                            [message]
                                speaker=Efraim
                                message=_"How did it feel when you lost?"
                            [/message]
                            [message]
                                speaker=Lilith
                                message=_"It was not very pleasant. A years-long planning wasted. I could have ascended into godhood, but all that remained to me was a bit of divine power. There is no need to go into details, because you are going to experience a defeat like that... very soon."
                            [/message]
                            [message]
                                speaker=Efraim
                                message=_"What did you mean back then, when you said that your real form would not suit into the temple in Arach? You look strong, powerful and beautiful in a weird way, but you are not very tall. Did you shrink?"
                            [/message]
                            [message]
                                speaker=Lilith
                                message=_"In their religion, they decided that I was really big, so I could not tell the truth. That does not matter. Huge size is merely an annoyance, that is what prevented Abaddon from defeating you. Small size means dexterity and ability to enter small places. And I have the same strength as huge demons, anyway."
                            [/message]
                            [message]
                                speaker=Lethalia
                                message=_"Enough talking. We will kill you."
                            [/message]
                            [message]
                                speaker=Lilith
                                message=_"You cannot kill me, I am immortal!"
                            [/message]
                            [message]
                                speaker=Efraim
                                message=_"Have you noticed how nicely we made Uria stop eavesdropping on us, by the way?"
                            [/message]
                            [event]
                                name=victory
                                [message]
                                    speaker=Efraim
                                    message=_"It appears that Uria is quite susceptible to mockery, so it might be quite an effective way to stop her from eavesdropping on us when it is not suitable. We might use it more frequently."
                                [/message]
                                [message]
                                    speaker=Lethalia
                                    message=_"We are in a situation that is too serious for humour, I think. This way, we will only make the boss of Inferno more angry and more dangerous. She or maybe he if it is not Uria may send all forces against us if we provoke her or him to do so."
                                [/message]
                                [message]
                                    speaker=Efraim
                                    message=_"I believe Uria is the boss here, but she might be just another servant of a greater force, who knows... Anyway, do you think that Uria is not trying to destroy us at all costs already? She sent Lilith against us, and Lilith is not a mere pawn in this war."
                                [/message]
                                [message]
                                    speaker=Lethalia
                                    message=_"That makes sense, if I was a demon queen, I would do all I could to drive the intruders away. Especially intruders with unmapped powers. But there was no huge army marching against us yet."
                                [/message]
                                [message]
                                    speaker=Efraim
                                    message=_"If it can be assembled, it has already happened and they are marching against us at this moment. Unless... They could instead be skirmishing with some... rebels."
                                [/message]
                                [message]
                                    speaker=Lethalia
                                    message=_"I understand, I agree that they hate us absolutely as much as they can and there is nothing to fail by enraging them against us even more. All we can achieve is to enrage them to make aggressive decisions instead of careful planning, that would rather help us. They know the terrain and have forces everywhere, we cannot expect to outwit them, using some grandiose plans of theirs against themselves."
                                [/message]
                                [message]
                                    speaker=Efraim
                                    message=_"In that case, we will mock them, make fun of them and laugh at their reactions. We know of almost no options how to flee from here at the moment, so occasional laugh should save us from desperation. It will be a good relief in this world of sadness."
                                [/message]
                            [/event]
                        [/event]
                    [/else]
                [/if]
                [if]
                    [variable]
                        name=quests.met_lilith
                        equals=1
                    [/variable]
                    [then]
                        [event]
                            name=lilith chat
                            [message]
                                speaker=Lilith
                                message= _ "Obnoxious preserved liches. Why did nobody kill you yet? Why do I have to debase myself..."
                            [/message]
                            [message]
                                speaker=Lethalia
                                message=_"We are preserved liches no more, butthead. You cannot even realise that?"
                            [/message]
                            [message]
                                speaker=Lethalia_evil
                                message=_"Maybe she was talking about me."
                            [/message]
                            [message]
                                speaker=Lilith
                                message= _ "So you are just some other pathetic beings that inhabit Irdya. I care not about that."
                            [/message]
                            [message]
                                speaker=Efraim
                                message=_"Maybe you could care. We are now something more powerful. And sooner or later we will learn how to defeat you for good."
                            [/message]
                            [message]
                                speaker=Lilith
                                message= _ "And maybe I was given a huge ration of raw power from Uria, and its devastating potential in my hands is far deadly than the lesser divine power I had then."
                            [/message]
                            [message]
                                speaker=Lethalia
                                message=_"We possess divine powers. You cannot match us."
                            [/message]
                            [message]
                                speaker=Lilith
                                message=_"Let us see. You defeated me before, but I am growing stronger and stronger. Faster than you."
                            [/message]
                            [message]
                                speaker=Efraim
                                message=_"But too slow to become strong enough before we figure out how to finish you."
                            [/message]
                        [/event]
                    [/then]
                [/if]
                [if]
                    [variable]
                        name=quests.met_lilith
                        equals=2
                    [/variable]
                    [then]
                        [event]
                            name=lilith chat
                            [message]
                                speaker=Lilith
                                message= _ "How about making a deal? I will get you out of Inferno, you will teach me how do you devour souls."
                            [/message]
                            [message]
                                speaker=Lethalia
                                message=_"I will never teach you that! You are powerful enough even without that."
                            [/message]
                            [message]
                                speaker=Lethalia_evil
                                message=_"How envious Lilith is."
                            [/message]
                            [message]
                                speaker=Lilith
                                message= _ "Well, changing the offer, I will get you out of Inferno for nothing in reward."
                            [/message]
                            [message]
                                speaker=Efraim
                                message=_"Do you know a way to do that?"
                            [/message]
                            [message]
                                speaker=Lilith
                                message= _ "Not now, but I might figure something out."
                            [/message]
                            [message]
                                speaker=Lethalia
                                message=_"How can we be sure that you would not destroy us or do something even worse when we let you cast a spell on us?"
                            [/message]
                            [message]
                                speaker=Lilith
                                message=_"You can only believe me. I want you out of Inferno, I need to stop the havoc you are spreading, I care not if you die or not."
                            [/message]
                            [message]
                                speaker=Efraim
                                message=_"I prefer to believe obvious lies than your words, Lilith. No deal, nobody can trust you."
                            [/message]
                        [/event]
                    [/then]
                [/if]
                [if]
                    [variable]
                        name=quests.met_lilith
                        equals=3
                    [/variable]
                    [then]
                        [event]
                            name=lilith chat
                            [message]
                                speaker=Lilith
                                message= _ "Prepare to die..."
                            [/message]
                            [message]
                                speaker=Lethalia
                                message=_"Why are you even chasing us? For a pathetic revenge?"
                            [/message]
                            [message]
                                speaker=Lethalia_evil
                                message=_"Lilith the crybaby needs to kill me because I ruined her plan, boo, boo!"
                            [/message]
                            [message]
                                speaker=Lilith
                                message= _ "Not for a revenge. Revenge is for the weak, and it usually is not profitable. No, it is not revenge."
                            [/message]
                            [message]
                                speaker=Lethalia
                                message=_"So is it because your god Uria wants you to? What a humble servant are you."
                            [/message]
                            [message]
                                speaker=Lilith
                                message= _ "Uria? She is not my god. Puny demons worship her, but I do not bow down to anybody."
                            [/message]
                            [message]
                                speaker=Efraim
                                message=_"So you envy us the collection of powerful items we have assembled... You want them, because your items are not powerful enough, as it seems, after all these failures to defeat us..."
                            [/message]
                            [message]
                                speaker=Lilith
                                message= _ "No. You understand nothing. I have a deal with Uria, she gives me power to use freely, I use it to help her when necessary. I am not her servant, we are allies."
                            [/message]
                            [message]
                                speaker=Lethalia_evil
                                message=_"And you are not the dominant one in your alliance, obviously. You are weak. When I was strong enough, I commanded all my allies. Then I was defeated by my pathetic doppelgänger and now I am weak and they command me. We are allies, I need to save my world as well as them, you cannot let anyone destroy what you want to conquer."
                            [/message]
                            [message]
                                speaker=Efraim
                                message=_"It is hard to believe you actually obey somebody, Lilith. You never tried to overthrow her?"
                            [/message]
                            [message]
                                speaker=Lilith
                                message= _ "..."
                            [/message]
                            [message]
                                speaker=Lethalia
                                message=_"Obviously, you are afraid that Uria is eavesdropping right?"
                            [/message]
                            [message]
                                speaker=Lilith
                                message=_"No more talks! I am going to kill you now."
                            [/message]
                            [message]
                                speaker=Efraim
                                message=_"Or get smashed by us."
                            [/message]
                        [/event]
                    [/then]
                [/if]
                [if]
                    [variable]
                        name=quests.met_lilith
                        equals=4
                    [/variable]
                    [then]
                        [event]
                            name=lilith chat
                            [message]
                                speaker=Lethalia
                                message=_"You again? You are a slow learner. You could have figured out that attacking us is meaningless."
                            [/message]
                            [message]
                                speaker=Lilith
                                message= _ "You call it stupidity, I call it endurance. Admit that you cannot defeat me, while I just need a few attempts."
                            [/message]
                            [message]
                                speaker=Lethalia_evil
                                message=_"Endurance? That is zealous and blind obedience to Uria."
                            [/message]
                            [message]
                                speaker=Efraim
                                message=_"This for how long will you continue chasing us, Lilith? Until you run out of power completely, become useless to Uria, making her abandon her part of the deal?"
                            [/message]
                            [message]
                                caption= _ "Somebody"
                                image=units/unknown-unit.png
                                speaker=narrator
                                message= _ "Do not try to instil disobedience among my servants, puny..."
                            [/message]
                            [message]
                                speaker=Efraim
                                message=_"Uria, may I remind you that I am older than you, kid? How much of Lilith's maternal milk do you drink?"
                            [/message]
                            [message]
                                speaker=Lethalia_evil
                                message=_"Good one."
                            [/message]
                            [message]
                                caption= _ "Somebody"
                                image=units/unknown-unit.png
                                speaker=narrator
                                message= _ "Next time, I will not be gentle on you, I will take you captive and torture you..."
                            [/message]
                            [message]
                                speaker=Efraim
                                message=_"You were apparently reading some literature that was unfit for your age."
                            [/message]
                            [message]
                                speaker=Lilith
                                message= _ "I must admit that I enjoyed your taunting. As a reward, I will kill you swiftly. Of course, this offer will expire after this meeting."
                            [/message]
                            [message]
                                speaker=Lethalia_evil
                                message=_"I wanted to promise the same to Uria, I prefer not to torture children."
                            [/message]
                            [message]
                                speaker=Efraim
                                message=_"Lethalia, this might seem as a petty annoyance, but if she comes during a tough combat, she might make us lose. We must get rid of her before proceeding further."
                            [/message]
                        [/event]
                    [/then]
                [/if]
                [if]
                    [variable]
                        name=quests.met_lilith
                        equals=5
                    [/variable]
                    [then]
                        [event]
                            name=lilith chat
                            [message]
                                speaker=Efraim
                                message=_"How much punishment do you need to take until you learn not to annoy us, Lilith?"
                            [/message]
                            [message]
                                speaker=Lilith
                                message= _ "Why do <i>you</i> persist, by the way? You are marooned in this world, with no way back. You can do whatever you want, you will not get back. Souls are reincarnated, you know? If you die, you will come home, so why so much resistance?"
                            [/message]
                            [message]
                                speaker=Efraim
                                message=_"Death is not an option for us. If we cannot get to our world, we will make our world get to us. If we find no solution how to get back, we will make hell freeze over, conquer it, and transform it to be like Irdya."
                            [/message]
                            [message]
                                speaker=Lethalia_evil
                                message=_"This is what I like to hear!"
                            [/message]
                            [message]
                                speaker=Lilith
                                message= _ "Keep dreaming, fools. You have killed a few unimportant demons nobody cares about, is that the source of your undying optimism? You are living in a lie."
                            [/message]
                            [message]
                                speaker=Lethalia
                                message=_"I am tired of talks like that. Can you make her shut her mouth somehow?"
                            [/message]
                            [message]
                                speaker=Lethalia_evil
                                message=_"Your eyes are so ugly, I wonder which cadaver did you steal them from. How scared you must be when you look into a mirror... oh well, that is irrelevant, you have destroyed them all when you could not look at your ugly nose. "
                            [/message]
                            [message]
                                speaker=Efraim
                                message=_"Your teeth are like stars on the nocturnal sky... so yellow and far away from each other."
                            [/message]
                            [message]
                                speaker=Lilith
                                message= _ "How dare you?! You will die, now!"
                            [/message]
                        [/event]
                    [/then]
                [/if]
                [if]
                    [variable]
                        name=quests.met_lilith
                        equals=6
                    [/variable]
                    [then]
                        [event]
                            name=lilith chat
                            [message]
                                speaker=Efraim
                                message=_"(yawn) Maybe you should give up, you are wasting our time. Yours as well. Uria scammed you in that deal, are you so blind not to see it? She even called you a servant before. How do you like being called slave?"
                            [/message]
                            [message]
                                speaker=Lilith
                                message= _ "I am no man's slave!"
                            [/message]
                            [message]
                                speaker=Efraim
                                message=_"Uria is not a man. She has neither the right gender, neither the right age. You are the slave of a little girl."
                            [/message]
                            [message]
                                caption= _ "Somebody"
                                image=units/unknown-unit.png
                                speaker=narrator
                                message= _ "I am not a child! I am thousands of years old and you should know that."
                            [/message]
                            [message]
                                speaker=Lethalia_evil
                                message=_"Somebody cannot recognise humour."
                            [/message]
                            [message]
                                speaker=Lethalia
                                message=_"Amazing mathematical knowledge, Uria."
                            [/message]
                            [message]
                                caption= _ "Somebody"
                                image=units/unknown-unit.png
                                speaker=narrator
                                message= _ "I am the most powerful being in this world. I will appear as an avatar so powerful that will kill all of you."
                            [/message]
                            [message]
                                speaker=Efraim
                                message=_"Quiet, the elders are talking."
                            [/message]
                            [message]
                                speaker=Lilith
                                message= _ "If you enrage Uria too much, she will come to you in person, and you cannot handle that. Not yet."
                            [/message]
                            [message]
                                speaker=Lethalia
                                message=_"If she comes to us, she will make our search for her much easier."
                            [/message]
                            [message]
                                speaker=Lilith
                                message= _ "You have no idea what you are talking about. You will have to die for that ignorance."
                            [/message]
                            [message]
                                speaker=Efraim
                                message=_"Oh, this time you are attacking us for an extra reason. Maybe it will make you even weaker than usually."
                            [/message]
                            [message]
                                speaker=Lilith
                                message= _ "How dare you?! Say your farewells!"
                            [/message]
                            [message]
                                speaker=Lethalia
                                message=_"Efraim, we have to get rid of her for good! Meeting that gadfly when fighting another powerful entity could be our doom. Well... she might hold clues how to slay Uria. So we should grill her first – an idea I do not like that much."
                            [/message]
                        [/event]
                    [/then]
                [/if]
                [if]
                    [variable]
                        name=quests.met_lilith
                        equals=7
                    [/variable]
                    [then]
                        [event]
                            name=lilith chat
                            [message]
                                speaker=Lilith
                                message= _ "Prepare to die, weaklings."
                            [/message]
                            [message]
                                speaker=Efraim
                                message=_"Please, not again."
                            [/message]
                            [message]
                                speaker=Lethalia_evil
                                message=_"You are boring, you should know that."
                            [/message]
                            [message]
                                speaker=Lilith
                                message= _ "Really? I think you were really excited when fighting me. Fear of death in your eyes, struggling to keep my axes away from your weak bodies..."
                            [/message]
                            [message]
                                speaker=Efraim
                                message=_"I am speaking about your talks. I am sick of them, they are giving me an ulcer."
                            [/message]
                            [message]
                                speaker=Lilith
                                message= _ "You can get sick? You are much weaker than I expected."
                            [/message]
                            [message]
                                speaker=Lethalia_evil
                                message=_"You underestimate the boredom powers of your talks."
                            [/message]
                            [message]
                                speaker=Efraim
                                message=_"Please, spare me of another boring comment, Lilith. Let us proceed to kicking butts, as usually."
                            [/message]
                        [/event]
                    [/then]
                [/if]
                [if]
                    [variable]
                        name=quests.met_lilith
                        equals=8
                    [/variable]
                    [then]
                        [event]
                            name=lilith chat
                            [message]
                                speaker=Lilith
                                message=_"There is no escape! I will kill you!"
                            [/message]
                            [message]
                                speaker=Lethalia_evil
                                message=_"For how long were you polishing you boring abilities? Centuries? Millennia? I think you were not so boring back in the day when we fought your and your servants in Arach."
                            [/message]
                            [message]
                                speaker=Efraim
                                message=_"Ooough, that ulcer is getting really bad, I might need to see a healer."
                            [/message]
                            [message]
                                speaker=Lilith
                                message= _ "I am fed up of your stupid jokes. Say your farewells to your loved ones and we can proceed to killing."
                            [/message]
                            [message]
                                speaker=Efraim
                                message=_"Oh, my beloved, this might be the last time we are making fun of Lilith, how horrible is it?"
                            [/message]
                            [if]
                                [have_unit]
                                    id=Lethalia_evil
                                [/have_unit]
                                [then]
                                    [message]
                                        speaker=Lethalia_evil
                                        message=_"That is horrible. I will also miss burying the bodies of her followers. I always wanted to be an undertaker."
                                    [/message]
                                    [message]
                                        speaker=Lethalia
                                        message=_"He was not talking to you, you are not <i>his beloved</i>, maggot."
                                    [/message]
                                    [message]
                                        speaker=Lethalia_evil
                                        message=_"But you wanted to be an undertaker, you cannot deny it. We have the same past, <i>my sillier self</i>. I remember very clearly how I, or you, does not matter, applied for the job so that in the case of theft I would not be suspected anything if seen there often, at nighttime. I did not stay there for long, they chased me with pitchforks when they learned that I was snatching... flowers."
                                    [/message]
                                    [message]
                                        speaker=Lethalia
                                        message=_"I did, but I was a young maiden back then, only about three centuries old!"
                                    [/message]
                                    [message]
                                        speaker=Lethalia_evil
                                        message=_"Dear me, most elves die from old age well before! Blowing smoke? There is no one here you can delude, you were a prune then, surely not a maiden... Come on, we are the Graverobbing Sisterhood!"
                                    [/message]
                                [/then]
                            [/if]
                            [message]
                                speaker=Lethalia
                                message=_"..."
                            [/message]
                        [/event]
                    [/then]
                [/if]
                [if]
                    [variable]
                        name=quests.met_lilith
                        equals=9
                    [/variable]
                    [then]
                        [event]
                            name=lilith chat
                            [message]
                                speaker=Lilith
                                message=_"Now..."
                            [/message]
                            [message]
                                speaker=Efraim
                                message=_"How does it feel, losing so many times. Does Uria punish you for that? If yes, that must be quite frustrating to you, I bow down to your endurance."
                            [/message]
                            [message]
                                speaker=Lilith
                                message= _ "I just..."
                            [/message]
                            [message]
                                speaker=Lethalia_evil
                                message=_"...keep failing or the time, I am so weak that I cannot even face a group of beings lost in my own realm, fighting an endless war for survival. I cannot believe that I..."
                            [/message]
                            [message]
                                speaker=Lethalia
                                message=_"...fail even to hit the targets with my axes."
                            [/message]
                            [message]
                                speaker=Lilith
                                message= _ "(scream of anger) I JUST WANT TO KILL YOU FINALLY!!!"
                            [/message]
                        [/event]
                    [/then]
                [/if]
                [if]
                    [variable]
                        name=quests.met_lilith
                        equals=10
                    [/variable]
                    [then]
                        [event]
                            name=lilith chat
                            [message]
                                speaker=Lilith
                                message=_"I was trying to figure out how can you persist for so long, but it seems that it was sheer luck."
                            [/message]
                            [message]
                                speaker=Efraim
                                message=_"Because you are so weak and dumb that you cannot even understand how weak and dumb you are."
                            [/message]
                            [message]
                                speaker=Lilith
                                message= _ "(scream of rage) I WILL KILL YOU TO STOP YOUR OBNOXIOUS MOCKERY!!!"
                            [/message]
                            [message]
                                speaker=Efraim
                                message=_"Excellent, lose all control even before the fight begins."
                            [/message]
                        [/event]
                    [/then]
                [/if]
                [if]
                    [variable]
                        name=quests.met_lilith
                        equals=11
                    [/variable]
                    [then]
                        [event]
                            name=lilith chat
                            [message]
                                speaker=Efraim
                                message=_"You are so damn boring, can you just stop annoying us?"
                            [/message]
                            [message]
                                speaker=Lilith
                                message= _ "You will die!"
                            [/message]
                            [message]
                                speaker=Lethalia_evil
                                message=_"How many times did she tell that already? A hundred?"
                            [/message]
                        [/event]
                    [/then]
                [/if]
                [if]
                    [variable]
                        name=quests.met_lilith
                        equals=12
                    [/variable]
                    [then]
                        [event]
                            name=lilith chat
                            [message]
                                speaker=Efraim
                                message=_"Go away, I do not want to see your ugly face again..."
                            [/message]
                            [message]
                                speaker=Lilith
                                message= _ "This time, I will not lose!"
                            [/message]
                        [/event]
                    [/then]
                [/if]
                [if]
                    [variable]
                        name=quests.met_lilith
                        greater_than=12
                    [/variable]
                    [then]
                        [event]
                            name=lilith chat
                            [message]
                                speaker=Lilith
                                message= _ "Time to die!"
                            [/message]
                            [message]
                                speaker=Lethalia
                                message=_"Can you just go away and save us from annoyance and yourself from another humiliation?"
                            [/message]
                        [/event]
                    [/then]
                [/if]
                [if]
                    [variable]
                        name=quests.lilith_deaths
                        greater_than=0
                    [/variable]
                    [else]
                        [event]
                            name=last breath
                            id=lilith death
                            [filter]
                                id=Lilith
                            [/filter]
                            [message]
                                speaker=Lilith
                                message=_"We shall meet again. Next time, I will prepare better abilities."
                            [/message]
                            {VARIABLE quests.lilith_deaths 1}
                        [/event]
                    [/else]
                    [then]
                        [if]
                            [variable]
                                name=quests.lilith_deaths
                                equals=1
                            [/variable]
                            [then]
                                [event]
                                    name=last breath
                                    id=lilith death
                                    [filter]
                                        id=Lilith
                                    [/filter]
                                    [message]
                                        speaker=Lilith
                                        message=_"You can keep defeating me endlessly, I can always reappear. And if you die, you will remain dead, puny mortals..."
                                    [/message]
                                    {VARIABLE_OP quests.lilith_deaths add 1}
                                [/event]
                            [/then]
                        [/if]
                        [if]
                            [variable]
                                name=quests.lilith_deaths
                                equals=2
                            [/variable]
                            [then]
                                [if]
                                    [variable]
                                        name=quests.lilith
                                        equals=1
                                    [/variable]
                                    [not]
                                        [variable]
                                            name=quests.entered_sc14
                                            equals=yes
                                        [/variable]
                                    [/not]
                                    [then]
                                        [event]
                                            name=last breath
                                            id=lilith death
                                            [filter]
                                                id=Lilith
                                            [/filter]
                                            [message]
                                                speaker=Lilith
                                                message=_"I will be back."
                                            [/message]
                                            {VARIABLE background "$story_map_old.background|~BLIT(maps/hell/14_Foul_Pits.png~CS(-50,-50,40))"}
                                            {VARIABLE story_map_old.background $background}
                                            {CLEAR_VARIABLE background}
                                            {VARIABLE quests.lilith 2}
                                            {VARIABLE_OP quests.lilith_deaths add 1}
                                            [if]
                                                [variable]
                                                    name=quests.overall
                                                    less_than=6
                                                [/variable]
                                                [then]
                                                    {VARIABLE quests.objectives_comment _"
Important locations discovered are marked blue on the map.
The map can be viewed through the right-click menu."}
                                                [/then]
                                            [/if]
                                            [message]
                                                speaker=Efraim
                                                message=_"Her teleportation spell was too simple, too easy to track. Maybe she focused on losing only one precious item of her collection, but that was tactically unwise. Now we know where she retreats to. Her lair is in Foul Pits, quite appropriate for her. It is a cave system near the western borderline."
                                            [/message]
                                        [/event]
                                    [/then]
                                    [else]
                                        {VARIABLE_OP quests.lilith_deaths add 1}
                                    [/else]
                                [/if]
                            [/then]
                        [/if]
                        [if]
                            [variable]
                                name=quests.lilith_deaths
                                equals=3
                            [/variable]
                            [then]
                                [event]
                                    name=last breath
                                    id=lilith death
                                    [filter]
                                        id=Lilith
                                    [/filter]
                                    [message]
                                        speaker=Lilith
                                        message=_"Sooner or later you will fail. And die. While I can respawn forever."
                                    [/message]
                                    {VARIABLE_OP quests.lilith_deaths add 1}
                                [/event]
                            [/then]
                        [/if]
                        [if]
                            [variable]
                                name=quests.lilith_deaths
                                equals=4
                            [/variable]
                            [then]
                                [event]
                                    name=last breath
                                    id=lilith death
                                    [filter]
                                        id=Lilith
                                    [/filter]
                                    [message]
                                        speaker=Efraim
                                        message=_"Tell Uria that we are fed up of her pitiful slaves, and want to see her instead."
                                    [/message]
                                    {VARIABLE_OP quests.lilith_deaths add 1}
                                [/event]
                            [/then]
                        [/if]
                        [if]
                            [variable]
                                name=quests.lilith_deaths
                                equals=5
                            [/variable]
                            [then]
                                [event]
                                    name=last breath
                                    id=lilith death
                                    [filter]
                                        id=Lilith
                                    [/filter]
                                    [message]
                                        speaker=Lethalia
                                        message=_"Die, and stay dead!"
                                    [/message]
                                    [message]
                                        speaker=Efraim
                                        message=_"We should really make sure that she stays dead. Foul Pits await."
                                    [/message]
                                    {VARIABLE_OP quests.lilith_deaths add 1}
                                [/event]
                            [/then]
                        [/if]
                        [if]
                            [variable]
                                name=quests.lilith_deaths
                                equals=6
                            [/variable]
                            [then]
                                [event]
                                    name=last breath
                                    id=lilith death
                                    [filter]
                                        id=Lilith
                                    [/filter]
                                    [message]
                                        speaker=Lilith
                                        message=_"I will come back and I will teach you a lesson!"
                                    [/message]
                                    [message]
                                        speaker=Lethalia_evil
                                        message=_"What lesson, that you are weak and we can go on killing you without any limitations?"
                                    [/message]
                                    {VARIABLE_OP quests.lilith_deaths add 1}
                                [/event]
                            [/then]
                        [/if]
                        [if]
                            [variable]
                                name=quests.lilith_deaths
                                equals=7
                            [/variable]
                            [then]
                                [event]
                                    name=last breath
                                    id=lilith death
                                    [filter]
                                        id=Lilith
                                    [/filter]
                                    [message]
                                        speaker=Lethalia
                                        message=_"This should teach you a lesson."
                                    [/message]
                                    {VARIABLE_OP quests.lilith_deaths add 1}
                                [/event]
                            [/then]
                        [/if]
                        [if]
                            [variable]
                                name=quests.lilith_deaths
                                equals=8
                            [/variable]
                            [then]
                                [event]
                                    name=last breath
                                    id=lilith death
                                    [filter]
                                        id=Lilith
                                    [/filter]
                                    [message]
                                        speaker=Efraim
                                        message=_"Death to the boring demons!"
                                    [/message]
                                    {VARIABLE_OP quests.lilith_deaths add 1}
                                [/event]
                            [/then]
                        [/if]
                        [if]
                            [variable]
                                name=quests.lilith_deaths
                                greater_than=8
                            [/variable]
                            [then]
                                [event]
                                    name=last breath
                                    id=lilith death
                                    [filter]
                                        id=Lilith
                                    [/filter]
                                    [message]
                                        speaker=Efraim
                                        message=_"And stay dead!"
                                    [/message]
                                    {VARIABLE_OP quests.lilith_deaths add 1}
                                [/event]
                            [/then]
                        [/if]
                    [/then]
                [/if]
            [/else]
        [/if]
        [if]
            [variable]
                name=quests.abaddon
                greater_than=2
            [/variable]
            [else]
                [if]
                    [variable]
                        name=quests.met_abaddon
                        greater_than=0
                    [/variable]
                    [else]
                        [event]
                            name=abaddon chat
                            [message]
                                speaker=Abaddon
                                message= _"They are here. Prepare to tear them to pieces, soldiers."
                            [/message]
                            [message]
                                speaker=Lethalia
                                message=_"You are the monster we saw near the portal into Inferno."
                            [/message]
                            [message]
                                speaker=Abaddon
                                message= _ "Yes, that was me."
                            [/message]
                            [message]
                                speaker=Efraim
                                message=_"How did you even get here? You were not in Inferno when the portal was closed."
                            [/message]
                            [message]
                                speaker=Abaddon
                                message=_"All the important demons were teleported through the portal into a specific place in Inferno just before it closed. The portal's control was made so that before it closed, it dragged all important demons into a specific place in Inferno just before it closed. It was done like that for the case if rebellious demons decided to lock a part of us in Irdula in order to take over Inferno."
                            [/message]
                            [message]
                                speaker=Efraim
                                message=_"What is Irdula? Are you attacking more than one world?"
                            [/message]
                            [message]
                                speaker=Abaddon
                                message=_"Do not play an idiot, it is not funny. It is the world you come from, you must know that, so you were playing an idiot."
                            [/message]
                            [message]
                                speaker=Efraim
                                message=_"It is called Irdya."
                            [/message]
                            [message]
                                speaker=Abaddon
                                message=_"Ah, yes, it is called Irdya. So, where did I end? Ah, it was done for the case if rebellious demons..."
                            [/message]
                            [message]
                                speaker=Lethalia
                                message=_"You have told that part already."
                            [/message]
                            [message]
                                speaker=Abaddon
                                message=_"So, anyway, you see that I was taken here, that I am an important demon. That was just to give you an idea how strong I am and how much you should fear me. The fear will make you weak, an easy prey."
                            [/message]
                            [message]
                                speaker=Lethalia
                                message=_"We have already met. We know how strong you are. You are weak."
                            [/message]
                            [message]
                                speaker=Lethalia_evil
                                message=_"And also quite blind, you failed to notice when I was sneaking around you into the portal."
                            [/message]
                            [message]
                                speaker=Abaddon
                                message=_"Stop mocking me, you shall see how it hurts to be hit be my hammer. Very soon. "
                            [/message]
                            [message]
                                speaker=Efraim
                                message=_"Many others already made such promises to us. And had to break them, every single promise like that was broken."
                            [/message]
                            [message]
                                speaker=Abaddon
                                message=_"And your bones will be broken!"
                            [/message]
                            [message]
                                speaker=Efraim
                                message=_"Did you even listen to the whole thing I said or you just had to repeat the last word I said in your sentence?"
                            [/message]
                            [message]
                                speaker=Abaddon
                                message=_"I was trying to talk a bit before fighting, you know? Because you were naughty, I am proceeding to fighting."
                            [/message]
                            [message]
                                speaker=Efraim
                                message=_"Let us hope that you are as bad at fighting as at talking, because my back hurts a bit and I want to finish fighting before dinner."
                            [/message]
                            [message]
                                speaker=Lethalia_evil
                                message=_"Great that you mentioned food. This thing must have a lot of good meat on it."
                            [/message]
                        [/event]
                    [/else]
                [/if]
                [if]
                    [variable]
                        name=quests.met_abaddon
                        equals=1
                    [/variable]
                    [then]
                        [event]
                            name=abaddon chat
                            [message]
                                speaker=Abaddon
                                message= _ "Last time, you won. I was not prepared to fight as much as I needed to, so you won. This time, I am better prepared."
                            [/message]
                            [message]
                                speaker=Lethalia
                                message=_"We won because you were weak."
                            [/message]
                            [message]
                                speaker=Abaddon
                                message=_"You cannot hit as hard as I can. Neither of you can hit as hard as I can. Neither of you can lift as heavy objects as I can. Therefore, I am stronger!"
                            [/message]
                            [message]
                                speaker=Lilith
                                message= _ "This is his typical behaviour."
                            [/message]
                            [message]
                                speaker=Efraim
                                message=_"The real strength does not lie in muscle size, you need to break through defence, hit the vulnerable spots, wear a weapon that ravages flesh by itself and use magic to strengthen your arms."
                            [/message]
                            [message]
                                speaker=Abaddon
                                message= _ "That is not true. Real strength means muscle size! And I am also the toughest, when you hit me, I felt almost nothing!"
                            [/message]
                            [message]
                                speaker=Efraim
                                message=_"You need to learn to avoid being hit, dodging and blocking attacks. That is the secret of surviving a lot of fights. Even if the hits do not stun you, you will die from too many wounds. But you will not accept that anyway."
                            [/message]
                            [message]
                                speaker=Abaddon
                                message= _ "That is wrong! I am the strongest, I am the toughest. I defeated Uria in handwrestling!"
                            [/message]
                            [message]
                                speaker=Lethalia
                                message=_"You can also challenge her into a fist duel, if you win and kill her, we will accept that you are the strongest."
                            [/message]
                            [message]
                                speaker=Abaddon
                                message=_ "Uria cannot beat me in a fist duel, you can take my victory as granted!"
                            [/message]
                            [message]
                                speaker=Efraim
                                message=_"Yes, yes, but I cannot be sure. Do it first, then we will agree that you are the strongest and toughest demon we have ever seen."
                            [/message]
                            [message]
                                speaker=Abaddon
                                message=_ "Wait, you want to trick me to kill Uria? You cheaters, you tried to trick me to kill Uria! If it was even possible, when Uria dies, she comes back! I will kill you dead for trying to trick me!"
                            [/message]
                            [message]
                                speaker=Lethalia_evil
                                message=_"...to trick you to kill Uria, you can tell that even three times."
                            [/message]
                        [/event]
                    [/then]
                [/if]
                [if]
                    [variable]
                        name=quests.met_abaddon
                        equals=2
                    [/variable]
                    [then]
                        [event]
                            name=abaddon chat
                            [message]
                                speaker=Abaddon
                                message= _ "Now I will kill you, I will not be so gentle on you as Uria told me!"
                            [/message]
                            [message]
                                speaker=Lethalia
                                message=_"Why would she want you to be gentle on us?"
                            [/message]
                            [message]
                                speaker=Abaddon
                                message=_"Uhm... I have no idea why would she tell something like that!"
                            [/message]
                            [message]
                                speaker=Lethalia
                                message=_"That means that she did not tell you that, right?"
                            [/message]
                            [message]
                                speaker=Abaddon
                                message= _ "She did not tell me that, uhm. But I was gentle on you and now I will not be. Prepare to die, puny humans."
                            [/message]
                            [message]
                                speaker=Efraim
                                message=_"Moron..."
                            [/message]
                        [/event]
                    [/then]
                [/if]
                [if]
                    [variable]
                        name=quests.met_abaddon
                        equals=3
                    [/variable]
                    [then]
                        [event]
                            name=abaddon chat
                            [message]
                                speaker=Abaddon
                                message= _ "You did not defeat me properly before! You used magic to weaken me, to steal the strength from my muscles! I demand a rematch."
                            [/message]
                            [message]
                                speaker=Lethalia
                                message=_"I agree, you can have a rematch, come and get killed again."
                            [/message]
                            [message]
                                speaker=Lethalia_evil
                                message=_"I long to rip your flesh with my blade, and if you want it, then fine, I agree."
                            [/message]
                            [message]
                                speaker=Lilith
                                message= _ "I never liked you, brute. I will enjoy seeing your flesh being ripped."
                            [/message]
                            [message]
                                speaker=Efraim
                                message=_"Girls, enough! He wants to speak with a man, I believe."
                            [/message]
                            [message]
                                speaker=Abaddon
                                message= _ "Yes, I want to speak to a man, but I am failing to find any."
                            [/message]
                            [message]
                                speaker=Efraim
                                message=_"You cannot see me? Are you blind?"
                            [/message]
                            [message]
                                speaker=Abaddon
                                message= _ "I can see you, but you look too feminine for a man. I believe that you might actually give birth to a child of mine..."
                            [/message]
                            [message]
                                speaker=Lethalia_evil
                                message=_"Efraim, try harder, it is such a shame when a dim-witted brute like Abaddon succeeds to mock you!"
                            [/message]
                            [message]
                                speaker=Efraim
                                message=_"A child with me? I am not quite sure if <i>you</i> are a man, when you feel some attraction towards me."
                            [/message]
                            [message]
                                speaker=Lethalia_evil
                                message=_"Try harder!"
                            [/message]
                            [message]
                                speaker=Abaddon
                                message= _ "It is right to feel attraction towards you, woman. I am sometimes wondering if it is correct to slaughter women like you, but well, I am a demon, I kill men, women like you and children without remorse."
                            [/message]
                            [message]
                                speaker=Lethalia
                                message=_"Another reason for us to kill you."
                            [/message]
                            [message]
                                speaker=Abaddon
                                message= _ "It will be you who dies this time. Maybe I will have some enjoyment with your not yet dead bodies before death, and maybe you will have to wait for the death for some time..."
                            [/message]
                        [/event]
                    [/then]
                [/if]
                [if]
                    [variable]
                        name=quests.met_abaddon
                        equals=4
                    [/variable]
                    [then]
                        [event]
                            name=abaddon chat
                            [message]
                                speaker=Lethalia
                                message=_"You again? Or it is something else that stinks so horribly?"
                            [/message]
                            [message]
                                speaker=Abaddon
                                message= _ "It is me. And this time I am stronger than before, and I will kill you like nothing!"
                            [/message]
                            [message]
                                speaker=Lethalia_evil
                                message=_"Nothing itself cannot kill. Are you trying to say that you will fail killing us again? It appears that you are getting wiser lately, congratulations."
                            [/message]
                            [message]
                                speaker=Efraim
                                message=_"I see. If you are really stronger, the difference is neglectful."
                            [/message]
                            [message]
                                speaker=Abaddon
                                message= _ "I am Abaddon, the left hand of Uria, I never lose!"
                            [/message]
                            [message]
                                speaker=Efraim
                                message=_"That means nothing. Uria lied to you, you can lose. Or she cleared your memory and you cannot remember? Uria is no god, she is just a liar who is powerful enough to make everybody believe in her divine essence."
                            [/message]
                            [message]
                                caption= _ "Somebody"
                                image=units/unknown-unit.png
                                speaker=narrator
                                message= _ "I am a god, how dare you speak such blasphemy?!"
                            [/message]
                            [message]
                                speaker=Efraim
                                message=_"You cannot be a god if your left hand is so weak."
                            [/message]
                            [message]
                                caption= _ "Somebody"
                                image=units/unknown-unit.png
                                speaker=narrator
                                message= _ "It was Abaddon's failure not mine. It is Abaddon's fault that you are even here, in Inferno!"
                            [/message]
                            [message]
                                speaker=Efraim
                                message=_"It was Abaddon's fault and Abaddon is your left hand. Thus, your left hand keeps failing to capture us. A god never fails. Thus, you are not a god."
                            [/message]
                            [message]
                                caption= _ "Somebody"
                                image=units/unknown-unit.png
                                speaker=narrator
                                message= _ "Everything happens for a reason. You are just failing to understand it, and that does not disprove my divinity, it proves your ignorance."
                            [/message]
                            [message]
                                speaker=Efraim
                                message=_"I would like to hear this anecdote."
                            [/message]
                            [message]
                                caption= _ "Somebody"
                                image=units/unknown-unit.png
                                speaker=narrator
                                message= _ "There is also a reason why I am not telling you why."
                            [/message]
                            [message]
                                speaker=Lethalia
                                message= _ "I know that reason why. Because there is no reason why you made Abaddon fail."
                            [/message]
                            [message]
                                speaker=Abaddon
                                message= _ "I am Abaddon, the left hand of Uria, I never lose!"
                            [/message]
                            [message]
                                speaker=Lethalia_evil
                                message=_"You already told that. You cannot make a statement true by repeating it twice."
                            [/message]
                            [message]
                                speaker=Abaddon
                                message= _ "I can do whatever I want! I am the left hand of Uria."
                            [/message]
                            [message]
                                speaker=Efraim
                                message=_"But you obey Lilith, the right hand of Uria, am I right?"
                            [/message]
                            [message]
                                speaker=Abaddon
                                message= _ "I can do whatever I want! I am the left hand of Uria!"
                            [/message]
                            [message]
                                speaker=Efraim
                                message=_"Lilith is above you, then. Or is Uria a southpaw?"
                            [/message]
                            [message]
                                speaker=Abaddon
                                message= _ "No complacent women control me!"
                            [/message]
                            [message]
                                speaker=Efraim
                                message=_"Excluding Uria. Or have you misremembered the meaning of the word 'complacent'?"
                            [/message]
                            [message]
                                speaker=Abaddon
                                message= _ "Nobody will insult me. I will kill you!"
                            [/message]
                        [/event]
                    [/then]
                [/if]
                [if]
                    [variable]
                        name=quests.met_abaddon
                        equals=5
                    [/variable]
                    [then]
                        [event]
                            name=abaddon chat
                            [message]
                                speaker=Efraim
                                message=_"I sense incompetence here... What is the name of the incompetent one?"
                            [/message]
                            [message]
                                speaker=Abaddon
                                message= _ "I am Abaddon, your doom, I am coming to take your soul to hell!"
                            [/message]
                            [message]
                                speaker=Lethalia_evil
                                message=_"We are already in hell."
                            [/message]
                            [message]
                                speaker=Lethalia
                                message=_"You will fail again, do you really think you can win?"
                            [/message]
                            [message]
                                speaker=Abaddon
                                message= _ "You will not have as much luck as before, weak Irdula-inhabitants!"
                            [/message]
                            [message]
                                speaker=Efraim
                                message=_"Who are you talking to? There is nobody from Irdula here."
                            [/message]
                            [message]
                                speaker=Abaddon
                                message= _ "It matters not! You know clearly that I meant your own world!"
                            [/message]
                            [message]
                                speaker=Efraim
                                message= _ "Oh, what an insight, bowing down to your intelligence. Anyway, I doubt that you can tell a sword from a saw. I mean that you are stupid."
                            [/message]
                            [message]
                                speaker=Abaddon
                                message= _ "You dare to insult me? You will die for it!"
                            [/message]
                            [message]
                                speaker=Lilith
                                message= _ "Magnificent insight, Abaddon, really magnificent insight, Abaddon."
                            [/message]
                            [message]
                                speaker=Lethalia_evil
                                message=_"Is this really the first time you noticed we are insulting you?"
                            [/message]
                        [/event]
                    [/then]
                [/if]
                [if]
                    [variable]
                        name=quests.met_abaddon
                        equals=6
                    [/variable]
                    [then]
                        [event]
                            name=abaddon chat
                            [message]
                                speaker=Efraim
                                message=_"Do you remember this stench, my love?"
                            [/message]
                            [message]
                                speaker=Lethalia
                                message= _ "Yes, but it cannot be me, I have washed myself during this millennium."
                            [/message]
                            [message]
                                speaker=Efraim
                                message=_"Who could it be, then..."
                            [/message]
                            [message]
                                speaker=Lilith
                                message=_"Maybe Abaddon."
                            [/message]
                            [message]
                                speaker=Efraim
                                message=_"Ah, Abaddon, yes of course. I propose you a deal. A mutually beneficial one."
                            [/message]
                            [message]
                                speaker=Abaddon
                                message=_"What deal? I hope it will not be another attempt to make me kill Uria."
                            [/message]
                            [message]
                                speaker=Efraim
                                message=_"You will stop annoying us with your relentless attacks. We will give you a piece of soap for return."
                            [/message]
                            [message]
                                speaker=Abaddon
                                message= _ "What does it mean 'soap'? I do not know what does it mean 'soap'."
                            [/message]
                            [message]
                                speaker=Lethalia
                                message=_"I will add a hipletzoon."
                            [/message]
                            [message]
                                speaker=Abaddon
                                message= _ "What does it mean 'hipletzoon'? Stop confusing me with weird words, it is making me confused!"
                            [/message]
                            [message]
                                speaker=Lethalia_evil
                                message= _ "It seems you really need a hipletzoon or two."
                            [/message]
                            [message]
                                speaker=Efraim
                                message=_"I will also give you a tomrargine."
                            [/message]
                            [message]
                                speaker=Abaddon
                                message= _ "You are making up words so that you could make fun of me. There is no such thing as soap!"
                            [/message]
                            [message]
                                speaker=Lethalia
                                message=_"He does not even believe in soap. That explains his stench."
                            [/message]
                        [/event]
                    [/then]
                [/if]
                [if]
                    [variable]
                        name=quests.met_abaddon
                        equals=7
                    [/variable]
                    [then]
                        [event]
                            name=abaddon chat
                            [message]
                                speaker=Lilith
                                message= _ "Ah, hello, Abaddon."
                            [/message]
                            [message]
                                speaker=Abaddon
                                message=_"I smell weakness."
                            [/message]
                            [message]
                                speaker=Lethalia_evil
                                message=_"It is just you."
                            [/message]
                            [message]
                                speaker=Efraim
                                message=_"I smell stupidity."
                            [/message]
                            [message]
                                speaker=Abaddon
                                message=_"I have asked Uria what soap is. That is for women like you! I bathe in lava!"
                            [/message]
                            [message]
                                speaker=Lilith
                                message= _ "That is an obvious lie. Even demons cannot bathe in lava."
                            [/message]
                            [message]
                                speaker=Efraim
                                message=_"Lava is much heavier than water. Only a small part of body would be submerged, the rest would float above the lava's surface."
                            [/message]
                            [message]
                                speaker=Abaddon
                                message=_"Enough insults, time to die, heretics!"
                            [/message]
                        [/event]
                    [/then]
                [/if]
                [if]
                    [variable]
                        name=quests.met_abaddon
                        equals=8
                    [/variable]
                    [then]
                        [event]
                            name=abaddon chat
                            [message]
                                speaker=Abaddon
                                message=_"It is time to finally get this world rid of cheaters like you!"
                            [/message]
                            [message]
                                speaker=Efraim
                                message=_"It is time to finally get this world rid of dumb brutes like you!"
                            [/message]
                            [message]
                                speaker=Abaddon
                                message=_"I have asked Uria if you and Lilith were right that I am stupid and she said that you and Lilith were wrong and that I am not stupid. She is a goddess, she knows how it is!"
                            [/message]
                            [message]
                                speaker=Lilith
                                message= _ "She just wanted to calm you and focus your anger on the ones she wants you to fight."
                            [/message]
                            [message]
                                speaker=Efraim
                                message=_"I am a god too, and there is a lot of things I do not know. Uria can err too, but I think that in this case, she just lied. Everybody can see how stupid you are."
                            [/message]
                            [message]
                                speaker=Abaddon
                                message=_"That is a slander!"
                            [/message]
                            [message]
                                speaker=Lethalia
                                message=_"That is truth."
                            [/message]
                            [message]
                                speaker=Abaddon
                                message=_"I will kill you for that!"
                            [/message]
                            [message]
                                speaker=Efraim
                                message=_"I think that we should destroy him permanently before reaching Uria, Uria will be tough enough, we do not need more enemies to fight simultaneously."
                            [/message]
                        [/event]
                    [/then]
                [/if]
                [if]
                    [variable]
                        name=quests.met_abaddon
                        equals=9
                    [/variable]
                    [then]
                        [event]
                            name=abaddon chat
                            [message]
                                speaker=Abaddon
                                message=_"I will kill you! To stop your insults for good! I am going to kill you!"
                            [/message]
                            [message]
                                speaker=Efraim
                                message=_"Realising how nice it was to chat with Lilith."
                            [/message]
                            [message]
                                speaker=Lilith
                                message=_"Oh, thank you. Maybe you could also marry me."
                            [/message]
                            [message]
                                speaker=Abaddon
                                message=_"I am better than Lilith! I will..."
                            [/message]
                            [message]
                                speaker=Lethalia
                                message=_"Yes, you have already told that you think you are going to kill us."
                            [/message]
                        [/event]
                    [/then]
                [/if]
                [if]
                    [variable]
                        name=quests.met_abaddon
                        equals=10
                    [/variable]
                    [then]
                        [event]
                            name=abaddon chat
                            [message]
                                speaker=Abaddon
                                message=_"You will die where you stand!"
                            [/message]
                            [message]
                                speaker=Efraim
                                message=_"Can you remember how many times did you promise us things like that? Or you have a bad memory because of your stupidity?"
                            [/message]
                            [message]
                                speaker=Abaddon
                                message= _ "(scream of rage) I WILL KILL YOU FOR THIS INSULT!!!"
                            [/message]
                        [/event]
                    [/then]
                [/if]
                [if]
                    [variable]
                        name=quests.met_abaddon
                        equals=11
                    [/variable]
                    [then]
                        [event]
                            name=abaddon chat
                            [message]
                                speaker=Lilith
                                message= _ "Look, Abaddon is there."
                            [/message]
                            [message]
                                speaker=Abaddon
                                message=_"Destroy the heretics, my warriors, rend their dying flesh."
                            [/message]
                            [message]
                                speaker=Efraim
                                message=_"Please, not again... We must kill him, these encounters are becoming outrageous, and fighting Abaddon besides Uria will be problematic."
                            [/message]
                            [message]
                                speaker=Lethalia_evil
                                message=_"You have already suggested that, my dear."
                            [/message]
                        [/event]
                    [/then]
                [/if]
                [if]
                    [variable]
                        name=quests.met_abaddon
                        equals=12
                    [/variable]
                    [then]
                        [event]
                            name=abaddon chat
                            [message]
                                speaker=Efraim
                                message=_"Go away, I do not want to see your stupid face again..."
                            [/message]
                            [message]
                                speaker=Abaddon
                                message= _ "I will kill you dead!"
                            [/message]
                            [message]
                                speaker=Lethalia_evil
                                message=_"Once, I killed a man, and I did not kill him dead, I killed him undead."
                            [/message]
                        [/event]
                    [/then]
                [/if]
                [if]
                    [variable]
                        name=quests.met_abaddon
                        greater_than=12
                    [/variable]
                    [then]
                        [event]
                            name=abaddon chat
                            [message]
                                speaker=Abaddon
                                message= _ "Time to die!"
                            [/message]
                            [message]
                                speaker=Efraim
                                message=_"Yes, yes, yes, I think that too, I am really getting fed up of your constant appearances that never lead anywhere."
                            [/message]
                        [/event]
                    [/then]
                [/if]
                [if]
                    [variable]
                        name=quests.abaddon_deaths
                        greater_than=0
                    [/variable]
                    [else]
                        [event]
                            name=last breath
                            [filter]
                                id=Abaddon
                            [/filter]
                            id=abaddon death
                            [message]
                                speaker=Abaddon
                                message=_"Cheater, you had an army against me!"
                            [/message]
                            [message]
                                speaker=Efraim
                                message=_"You had an army too, but you failed to use it properly."
                            [/message]
                            {VARIABLE quests.abaddon_deaths 1}
                        [/event]
                    [/else]
                    [then]
                        [if]
                            [variable]
                                name=quests.abaddon_deaths
                                equals=1
                            [/variable]
                            [then]
                                [event]
                                    name=last breath
                                    id=abaddon death
                                    [filter]
                                        id=Abaddon
                                    [/filter]
                                    [message]
                                        speaker=Abaddon
                                        message=_"Cheaters! You should not dodge my attacks! Show your toughness, I wanted to see how can you face taking a solid blow!"
                                    [/message]
                                    {VARIABLE_OP quests.abaddon_deaths add 1}
                                [/event]
                            [/then]
                        [/if]
                        [if]
                            [variable]
                                name=quests.abaddon_deaths
                                equals=2
                            [/variable]
                            [then]
                                [if]
                                    [variable]
                                        name=quests.abaddon
                                        equals=1
                                    [/variable]
                                    [then]
                                        [event]
                                            name=last breath
                                            [filter]
                                                id=Abaddon
                                            [/filter]
                                            id=abaddon death
                                            [message]
                                                speaker=Abaddon
                                                message=_"I will return and kill you."
                                            [/message]
                                            {VARIABLE quests.abaddon 2}
                                            {VARIABLE_OP quests.abaddon_deaths add 1}
                                            [message]
                                                speaker=Efraim
                                                message=_"I know where he was taken to by Uria's enchantment. He keeps returning into a place called Verminous Sewers, it should not be far from Uria. If we visit him and kill him there, he might not be able to return."
                                            [/message]
                                        [/event]
                                    [/then]
                                    [else]
                                        {VARIABLE_OP quests.abaddon_deaths add 1}
                                    [/else]
                                [/if]
                            [/then]
                        [/if]
                        [if]
                            [variable]
                                name=quests.abaddon_deaths
                                equals=3
                            [/variable]
                            [then]
                                [event]
                                    name=last breath
                                    id=abaddon death
                                    [filter]
                                        id=Abaddon
                                    [/filter]
                                    [message]
                                        speaker=Abaddon
                                        message=_"You will die anyway. Uria will..."
                                    [/message]
                                    [message]
                                        speaker=Efraim
                                        message=_"Yes, go crying to your vile mother."
                                    [/message]
                                    {VARIABLE_OP quests.abaddon_deaths add 1}
                                [/event]
                            [/then]
                        [/if]
                        [if]
                            [variable]
                                name=quests.abaddon_deaths
                                equals=4
                            [/variable]
                            [then]
                                [event]
                                    name=last breath
                                    id=abaddon death
                                    [filter]
                                        id=Abaddon
                                    [/filter]
                                    [message]
                                        speaker=Efraim
                                        message=_"Tell Uria that we have enough of her pitiful slaves, and want to see her instead."
                                    [/message]
                                    {VARIABLE_OP quests.abaddon_deaths add 1}
                                [/event]
                            [/then]
                        [/if]
                        [if]
                            [variable]
                                name=quests.abaddon_deaths
                                equals=5
                            [/variable]
                            [then]
                                [event]
                                    name=last breath
                                    id=abaddon death
                                    [filter]
                                        id=Abaddon
                                    [/filter]
                                    [message]
                                        speaker=Abaddon
                                        message=_"Argh..."
                                    [/message]
                                    [message]
                                        speaker=Lethalia
                                        message=_"How about simply torturing him until he goes mad and unsuitable to proceed with his missions?"
                                    [/message]
                                    [message]
                                        speaker=Efraim
                                        message=_"Uria would strip him of his powers and give them to some other demons. We need to destroy him and the powers he wields."
                                    [/message]
                                    {VARIABLE_OP quests.abaddon_deaths add 1}
                                [/event]
                            [/then]
                        [/if]
                        [if]
                            [variable]
                                name=quests.abaddon_deaths
                                equals=6
                            [/variable]
                            [then]
                                [event]
                                    name=last breath
                                    id=abaddon death
                                    [filter]
                                        id=Abaddon
                                    [/filter]
                                    [message]
                                        speaker=Abaddon
                                        message=_"You defeated me... again. Maybe..."
                                    [/message]
                                    [message]
                                        speaker=Lethalia
                                        message=_"Maybe what? Maybe you should abandon your meaningless endeavour?"
                                    [/message]
                                    [message]
                                        speaker=Abaddon
                                        message=_"Never!"
                                    [/message]
                                    {VARIABLE_OP quests.abaddon_deaths add 1}
                                [/event]
                            [/then]
                        [/if]
                        [if]
                            [variable]
                                name=quests.abaddon_deaths
                                equals=7
                            [/variable]
                            [then]
                                [event]
                                    name=last breath
                                    id=abaddon death
                                    [filter]
                                        id=Abaddon
                                    [/filter]
                                    [message]
                                        speaker=Lethalia
                                        message=_"I never thought that I will have to fight stupidity this way."
                                    [/message]
                                    [message]
                                        speaker=Abaddon
                                        message=_"I am not stupid!"
                                    [/message]
                                    {VARIABLE_OP quests.abaddon_deaths add 1}
                                [/event]
                            [/then]
                        [/if]
                        [if]
                            [variable]
                                name=quests.abaddon_deaths
                                equals=8
                            [/variable]
                            [then]
                                [event]
                                    name=last breath
                                    id=abaddon death
                                    [filter]
                                        id=Abaddon
                                    [/filter]
                                    [message]
                                        speaker=Efraim
                                        message=_"You are not only stupid, you are also weak."
                                    [/message]
                                    [message]
                                        speaker=Abaddon
                                        message=_"I am not weak! I am not stupid neither!"
                                    [/message]
                                    {VARIABLE_OP quests.abaddon_deaths add 1}
                                [/event]
                            [/then]
                        [/if]
                        [if]
                            [variable]
                                name=quests.abaddon_deaths
                                greater_than=8
                            [/variable]
                            [then]
                                [event]
                                    name=last breath
                                    id=abaddon death
                                    [filter]
                                        id=Abaddon
                                    [/filter]
                                    [message]
                                        speaker=Efraim
                                        message=_"And I do not want to see your bovine face again!"
                                    [/message]
                                    {VARIABLE_OP quests.abaddon_deaths add 1}
                                [/event]
                            [/then]
                        [/if]
                    [/then]
                [/if]
            [/else]
        [/if]
        [if]
            [variable]
                name=quests.romero_deaths
                greater_than=0
            [/variable]
            [else]
                [event]
                    name=last breath
                    id=romero death
                    [filter]
                        id=Romero
                    [/filter]
                    [message]
                        speaker=Romero
                        message=_"Fortunately, death is not permanent for me. See you later."
                    [/message]
                    {VARIABLE quests.romero_deaths 1}
                [/event]
            [/else]
            [then]
                [if]
                    [variable]
                        name=quests.romero_deaths
                        equals=1
                    [/variable]
                    [then]
                        [event]
                            name=last breath
                            id=romero death
                            [filter]
                                id=Romero
                            [/filter]
                            [message]
                                speaker=Lilith
                                message=_"And never come again."
                            [/message]
                            [message]
                                speaker=Romero
                                message=_"Lilith, what is going on with you?"
                            [/message]
                            {VARIABLE_OP quests.romero_deaths add 1}
                        [/event]
                    [/then]
                [/if]
                [if]
                    [variable]
                        name=quests.romero_deaths
                        equals=2
                    [/variable]
                    [then]
                        [event]
                            name=last breath
                            id=romero death
                            [filter]
                                id=Romero
                            [/filter]
                            [message]
                                speaker=Romero
                                message=_"I will see you again, Efraim the thief of females!"
                            [/message]
                            {VARIABLE_OP quests.romero_deaths add 1}
                        [/event]
                    [/then]
                [/if]
                [if]
                    [variable]
                        name=quests.romero_deaths
                        equals=3
                    [/variable]
                    [then]
                        [event]
                            name=last breath
                            id=romero death
                            [filter]
                                id=Romero
                            [/filter]
                            [message]
                                speaker=Romero
                                message=_"Um… I have a rendezvous with Uria on my agenda. The fair ladies here rebuff me, so it is... ahem, pressing. See you later."
                            [/message]
                        [/event]
                    [/then]
                [/if]
            [/then]
        [/if]
        [event]
            name=uria avatar initialise
            [event]
                name=attack
                [filter]
                    id=Uria
                [/filter]
                [event]
                    name=new turn
                    delayed_variable_substitution=yes
                    first_time_only=no
                    [store_unit]
                        [filter]
                            id=Uria
                        [/filter]
                        variable=uria_store
                        kill=yes
                    [/store_unit]
                    [if]
                        [variable]
                            name=uria_store.length
                            greater_than=0
                        [/variable]
                        [then]
                            {VARIABLE_OP chosen_variation rand (sylph,assassin,warlock)}
                            [unit]
                                id=Uria
                                x,y=$uria_store.x,$uria_store.y
                                hitpoints=$uria_store.hitpoints
                                experience=$uria_store.experience
                                variation=$chosen_variation
                                name= _ "Uria"
                                type=Uria_avatar
                                random_traits=no
                                side=$uria_store.side
                                [insert_tag]
                                    name=modifications
                                    variable=uria_store.modifications
                                [/insert_tag]
                                [insert_tag]
                                    name=variables
                                    variable=uria_store.variables
                                [/insert_tag]
                                [insert_tag]
                                    name=status
                                    variable=uria_store.status
                                [/insert_tag]
                            [/unit]
                        [/then]
                    [/if]
                    {CLEAR_VARIABLE chosen_variation,uria_store}
                [/event]
            [/event]
            [event]
                name=victory
                {CLEAR_VARIABLE uria_side}
            [/event]
        [/event]
        [if]
            [variable]
                name=quests.talked_about_liliths_defeat
                equals=1
            [/variable]
            [or]
                [variable]
                    name=quests.lilith
                    equals=4
                [/variable]
            [/or]
            [then]
                # Nothing to talk about Lilith's defeat
                [if]
                    [variable]
                        name=quests.talked_about_liliths_betrayal
                        equals=1
                    [/variable]
                    [or]
                        [variable]
                            name=quests.lilith
                            equals=3
                        [/variable]
                    [/or]
                    [then]
                        # Nothing to talk about Lilith's betrayal
                        [if]
                            [variable]
                                name=quests.talked_about_abaddons_death
                                equals=1
                            [/variable]
                            [or]
                                [variable]
                                    name=quests.abaddon
                                    equals=3
                                [/variable]
                            [/or]
                            [then]
                                # Nothing to talk about Abaddon's death, talking about breaking seals
                                [if]
                                    [variable]
                                        name=quests.guardian_kill_talk
                                        equals=1
                                    [/variable]
                                    [or]
                                        [variable]
                                            name=quests.overall
                                            greater_than=7
                                        [/variable]
                                    [/or]
                                    [else]
                                        [if]
                                            [variable]
                                                name=quests.overall
                                                equals=3
                                            [/variable]
                                            [then]
                                                [event]
                                                    name=uria current events chat
                                                    [message]
                                                        speaker=Lethalia
                                                        message= _"Uria, I am amazed how great are the defences of your durance. We have already broken one of the protecting seals, and it was easy."
                                                    [/message]
                                                    [message]
                                                        speaker=Uria
                                                        message= _"Hmph. You have defeated the least competent of the seal guardians. I doubt you will manage to destroy the others, if you even manage to find them."
                                                    [/message]
                                                    [message]
                                                        speaker=Efraim
                                                        message= _"The one who dies first is the least competent in your eyes, correct?"
                                                    [/message]
                                                    [message]
                                                        speaker=Uria
                                                        message= _"His death is the proof of his weakness. The others will crush you!"
                                                    [/message]
                                                    [message]
                                                        speaker=Efraim
                                                        message= _"I call that <i>wishful thinking</i>."
                                                    [/message]
                                                    {VARIABLE quests.guardian_kill_talk 1}
                                                [/event]
                                            [/then]
                                        [/if]
                                        [if]
                                            [variable]
                                                name=quests.overall
                                                equals=4
                                            [/variable]
                                            [then]
                                                [event]
                                                    name=uria current events chat
                                                    [message]
                                                        speaker=Uria
                                                        message= _"By the way, you have managed to defeat two of the protectors of the seals that keep you from my den. Congrutalations."
                                                    [/message]
                                                    [message]
                                                        speaker=Lethalia
                                                        message= _"Yes, I am proud of that as well."
                                                    [/message]
                                                    [message]
                                                        speaker=Uria
                                                        message= _"It is amazing how can your sly tricks can defeat beings that are much stronger than you. You do not fight honestly, showing how does your raw power compare to theirs."
                                                    [/message]
                                                    [message]
                                                        speaker=Efraim
                                                        message= _"Your huge amounts of power were achieved by sly tricks, we know that, you cannot taunt us to try to fight the raw power your servants are borrowing without thinking about it."
                                                    [/message]
                                                    [message]
                                                        speaker=Uria
                                                        message= _"I was born with my power."
                                                    [/message]
                                                    [message]
                                                        speaker=Efraim
                                                        message= _"Not with all of it, but I know you will never agree with it..."
                                                    [/message]
                                                    [message]
                                                        speaker=Uria
                                                        message= _"I cannot agree with false claims."
                                                    [/message]
                                                    {VARIABLE quests.guardian_kill_talk 1}
                                                [/event]
                                            [/then]
                                        [/if]
                                        [if]
                                            [variable]
                                                name=quests.overall
                                                equals=5
                                            [/variable]
                                            [then]
                                                [event]
                                                    name=uria current events chat
                                                    [message]
                                                        speaker=Lethalia
                                                        message= _"Maybe you have not noticed, but only a single seal stands between you and us. We are on our way to you, Uria."
                                                    [/message]
                                                    [message]
                                                        speaker=Uria
                                                        message= _"Do you think that that is the only obstacle? Even if you manage to defeat the last seal guardian, the path will be still long enough. My armies will crush you, take your naked half-dead mortal shells to me, and I will learn how to harness your power to synergise with mine, and become even stronger."
                                                    [/message]
                                                    [message]
                                                        speaker=Efraim
                                                        message= _"Your armies failed at doing that so far. And I know of no reason why the direction of this war's evolution should change."
                                                    [/message]
                                                    [message]
                                                        speaker=Uria
                                                        message= _"I was keeping the more precious soldiers away from your blades hoping that the others will kill you and my elite will not be damaged. Anyway, you will soon run out of luck and get defeated by the final seal guardian."
                                                    [/message]
                                                    [message]
                                                        speaker=Efraim
                                                        message= _"Pathetic excuses..."
                                                    [/message]
                                                    {VARIABLE quests.guardian_kill_talk 1}
                                                [/event]
                                            [/then]
                                        [/if]
                                        [if]
                                            [variable]
                                                name=quests.overall
                                                equals=6
                                            [/variable]
                                            [then]
                                                [event]
                                                    name=uria current events chat
                                                    [message]
                                                        speaker=Uria
                                                        message= _"It appears that you are on your way to see me. I have underestimated you."
                                                    [/message]
                                                    [message]
                                                        speaker=Lethalia
                                                        message= _"Yes, you have."
                                                    [/message]
                                                    [message]
                                                        speaker=Uria
                                                        message= _"It seems that I will need to pay you more attention."
                                                    [/message]
                                                    [message]
                                                        speaker=Efraim
                                                        message= _"I think that it is impossible. We are already getting all your attention, and surviving."
                                                    [/message]
                                                    [message]
                                                        speaker=Uria
                                                        message= _"I will send my elite demons after you!"
                                                    [/message]
                                                    [message]
                                                        speaker=Efraim
                                                        message= _"Finally some excitement, I was bored of slaughtering the others like pigs."
                                                    [/message]
                                                    {VARIABLE quests.guardian_kill_talk 1}
                                                [/event]
                                            [/then]
                                        [/if]
                                    [/else]
                                [/if]
                            [/then]
                            [else]
                                # Abaddon just died
                                [event]
                                    name=uria current events chat
                                    [message]
                                        speaker=Lethalia
                                        message= _"Oh, Uria, were you watching how beautifully we destroyed Abaddon?"
                                    [/message]
                                    [message]
                                        speaker=Uria
                                        message= _"I was expecting that his stupidity would get him killed once, but I did not want to give you the courage by telling you about it."
                                    [/message]
                                    [message]
                                        speaker=Efraim
                                        message= _"So why did you choose him over the other candidates."
                                    [/message]
                                    [message]
                                        speaker=Uria
                                        message= _"Demons like him are usually stupid, he was not the most stupid of them by far."
                                    [/message]
                                    [message]
                                        speaker=Lilith
                                        message= _"Demons are usually stupid? You are not really clever, I have noticed that so far..."
                                    [/message]
                                    [message]
                                        speaker=Efraim
                                        message= _"You should have chosen the least stupid one."
                                    [/message]
                                    [message]
                                        speaker=Uria
                                        message= _"I have chosen Abaddon for his strength and Lilith for her intelligence. However, while Abaddon's dumbness was making him extremely loyal, Lilith's intelligence was... making her too individualistic at times."
                                    [/message]
                                    [message]
                                        speaker=Lethalia
                                        message= _"There were surely some equally loyal and much more clever demons with almost as much strength."
                                    [/message]
                                    [message]
                                        speaker=Uria
                                        message= _"Abaddon was the strongest, and he was not so dumb. He could even defeat me in handwrestling without using my powers! Me, a god!"
                                    [/message]
                                    [message]
                                        speaker=Efraim
                                        message= _"Yes, handwrestling is the method we will use to defeat you."
                                    [/message]
                                    {VARIABLE quests.talked_about_abaddons_death 1}
                                [/event]
                            [/else]
                        [/if]
                    [/then]
                    [else]
                        # Lilith just betrayed Uria
                        [event]
                            name=uria current events chat
                            [message]
                                speaker=Efraim
                                message= _"Uria, it appears that you cannot even control the behaviour of your servants, what do you think? Maybe you could give up."
                            [/message]
                            [message]
                                speaker=Uria
                                message= _"I never really trusted her. She was too concerned about her own power and own ideas. But her lust for power could be harnessed to make a servant from her."
                            [/message]
                            [message]
                                speaker=Lilith
                                message= _"That is wrong. I debased myself to ally with you only because the power I was borrowing was useful to me. The few quests you assigned to me were merely a small annoyance, I did not really do any of them myself, just sent a few undead to do that or pretend that it was done. When the invaders appeared, I was a bit curious to see who they are, then I chased them because they were a common threat. But you were more annoying than they, so I decided to stop following you."
                            [/message]
                            [message]
                                speaker=Uria
                                message= _"That is a nice way to tell that you served me for the small fraction of my power you could harness."
                            [/message]
                            [message]
                                speaker=Lilith
                                message= _"So you actually did not want me to destroy the rebellious demons that camped on Slopes of Villainy?"
                            [/message]
                            [message]
                                speaker=Uria
                                message= _"I wanted you to destroy them, and you destroyed them, as I ordered. You followed my orders as a good slave."
                            [/message]
                            [message]
                                speaker=Lilith
                                message= _"I did not really fight them, I just told them to fake their death and camp elsewhere because you were aware of the location of their hideout. That was much easier to do, they moved their camp, and you believed that I killed them. You failed to spot my disobedience so many times..."
                            [/message]
                            [message]
                                speaker=Uria
                                message= _"How could you dare to disobey my orders, Lilith!"
                            [/message]
                            [message]
                                speaker=Lilith
                                message= _"I serve nobody except myself. Now, I am going to kill you because I hate you and an alliance with these invaders is the only way to achieve that."
                            [/message]
                            [message]
                                speaker=Efraim
                                message= _"That is what I call misplaced trust."
                            [/message]
                            [message]
                                speaker=Uria
                                message= _"Fools, Lilith will betray you as well!"
                            [/message]
                            [message]
                                speaker=Lilith
                                message= _"They know. We will part ways whenever our cooperation ceases to be mutually beneficial. Only you cannot spot betrayal in your ranks."
                            [/message]
                            [message]
                                speaker=Uria
                                message= _"Well, Lilith is not a real danger to me now anyway..."
                            [/message]
                            {VARIABLE quests.talked_about_liliths_betrayal 1}
                        [/event]
                    [/else]
                [/if]
            [/then]
            [else]
                # Lilith just left
                [event]
                    name=uria current events chat
                    [message]
                        speaker=Efraim
                        message= _"Uria, we have defeated Lilith, your right hand, what do you say about it?"
                    [/message]
                    [message]
                        speaker=Uria
                        message= _"Lilith was weak, and was not able to use the brute power I was giving her. She always needed her complicated spells that used little power. Once, she wrote her discoveries into a spellbook that was later stolen. Even a human mage could cast her spells, can you believe that?"
                    [/message]
                    [message]
                        speaker=Lilith
                        message= _"Damn you, Uria."
                    [/message]
                    [message]
                        speaker=Efraim
                        message= _"That is just you, raw power, little intelligence used to cast it. We were not lucky like you to be born with it, we had to collect it ourselves, step by step, innovating spells, harnessing the power of surroundings..."
                    [/message]
                    [message]
                        speaker=Uria
                        message= _"So you agree that I am more powerful?"
                    [/message]
                    [message]
                        speaker=Efraim
                        message= _"Just that your raw power is greater, nothing else. You cannot harness it properly, that is why your avatars are weak and your final defeat is near."
                    [/message]
                    [message]
                        speaker=Lilith
                        message= _"I must agree, haha."
                    [/message]
                    [message]
                        speaker=Uria
                        message= _"You are wrong..."
                    [/message]
                    {VARIABLE quests.talked_about_liliths_defeat 1}
                [/event]
            [/else]
        [/if]
        [if]
            [variable]
                name=quests.met_uria_avatar
                greater_than=0
            [/variable]
            [else]
                [event]
                    name=uria avatar chat
                    [message]
                        speaker=Uria
                        message= _"Hail, invaders. My name is Uria of Heap, but I am usually called simply Uria. I am the Tyrant Goddess of demons and Queen of this realm. I am pleased to have found some free time to meet you, although not in person."
                    [/message]
                    [message]
                        speaker=Efraim
                        message=_"I am Efraim, the Slayer of Kings. I am not very pleased to meet you, so pardon me that I will not say hello."
                    [/message]
                    [message]
                        speaker=Lethalia_evil
                        message=_"You have found some time to meet us in person? You were eavesdropping on the talk with Lilith, you have certainly a lot of free time."
                    [/message]
                    [message]
                        speaker=Uria
                        message= _"So rude. Visitors should have some manners."
                    [/message]
                    [message]
                        speaker=Efraim
                        message=_"You mentioned that you are not meeting us in person. What shall you do if we simply prevent you from fleeing and defeat you here?"
                    [/message]
                    [message]
                        speaker=Uria
                        message= _ "Hahahahahaaaaa, that is impossible. You are not looking at me. This is just a projection of me, a lesser avatar. If you destroy it, nothing happens to me. But if you do not destroy it, which is very likely to happen, something will happen to you. Something unpleasant."
                    [/message]
                    [message]
                        speaker=Efraim
                        message=_"Why are you cowardly hiding in your keep and just sending your projections here? You cannot attack us in person? Are you imprisoned here?"
                    [/message]
                    [message]
                        speaker=Uria
                        message=_"There is a difference between cowardice and carefulness. There is always a really small chance that you will manage to harm me. Despite my magnificent power, you sly pests might find a flaw in my defences and use it to cause harm to me. And there is a really small chance that you will harm me permanently, and I cannot allow that."
                    [/message]
                    [message]
                        speaker=Efraim
                        message=_"So you admit that you are not immortal. That is great. We just need to repel your avatar and figure out how to harm you."
                    [/message]
                    [message]
                        speaker=Uria
                        message=_"That is still extremely unlikely to happen. You cannot learn about the powers I harness anyway. And even in the case you learned it, you will have to get to me, through countless guardians, defenders and protectors..."
                    [/message]
                    [fire_event]
                        name=uria current events talk
                    [/fire_event]
                    [message]
                        speaker=Efraim
                        message=_"I think I know of a trick that would harm you through your avatar."
                    [/message]
                    [message]
                        speaker=Uria
                        message=_"Impossible! It is just a complex magical illusion I am controlling like a puppet."
                    [/message]
                    [message]
                        speaker=Lethalia
                        message=_"How?"
                    [/message]
                    [message]
                        speaker=Efraim
                        message=_"T'reas krokob'op... (telepathic whisper) Puppet illusions do not move so precisely, their facial expression is usually blank, and they cannot see their surrounding properly. Uria must be possessing the illusionary image of herself. That way, she can make it stronger, more realistic, and can keep it going even after taking a few hits. I was able to harm the living by drawing sheer terror into their eyes when I was undead, and I might still be able to do that."
                    [/message]
                    [message]
                        speaker=Lethalia
                        message=_"That might work, but do you think it would work on something as powerful as Uria is?"
                    [/message]
                    [message]
                        speaker=Efraim
                        message=_"(continuing the telepathic discussion) I doubt that. I might make her mad, but that would not help us too much. I just need to plant doubts into her mind, making her uselessly careful and summon avatars like this less frequently. Say something suitable now."
                    [/message]
                    [message]
                        speaker=Lethalia
                        message=_"Good idea, that should keep her away from us..."
                    [/message]
                    [message]
                        speaker=Uria
                        message=_"I will figure out what is the trick you are planning to use, and then I shall raise defences against such tricks!"
                    [/message]
                    [message]
                        speaker=Lethalia
                        message=_"You will never figure that out."
                    [/message]
                    [message]
                        speaker=Lethalia_evil
                        message=_"You are not smart enough to compare with Efraim!"
                    [/message]
                    [message]
                        speaker=Uria
                        message=_"I will teach you to stop insulting me!"
                    [/message]
                    [message]
                        speaker=Efraim
                        message=_"I will teach you to stop attacking us!"
                    [/message]
                [/event]
            [/else]
        [/if]
        [if]
            [variable]
                name=quests.met_uria_avatar
                equals=1
            [/variable]
            [then]
                [event]
                    name=uria avatar chat
                    [message]
                        speaker=Uria
                        message= _ "Hello again. I wanted to congratulate you for defeating me last avatar. It was flawed, and I have learned from my mistake."
                    [/message]
                    [message]
                        speaker=Lethalia
                        message=_"I doubt that."
                    [/message]
                    [message]
                        speaker=Uria
                        message=_"Do you always doubt the power of anybody you do not like?"
                    [/message]
                    [message]
                        speaker=Efraim
                        message=_"We do not doubt your power, but we doubt your invincibility and the existence of a mistake that was in your previous avatar's design. It simply was not powerful enough to overpower us."
                    [/message]
                    [message]
                        speaker=Uria
                        message= _ "Trust me, it was a design failure."
                    [/message]
                    [message]
                        speaker=Efraim
                        message=_"I am truly scared now."
                    [/message]
                    [message]
                        speaker=Lethalia_evil
                        message=_"Heeelp! A well-designed avatar of Uria is chasing us! We are doomed!"
                    [/message]
                    [message]
                        speaker=Uria
                        message= _ "You will learn to take me seriously. Or, in fact no. I was mistaken, you cannot learn something after your death."
                    [/message]
                    [message]
                        speaker=Lethalia
                        message=_"In fact, the reason is different, we are too wise to learn things that are not correct."
                    [/message]
                    [message]
                        speaker=Efraim
                        message=_"Do not force me to try the trick I figured out. I do not want to use it because it is so horrible that I do not wish that even to loathsome demons like you, but if your avatar will be too persistent, I will have no other choice."
                    [/message]
                    [message]
                        speaker=Uria
                        message= _ "I am really afraid now."
                    [/message]
                    [message]
                        speaker=Lethalia
                        message=_"How about leaving this fight because we are all really afraid of each other?"
                    [/message]
                    [message]
                        speaker=Uria
                        message= _ "I was joking."
                    [/message]
                    [message]
                        speaker=Lethalia
                        message=_"..."
                    [/message]
                    [fire_event]
                        name=uria current events talk
                    [/fire_event]
                [/event]
            [/then]
        [/if]
        [if]
            [variable]
                name=quests.met_uria_avatar
                equals=2
            [/variable]
            [then]
                [event]
                    name=uria avatar chat
                    [message]
                        speaker=Uria
                        message= _ "Time to give your progress a big slowdown again."
                    [/message]
                    [message]
                        speaker=Lethalia
                        message=_"Finally you agreed that your attacks will not defeat us and that will merely slow us a bit."
                    [/message]
                    [message]
                        speaker=Lethalia_evil
                        message=_"She is trying to get mercy from you. Do not let the destroyer of our world live!"
                    [/message]
                    [message]
                        speaker=Efraim
                        message=_"So you are preparing for your death, Uria?"
                    [/message]
                    [message]
                        speaker=Uria
                        message= _ "Hahahahaha. Great joke, Efraim."
                    [/message]
                    [message]
                        speaker=Efraim
                        message=_"I have already slain a queen. Slaying demon queens should not be much harder than slaying human queens."
                    [/message]
                    [message]
                        speaker=Uria
                        message= _ "That is quite a difference. Keep amusing me."
                    [/message]
                    [message]
                        speaker=Efraim
                        message=_"Talking to you this way leads to nowhere. Your pride is unmatchable. And it will cause your fall."
                    [/message]
                    [fire_event]
                        name=uria current events talk
                    [/fire_event]
                [/event]
            [/then]
        [/if]
        [if]
            [variable]
                name=quests.met_uria_avatar
                equals=3
            [/variable]
            [then]
                [event]
                    name=uria avatar chat
                    [message]
                        speaker=Uria
                        message= _ "You were getting bored without me, so I decided to bless you with a visit."
                    [/message]
                    [message]
                        speaker=Lethalia
                        message=_"I am really interested in your honeyed words, Uria."
                    [/message]
                    [message]
                        speaker=Lethalia_evil
                        message=_"Her words are sweet poison!"
                    [/message]
                    [message]
                        speaker=Uria
                        message= _ "Are you sure that my intentions are hostile? You are invading my home, by the way."
                    [/message]
                    [message]
                        speaker=Efraim
                        message=_"We are invading the land you conquered because you are invading our home, wretch."
                    [/message]
                    [message]
                        speaker=Uria
                        message= _ "You call me wretch for that? Have you noticed the strength of empires ruled by demons? I was bringing your world to glory."
                    [/message]
                    [message]
                        speaker=Efraim
                        message=_"Gloriously killing anybody who disagreed, teaching cruelty to anybody in arenas, gloriously killing random innocent citizens who looked tasty."
                    [/message]
                    [message]
                        speaker=Uria
                        message= _ "That is the way of demons."
                    [/message]
                    [message]
                        speaker=Efraim
                        message=_"And that is why you must be destroyed. Your pathetic avatar will go first."
                    [/message]
                    [fire_event]
                        name=uria current events talk
                    [/fire_event]
                [/event]
            [/then]
        [/if]
        [if]
            [variable]
                name=quests.met_uria_avatar
                equals=4
            [/variable]
            [then]
                [event]
                    name=uria avatar chat
                    [message]
                        speaker=Uria
                        message= _ "I am getting bored, I need to harass you again. Maybe the harassment will even kill you."
                    [/message]
                    [message]
                        speaker=Lethalia
                        message=_"Maybe you could come in person. That would make the fight much more exciting."
                    [/message]
                    [message]
                        speaker=Uria
                        message= _ "I am not going to make your way to me easier. You must understand that I do not risk, I have way too much to lose. Unlike you."
                    [/message]
                    [message]
                        speaker=Lethalia
                        message=_"Come on, only real danger can bring real excitement."
                    [/message]
                    [message]
                        speaker=Uria
                        message=_"I am not <i>so</i> bored. Sending my avatars against you is not dangerous at all, but it gives me a chance to destroy you quickly myself."
                    [/message]
                    [message]
                        speaker=Efraim
                        message= _ "Argherdorr morsu hyalenth tha'aba kaelinth!"
                    [/message]
                    [message]
                        speaker=Uria
                        message=_"Argh, what is that? It is horrible! Stop! Stop! (breathes heavily) Finally, I managed to finish that. You will pay for that!"
                    [/message]
                    [message]
                        speaker=Efraim
                        message=_"Do you really think that there is no danger?"
                    [/message]
                    [message]
                        speaker=Uria
                        message=_"I will not get tricked by that again. (facial expression goes blank for a while) Now, I am immune to that."
                    [/message]
                    [message]
                        speaker=Efraim
                        message=_"Then I will prepare a similar spell that will work next time I see you."
                    [/message]
                    [message]
                        speaker=Uria
                        message= _ "You will never have time for that, for I will kill you now!"
                    [/message]
                    [message]
                        speaker=Efraim
                        message= _ "Calm down, a queen like you should not lose control so easily."
                    [/message]
                    [fire_event]
                        name=uria current events talk
                    [/fire_event]
                [/event]
            [/then]
        [/if]
        [if]
            [variable]
                name=quests.met_uria_avatar
                equals=5
            [/variable]
            [then]
                [event]
                    name=uria avatar chat
                    [message]
                        speaker=Uria
                        message=_"I am going to kill you. Here and now. I will concentrate properly with this new avatar with improved design."
                    [/message]
                    [message]
                        speaker=Efraim
                        message= _ "Improved design? Is it going to survive one additional scratch?"
                    [/message]
                    [message]
                        speaker=Uria
                        message=_"Death of thousand scratches is the only way for you to defeat me, you know that!"
                    [/message]
                    [message]
                        speaker=Lethalia_evil
                        message=_"But still, dying from scratches... lame..."
                    [/message]
                    [message]
                        speaker=Lethalia
                        message=_"The only thing that makes you different from other demons is just that you can survive more punishment."
                    [/message]
                    [message]
                        speaker=Uria
                        message= _ "You are failing to notice my superior offensive abilities? My better looks?"
                    [/message]
                    [message]
                        speaker=Efraim
                        message=_"I care not if you look better or worse than common enemies, you will not seduce those who hate you!"
                    [/message]
                    [fire_event]
                        name=uria current events talk
                    [/fire_event]
                [/event]
            [/then]
        [/if]
        [if]
            [variable]
                name=quests.met_uria_avatar
                equals=6
            [/variable]
            [then]
                [event]
                    name=uria avatar chat
                    [message]
                        speaker=Uria
                        message=_"I think that you were longing to see me."
                    [/message]
                    [message]
                        speaker=Lethalia
                        message= _ "Longing to see you? Never. I am fighting to make sure I will never see you again!"
                    [/message]
                    [fire_event]
                        name=uria current events talk
                    [/fire_event]
                    [message]
                        speaker=Efraim
                        message=_"Maybe you should hide in your filthy den until we come to kill you or come to us in person!"
                    [/message]
                    [message]
                        speaker=Lilith
                        message=_"Uria never leaves her keep, she is getting really paranoid after the last assassination attempt. An assassination attempt that she survived only because the enemies failed to break through some of the protective layers that keep her immortal."
                    [/message]
                    [message]
                        speaker=Uria
                        message=_"I am waiting for that confrontation too. I secretly hope that you will get to me, but the practical part of me tells me to delay you, send armies of demons after you and destroy you long before you get to me."
                    [/message]
                    [message]
                        speaker=Lethalia
                        message=_"So your desire is to die? How about a deal..."
                    [/message]
                    [message]
                        speaker=Uria
                        message=_"I do not wish to die, my wish is to kill you personally, so that I could enjoy it properly."
                    [/message]
                    [message]
                        speaker=Lethalia
                        message=_"Ah, you can enjoy your own death only at home. I understand. I was also very depressive when I was a child."
                    [/message]
                    [message]
                        speaker=Uria
                        message= _ "I am fed up of your dumb comedy..."
                    [/message]
                [/event]
            [/then]
        [/if]
        [if]
            [variable]
                name=quests.met_uria_avatar
                equals=7
            [/variable]
            [then]
                [event]
                    name=uria avatar chat
                    [message]
                        speaker=Uria
                        message= _ "Ah, Efraim, Lethalia, what a pleasure to meet you."
                    [/message]
                    [message]
                        speaker=Efraim
                        message=_"Uria, are you longing to see the nightmarish phantasms again?"
                    [/message]
                    [message]
                        speaker=Uria
                        message= _ "Try that again, I have developed several shielding spells and a counterspell against that."
                    [/message]
                    [message]
                        speaker=Lethalia_evil
                        message=_"You are a bit overconfident."
                    [/message]
                    [message]
                        speaker=Efraim
                        message=_"Back in the day when I was a lich, I had developed all kinds of variations of this spell. Some could make you totally dizzy, some could affect multiple enemies, some allowed me to feed on the fear of its victims..."
                    [/message]
                    [message]
                        speaker=Uria
                        message=_"That cannot be true, you are too reluctant to use them."
                    [/message]
                    [message]
                        speaker=Efraim
                        message=_"I chose not to use them, because they were too horrible, but you are going to be an exception. I do not wish to see your ugly face until the day you die!"
                    [/message]
                    [message]
                        speaker=Uria
                        message= _ "That is a bad excuse. You are afraid that it will not work."
                    [/message]
                    [message]
                        speaker=Efraim
                        message=_"Dreathorgor morsu hyalenth krakararata ruythorgok ardumborg thaoreatha!"
                    [/message]
                    [message]
                        speaker=Uria
                        message= _ "It is funny where are you taking these funny words. Anyway, it is not... aaah, what is that thing? It is not real, focus, Uria, focus! (screams of sheer horror) Argh. (breathes heavily) That was horrible. I will have to prepare defences against that for some more time... No... I will just kill you now!"
                    [/message]
                    [message]
                        speaker=Efraim
                        message=_"Another empty promise..."
                    [/message]
                    [fire_event]
                        name=uria current events talk
                    [/fire_event]
                [/event]
            [/then]
        [/if]
        [if]
            [variable]
                name=quests.met_uria_avatar
                equals=8
            [/variable]
            [then]
                [event]
                    name=uria avatar chat
                    [message]
                        speaker=Uria
                        message=_"Hello, my darlings. It is time again..."
                    [/message]
                    [message]
                        speaker=Lethalia
                        message=_"... to plunge my axe into your flesh!"
                    [/message]
                    [message]
                        speaker=Uria
                        message=_"No more naughty words! My body is completely unharmed."
                    [/message]
                    [message]
                        speaker=Efraim
                        message=_"But I wonder how much black magic can your mind survive until it goes insane."
                    [/message]
                    [message]
                        speaker=Uria
                        message=_"You think that these spells have a permanent effect on me?"
                    [/message]
                    [message]
                        speaker=Efraim
                        message=_"Yes, of course. I was testing them. Once, I was fighting a dragon that did not want to leave or let us discover his den, and kept possessing random people to make them fight, command, rule... He had great experience in fighting in human form and could risk getting hit. With this spell, I could incapacitate him temporarily, and save the person he was possessing, although some of them died from the spell. After being struck by this spell several times, the dragon went insane and attacked me personally, so that I could slay him with ease."
                    [/message]
                    [message]
                        speaker=Uria
                        message=_"I am not a dragon."
                    [/message]
                    [message]
                        speaker=Efraim
                        message=_"The minds of all sapient beings are quite similar. Maybe they have different motivations, intelligence and lifespans, but they are all similar. This spell worked on humans, elves, drakes, saurians and even undead. It also worked on demons last time I tried. Do you really want to know if you are really special?"
                    [/message]
                    [message]
                        speaker=Uria
                        message= _ "I am special! Your spell is just very unpleasant!"
                    [/message]
                    [message]
                        speaker=Efraim
                        message=_"The dragon told that too, the last time it was accompanied by maniacal laugh and inconsistent talks about female dragons. It is impossible to see your sanity fading."
                    [/message]
                    [message]
                        speaker=Lilith
                        message=_"You used to behave more rationally before..."
                    [/message]
                    [message]
                        speaker=Lethalia
                        message=_"Yes, Uria is getting really irrational lately."
                    [/message]
                    [message]
                        speaker=Uria
                        message=_"You are lying! That cannot be true!"
                    [/message]
                    [message]
                        speaker=Efraim
                        message=_"That is the expected reaction. Lunatics never agree they mad."
                    [/message]
                    [fire_event]
                        name=uria current events talk
                    [/fire_event]
                [/event]
            [/then]
        [/if]
        [if]
            [variable]
                name=quests.met_uria_avatar
                equals=9
            [/variable]
            [then]
                [event]
                    name=uria avatar chat
                    [if]
                        [variable]
                            name=quests.overall
                            less_than=7
                        [/variable]
                        [then]
                            [message]
                                speaker=Uria
                                message=_"You are progressing way too slow. I was expecting you to move faster."
                            [/message]
                        [/then]
                        [else]
                            [message]
                                speaker=Uria
                                message=_"You have gone quite far. Still, I was expecting you to move faster."
                            [/message]
                        [/else]
                    [/if]
                    [message]
                        speaker=Efraim
                        message=_"You are failing to understand how boringly depressingly annoying you are. After each talk to you, we need to spend a week in a dark cave meditating to recover from the boredom you are causing."
                    [/message]
                    [message]
                        speaker=Uria
                        message=_"Hush. Stop being naughty or..."
                    [/message]
                    [message]
                        speaker=Efraim
                        message=_"...or you will come and we will be able to kill you right now?"
                    [/message]
                    [message]
                        speaker=Uria
                        message=_"Great trick, were you expecting it to work?"
                    [/message]
                    [fire_event]
                        name=uria current events talk
                    [/fire_event]
                [/event]
            [/then]
        [/if]
        [if]
            [variable]
                name=quests.met_uria_avatar
                equals=10
            [/variable]
            [then]
                [event]
                    name=uria avatar chat
                    [message]
                        speaker=Uria
                        message=_"Hello."
                    [/message]
                    [message]
                        speaker=Efraim
                        message=_"Die, damn you, get out of our way, we are fed up of your stupid face, your annoying speeches and your obnoxious servants...!"
                    [/message]
                    [message]
                        speaker=Lethalia
                        message= _ "Calm down, she might use your anger against you."
                    [/message]
                    [fire_event]
                        name=uria current events talk
                    [/fire_event]
                [/event]
            [/then]
        [/if]
        [if]
            [variable]
                name=quests.met_uria_avatar
                equals=11
            [/variable]
            [then]
                [event]
                    name=uria avatar chat
                    [message]
                        speaker=Uria
                        message= _ "I am sure you were longing to see me."
                    [/message]
                    [message]
                        speaker=Efraim
                        message=_"I will teach you respect! Have you forgotten about the problems my last nightmarish spell caused to you?"
                    [/message]
                    [message]
                        speaker=Uria
                        message= _ "A short while of pain, that is all."
                    [/message]
                    [message]
                        speaker=Efraim
                        message=_"But it was real pain. Do you seek it? Really? That might be another symptom of insanity."
                    [/message]
                    [message]
                        speaker=Uria
                        message= _ "I can handle it. If you will even get through the protective barrier I have build against spells like that."
                    [/message]
                    [message]
                        speaker=Efraim
                        message=_"Dreathorgor morsu thargarhanth ruythorgok ardumborg ya'ghatha kr'th'shtie kraugh-ast-ra'tharmargarth!"
                    [/message]
                    [message]
                        speaker=Uria
                        message= _ "It does not work! But, this phantasm is more real than the others... it is not a phantasm! Aaaaa, heeelp! Lilith, save me! (screams of horror, sometimes accompanied by giggles) Hahahahaha, I can survive that! It has no effect, it has no effect, hahahahahaha!"
                    [/message]
                    [message]
                        speaker=Lethalia_evil
                        message=_"Uria's mind is not very strong..."
                    [/message]
                    [message]
                        speaker=Efraim
                        message=_"Uria, how about coming to us in person? You do not fear us, we do not fear you, so how about finishing the combat here?"
                    [/message]
                    [message]
                        speaker=Uria
                        message= _ "Yes, why not, hahaha! Wait, I did not want to come for some reasons before, but who cares? I care! What did you just do to me? You rascals! I will make you pay for that! RIGHT NOW!"
                    [/message]
                    [message]
                        speaker=Lethalia_evil
                        message=_"Darn, she is recovering..."
                    [/message]
                    [fire_event]
                        name=uria current events talk
                    [/fire_event]
                [/event]
            [/then]
        [/if]
        [if]
            [variable]
                name=quests.met_uria_avatar
                equals=12
            [/variable]
            [then]
                [event]
                    name=uria avatar chat
                    [message]
                        speaker=Uria
                        message=_"Hi there!"
                    [/message]
                    [message]
                        speaker=Efraim
                        message= _ "Do we need her to go completely insane?"
                    [/message]
                    [message]
                        speaker=Uria
                        message=_"I am not getting insane!"
                    [/message]
                    [fire_event]
                        name=uria current events talk
                    [/fire_event]
                [/event]
            [/then]
        [/if]
        [if]
            [variable]
                name=quests.met_uria_avatar
                greater_than=12
            [/variable]
            [then]
                [event]
                    name=uria avatar chat
                    [message]
                        speaker=Uria
                        message= _ "So we meet again."
                    [/message]
                    [message]
                        speaker=Lethalia_evil
                        message=_"I wish she could not speak..."
                    [/message]
                    [fire_event]
                        name=uria current events talk
                    [/fire_event]
                [/event]
            [/then]
        [/if]
        [if]
            [variable]
                name=quests.uria_avatar_deaths
                greater_than=0
            [/variable]
            [else]
                [event]
                    name=last breath
                    [filter]
                        id=Uria
                    [/filter]
                    [message]
                        speaker=Uria
                        message=_"How could this happen, I must have made a mistake in this avatar's design!"
                    [/message]
                    [message]
                        speaker=Efraim
                        message=_"You should have found a better excuse, loser!"
                    [/message]
                    {VARIABLE quests.uria_avatar_deaths 1}
                [/event]
            [/else]
            [then]
                [if]
                    [variable]
                        name=quests.uria_avatar_deaths
                        equals=1
                    [/variable]
                    [then]
                        [event]
                            name=last breath
                            [filter]
                                id=Uria
                            [/filter]
                            [message]
                                speaker=Uria
                                message=_"How can you always find the weak spot I considered too hard to find to be worth fixing..."
                            [/message]
                            [message]
                                speaker=Efraim
                                message=_"Your avatars are useless against us, accept that!"
                            [/message]
                            {VARIABLE_OP quests.uria_avatar_deaths add 1}
                        [/event]
                    [/then]
                [/if]
                [if]
                    [variable]
                        name=quests.uria_avatar_deaths
                        equals=2
                    [/variable]
                    [then]
                        [event]
                            name=last breath
                            [filter]
                                id=Uria
                            [/filter]
                            [message]
                                speaker=Uria
                                message=_"Not again... But you must accept that I delayed you quite a bit."
                            [/message]
                            {VARIABLE_OP quests.uria_avatar_deaths add 1}
                        [/event]
                    [/then]
                [/if]
                [if]
                    [variable]
                        name=quests.uria_avatar_deaths
                        equals=3
                    [/variable]
                    [then]
                        [event]
                            name=last breath
                            [filter]
                                id=Uria
                            [/filter]
                            [message]
                                speaker=Efraim
                                message=_"Here you go, filth."
                            [/message]
                            [message]
                                speaker=Uria
                                message=_"You dare to call me <i>filth</i>?"
                            [/message]
                            [message]
                                speaker=Efraim
                                message=_"Yes, I do. You are defeated, have you noticed?"
                            [/message]
                            {VARIABLE_OP quests.uria_avatar_deaths add 1}
                        [/event]
                    [/then]
                [/if]
                [if]
                    [variable]
                        name=quests.uria_avatar_deaths
                        equals=4
                    [/variable]
                    [then]
                        [event]
                            name=last breath
                            [filter]
                                id=Uria
                            [/filter]
                            [message]
                                speaker=Efraim
                                message=_"Give it up, darn."
                            [/message]
                            {VARIABLE_OP quests.uria_avatar_deaths add 1}
                        [/event]
                    [/then]
                [/if]
                [if]
                    [variable]
                        name=quests.uria_avatar_deaths
                        equals=5
                    [/variable]
                    [then]
                        [event]
                            name=last breath
                            [filter]
                                id=Uria
                            [/filter]
                            [message]
                                speaker=Uria
                                message=_"I'll be blowed. After all that arduous hassle... I can not bear this any longer. Efraim, that spell you cast yonks ago..."
                            [/message]
                            [message]
                                speaker=Lethalia
                                message=_"Right. What about your curse, Efraim? Will it ever drive her nuts?"
                            [/message]
                            [message]
                                speaker=Efraim
                                message=_"That is possible, that kind of magic is really wicked."
                            [/message]
                            [message]
                                speaker=Uria
                                message=_"That is not what I meant, stop talking such rubbish! I won't go coo-coo! I... I... I am not insane!"
                            [/message]
                            {VARIABLE_OP quests.uria_avatar_deaths add 1}
                        [/event]
                    [/then]
                [/if]
                [if]
                    [variable]
                        name=quests.uria_avatar_deaths
                        equals=6
                    [/variable]
                    [then]
                        [event]
                            name=last breath
                            [filter]
                                id=Uria
                            [/filter]
                            [message]
                                speaker=Uria
                                message=_"I will be back, and I will not be so gentle on you!"
                            [/message]
                            [message]
                                speaker=Lethalia
                                message=_"And you were gentle now?"
                            [/message]
                            [message]
                                speaker=Uria
                                message=_"Yes!"
                            [/message]
                            [message]
                                speaker=Efraim
                                message=_"You call that gentle? You were trying to kill us all at costs... and you failed, as usual."
                            [/message]
                            {VARIABLE_OP quests.uria_avatar_deaths add 1}
                        [/event]
                    [/then]
                [/if]
                [if]
                    [variable]
                        name=quests.uria_avatar_deaths
                        equals=7
                    [/variable]
                    [then]
                        [event]
                            name=last breath
                            [filter]
                                id=Uria
                            [/filter]
                            [message]
                                speaker=Lethalia
                                message=_"And learn that you should not send any useless avatars against us!"
                            [/message]
                            [message]
                                speaker=Uria
                                message=_"I managed to hurt many of you..."
                            [/message]
                            [message]
                                speaker=Efraim
                                message=_"That was just a scratch."
                            [/message]
                            {VARIABLE_OP quests.uria_avatar_deaths add 1}
                        [/event]
                    [/then]
                [/if]
                [if]
                    [variable]
                        name=quests.uria_avatar_deaths
                        equals=8
                    [/variable]
                    [then]
                        [event]
                            name=last breath
                            [filter]
                                id=Uria
                            [/filter]
                            [message]
                                speaker=Uria
                                message=_"Not again, I hate being destroyed by a thousand scratches!"
                            [/message]
                            [message]
                                speaker=Efraim
                                message=_"Well, if you call that severed hand a scratch, I can say that you have never even scratched us."
                            [/message]
                            {VARIABLE_OP quests.uria_avatar_deaths add 1}
                        [/event]
                    [/then]
                [/if]
                [if]
                    [variable]
                        name=quests.uria_avatar_deaths
                        greater_than=8
                    [/variable]
                    [then]
                        [event]
                            name=last breath
                            [filter]
                                id=Uria
                            [/filter]
                            [message]
                                speaker=Efraim
                                message=_"And do not come back, unless it is really in person!"
                            [/message]
                            {VARIABLE_OP quests.uria_avatar_deaths add 1}
                        [/event]
                    [/then]
                [/if]
            [/then]
        [/if]
        [if]
            [variable]
                name=quests.met_romero
                greater_than=0
            [/variable]
            [else]
                [event]
                    name=romero chat
                    [message]
                        speaker=Lilith
                        message= _"I think that somebody is nearby. Somebody who might be hostile."
                    [/message]
                    [message]
                        speaker=Efraim
                        message=_"Somebody who <i>might</i> be hostile? The rebellious demons?"
                    [/message]
                    [message]
                        speaker=Romero
                        message=_"Hello, Lilith, I have not seen you for some time. I must tell that there is a huge mess in Uria's base since you left. We are all missing you, though most of them deny it, pretending unconditional loyalty to Uria. I know that you abandoned our cause because you do such things regularly, but that is how you are. Beautifully treacherous."
                    [/message]
                    [message]
                        speaker=Efraim
                        message= _"I do not find Lilith to be so beautiful. Treacherous yes, but not beautiful."
                    [/message]
                    [message]
                        speaker=Lethalia
                        message=_"Or you love treachery so much that you call it beautiful?"
                    [/message]
                    [message]
                        speaker=Romero
                        message=_"Both. Lilith is beautiful and I like her ways of betrayal. She always joins the better side, regardless of tradition and law. So fiercely independent is my beautiful Lilith."
                    [/message]
                    [message]
                        speaker=Lilith
                        message=_"This fool will never understand that I was his lover only because he was powerful and it was an easy way to manipulate him... Romero, you will never understand that I care not about you?"
                    [/message]
                    [message]
                        speaker=Romero
                        message=_"I see that you are telling this only to send me away. Maybe I should not have sided with Uria, if we were allies, it would be such a beautiful adventure. Only you and me, endless armies before us to slaughter with our weapons, magic and minions, to meet Uria near its end, and..."
                    [/message]
                    [message]
                        speaker=Lethalia
                        message=_"My life with Efraim could have been like that, but you have spoiled it completely."
                    [/message]
                    [message]
                        speaker=Romero
                        message=_"How about having a life like that together? Lilith and me, you two, our minions, weapons and magic and countless enemies before us..."
                    [/message]
                    [message]
                        speaker=Lethalia
                        message=_"Efraim has never been so wild and romantic, not even earlier in his life when we first met. Aaah, I know how you must feel, Lilith..."
                    [/message]
                    [message]
                        speaker=Lilith
                        message= _ "How do I feel? I am merely amused. He is so ridiculous at times. I doubt he is even serious, he is on Uria's side. He might just join us to spy for a while and leave then, he is loyal to nobody. Be careful about this one. Do not let his speech misdirect you from his true intentions."
                    [/message]
                    [message]
                        speaker=Efraim
                        message=_"Uria is clearly missing you, Lilith, she even needed a replacement. Not a good one, as far as I can tell."
                    [/message]
                    [message]
                        speaker=Romero
                        message=_"Not a good one? I should have been Uria's left hand instead of that brute Abaddon, but she did not want two lovers to be her two underlings, fearing being overthrown. You slander me, human. All the females are for your eyes only? I will show you about that!"
                    [/message]
                    [message]
                        speaker=Efraim
                        message=_"I was never fond of Lilith, she is just my ally because of necessity. To be honest, I hate her, and she knows about that."
                    [/message]
                    [message]
                        speaker=Romero
                        message=_"I challenge you to a duel to death! The winner gets both Lethalia and Lilith!"
                    [/message]
                    [message]
                        speaker=Lethalia
                        message=_"So this damned demon is interested also in me? This is getting dangerous."
                    [/message]
                    [event]
                        name=die
                        [filter]
                            id=Lilith
                        [/filter]
                        [message]
                            speaker=Romero
                            message=_"Darn, I never wanted this to happen... It is your fault, Efraim!"
                        [/message]
                    [/event]
                    {VARIABLE quests.met_romero 1}
                [/event]
            [/else]
        [/if]
        [if]
            [variable]
                name=quests.met_romero
                equals=1
            [/variable]
            [then]
                [event]
                    name=romero chat
                    [message]
                        speaker=Romero
                        message= _ "Oh, beautiful Lilith, now I see you again. I wrote a poem about you, out of my purest love."
                    [/message]
                    [message]
                        speaker=Lilith
                        message=_"Whatever it is, I am not interested. To be honest, you are one of those few I do not hate, but that does not mean that I have any positive feelings about you!"
                    [/message]
                    [message]
                        speaker=Romero
                        message=_"She agreed that she is interested in another!"
                    [/message]
                    [message]
                        speaker=Lilith
                        message=_"You must have misheard, I just said that I hate everyone, even Efraim, Lethalia, Titucius, Obtharath,..."
                    [/message]
                    [message]
                        speaker=Romero
                        message= _ "Love and hate are sometimes the same, thus you love him! Efraim must pay for cheating me!"
                    [/message]
                    [message]
                        speaker=Efraim
                        message=_"Will a hundred of gold pieces suffice? Will you stop showing your dumb face around and go to hell? Wait, you are already in hell, go to some other parts of hell!"
                    [/message]
                    [message]
                        speaker=Lethalia_evil
                        message=_"I might add twenty more, I have kept some to buy a new scarf."
                    [/message]
                    [message]
                        speaker=Romero
                        message= _ "This insult can be only repaid in blood! You have even openly admitted..."
                    [/message]
                    [message]
                        speaker=Lilith
                        message=_"No, he did not. We hate each other and would prefer to drink poison if we had to say kind words to each other."
                    [/message]
                    [message]
                        speaker=Efraim
                        message=_"Torture is better than anything love-related with Lilith."
                    [/message]
                    [message]
                        speaker=Romero
                        message= _ "So you are in love! Last time I did not win our duel, but this time, I will win, because you insulted me much more than before!"
                    [/message]
                    [message]
                        speaker=Lilith
                        message=_"I will fall in love with Uria next time, I guarantee you that! And I will see if you will attack Uria for it."
                    [/message]
                    {VARIABLE quests.met_romero 2}
                [/event]
                [event]
                    name=die
                    [filter]
                        id=Lilith
                    [/filter]
                    [message]
                        speaker=Romero
                        message=_"Darn, I never wanted this to happen... It is your fault, Efraim!"
                    [/message]
                [/event]
            [/then]
        [/if]
        [if]
            [variable]
                name=quests.met_romero
                equals=2
            [/variable]
            [then]
                [event]
                    name=romero chat
                    [message]
                        speaker=Romero
                        message= _ "So we meet again. Lilith, so close to Efraim, my arch enemy, I am starting to fear that I will never forgive you, despite all the beautiful vices you have that keep attracting me. I have torn my poem into pieces, so that it will never be read..."
                    [/message]
                    [message]
                        speaker=Lilith
                        message=_"You have torn it up? Good, I always wished for it to be destroyed. Now, you will not read it before me, romantic fool."
                    [/message]
                    [message]
                        speaker=Romero
                        message=_"Keep denying our love, you will return to me soon... anyway, for now, since you and Efraim are..."
                    [/message]
                    [message]
                        speaker=Efraim
                        message=_"...enemies loathing each other..."
                    [/message]
                    [message]
                        speaker=Romero
                        message= _ "Lethalia is free now. Lethalia, what do you say about getting revenge upon Efraim and his interest in Lilith?"
                    [/message]
                    [if]
                        [have_unit]
                            id=Lethalia_evil
                        [/have_unit]
                        [then]
                            [message]
                                speaker=Lethalia_evil
                                message=_"Considering the fact that Efraim scorns me almost as much as my copy does, I have no idea how we could take revenge on Efraim together."
                            [/message]
                            [message]
                                speaker=Romero
                                message=_"He scorns you? I thought he just made two copies of the same wife to make his life happier..."
                            [/message]
                            [message]
                                speaker=Efraim
                                message=_"You are insane. I care not, you can do whatever you want with her as long as it does not harm us and does not help Uria."
                            [/message]
                            [message]
                                speaker=Lethalia_evil
                                message=_"But I would have no gain from that. Furthermore, Romero is a fool and he is only ridiculous. He looks handsome, though."
                            [/message]
                            [message]
                                speaker=Lilith
                                message=_"Romero, you cannot see that you are only a funny nuisance we need to get rid of? You are nothing else than an ulcer."
                            [/message]
                        [/then]
                        [else]
                            [message]
                                speaker=Lethalia
                                message=_"Considering the fact that I hate all demons equally, just like Efraim, I can only ask you to show your love for me by going away and never returning."
                            [/message]
                        [/else]
                    [/if]
                    [message]
                        speaker=Romero
                        message=_"So you refuse me, Lethalia? How dare you! I will kill your Efraim and you will change your mind..."
                    [/message]
                    {VARIABLE quests.met_romero 3}
                [/event]
                [event]
                    name=die
                    [filter]
                        id=Lethalia
                        [or]
                            id=Lethalia_evil
                        [/or]
                        [or]
                            id=Lilith
                        [/or]
                    [/filter]
                    [message]
                        speaker=Romero
                        message=_"Darn, I never wanted this to happen... It is your fault, Efraim!"
                    [/message]
                [/event]
            [/then]
        [/if]
        [if]
            [variable]
                name=quests.met_romero
                equals=3
            [/variable]
            [then]
                [event]
                    name=romero chat
                    [if]
                        [have_unit]
                            id=Lethalia_evil
                        [/have_unit]
                        [then]
                            [message]
                                speaker=Romero
                                message= _ "Oh, Lilith, my cold-hearted amourist! Oh, Lethalias the gruesome twosome! And Efraim the obnoxious trifler who keeps stealing my lovers..."
                            [/message]
                        [/then]
                        [else]
                            [message]
                                speaker=Romero
                                message= _ "Oh, Lilith, my cold-hearted amourist! Oh, Lethalia the gruesome butcher! And Efraim the obnoxious trifler who keeps stealing my lovers..."
                            [/message]
                        [/else]
                    [/if]
                    [message]
                        speaker=Lilith
                        message=_"I have never been your lover!"
                    [/message]
                    [message]
                        speaker=Lethalia_evil
                        message=_"Me neither! You are too ridiculous!"
                    [/message]
                    [message]
                        speaker=Lethalia
                        message=_"Me neither!"
                    [/message]
                    [message]
                        speaker=Romero
                        message=_"Efraim the manipulator, what have you done to me? Why are you taking all the females, you thief?"
                    [/message]
                    [message]
                        speaker=Efraim
                        message=_"Well, call them <i>women</i> instead of <i>females</i>, that might be a good beginning..."
                    [/message]
                    [message]
                        speaker=Lilith
                        message=_"He is not a fool like you. But that does not make me like him, he ruined my plans to become a goddess once!"
                    [/message]
                    [message]
                        speaker=Romero
                        message= _ "Lilith, you are irredeemably doomed..."
                    [/message]
                    [if]
                        [have_unit]
                            id=Lethalia_evil
                        [/have_unit]
                        [then]
                            [message]
                                speaker=Lethalia_evil
                                message=_"This starts pretty bad for me... He will not understand that I was in love with Makhmud before the invasion happened and my beloved escaped somewhere out of my reach."
                            [/message]
                            [message]
                                speaker=Romero
                                message=_"Beautiful and fierce Lethalia, you are the most perfect specimen of female I have ever seen..."
                            [/message]
                            [message]
                                speaker=Efraim
                                message=_"Yes, keep dehumanising them, that will surely make somebody love you..."
                            [/message]
                            [message]
                                speaker=Lethalia_evil
                                message=_"Makhmud, my love, where are you? Please, be here and help me from this fool!"
                            [/message]
                            [message]
                                speaker=Romero
                                message=_"So you love another? And you think that he will return to you once? I will kill this Makhmud, Efraim or whatever other names he has..."
                            [/message]
                        [/then]
                        [else]
                            [message]
                                speaker=Lethalia
                                message=_"Now he will start spouting his honeyed words again. KILL YOURSELF, ROMERO, IT IS THE ONLY WAY YOU CAN MAKE ME HAPPY!"
                            [/message]
                            [message]
                                speaker=Romero
                                message=_"So you love another? I will kill this Efraim of yours..."
                            [/message]
                        [/else]
                    [/if]
                    {VARIABLE quests.met_romero 5}
                [/event]
                [event]
                    name=die
                    [filter]
                        id=Lethalia
                        [or]
                            id=Lethalia_evil
                        [/or]
                        [or]
                            id=Lilith
                        [/or]
                    [/filter]
                    [message]
                        speaker=Romero
                        message=_"Darn, I never wanted this to happen... It is your fault, Efraim!"
                    [/message]
                [/event]
            [/then]
        [/if]
        {INFERNO_LEADER_ONLY_SOMETIMES "lilith chat" Lilith Lilith}
        {INFERNO_LEADER_ONLY_SOMETIMES "abaddon chat" Abaddon Abaddon}
        {INFERNO_LEADER_ONLY_SOMETIMES "uria avatar chat" Uria Uria_avatar}
        {INFERNO_LEADER_ONLY_SOMETIMES "romero chat" Romero Romero}
        [if]
            [variable]
                name=quests.talked_to_high_demon
                greater_than=0
            [/variable]
            [else]
                [event]
                    name=attack
                    [filter_second]
                        type=Demon Despot
                    [/filter_second]
                    [message]
                        speaker=unit
                        message= _ "Tell me, how can we get out of this stinking Inferno?"
                    [/message]
                    [message]
                        speaker=second_unit
                        message= _ "I shall never tell anything to you. You deserve to become Burning Souls. It will happen that imps and hellhounds will tear your flesh..."
                    [/message]
                    [message]
                        speaker=Lethalia
                        message= _ "You will suffer unimaginable torture if you will not tell us how to get out of here."
                    [/message]
                    [message]
                        speaker=second_unit
                        message= _ "I have no idea anyway."
                    [/message]
                    [message]
                        speaker=unit
                        message= _ "Focus on it. Try to think. You might figure something out."
                    [/message]
                    [message]
                        speaker=second_unit
                        message= _ "Why should I?"
                    [/message]
                    [message]
                        speaker=Lethalia
                        message= _ "I have promised you terrible pain if you do not reply."
                    [/message]
                    [message]
                        speaker=second_unit
                        message= _ "Go on, I can resist any torture."
                    [/message]
                    {IN_EVENT_TORTURE $second_unit.id}
                    {IN_EVENT_TORTURE $second_unit.id}
                    {IN_EVENT_TORTURE $second_unit.id}
                    [message]
                        speaker=second_unit
                        message= _ "Argh, what the hell are you doing? What dreadful force could have taught you that?"
                    [/message]
                    {IN_EVENT_TORTURE $second_unit.id}
                    [message]
                        speaker=Lethalia
                        message= _ "Speak."
                    [/message]
                    {IN_EVENT_TORTURE $second_unit.id}
                    [message]
                        speaker=second_unit
                        message= _ "Fine, fine, I will speak. There is no way to get out of here, as far as I know. The only entity that might get you home is Yarae the Arcane Lord."
                    [/message]
                    [message]
                        speaker=Efraim
                        message= _ "Yarae the Arcane Lord? Who is that? Where can we find him?"
                    [/message]
                    [message]
                        speaker=second_unit
                        message= _ "He is not in Inferno, but creatures from Inferno can talk to him. This communication is permanently occupied by Uria, the greatest of demons."
                    [/message]
                    [message]
                        speaker=Efraim
                        message= _ "Where can we find Uria?"
                    [/message]
                    [message]
                        speaker=second_unit
                        message= _ "She dwells in her fortress in the city of Pandemonium. But nothing can destroy her, she is immortal. She was reported to be killed many times, but she always returned."
                    [/message]
                    [message]
                        speaker=Efraim
                        message= _ "Where is that city? How can we get there?"
                    [/message]
                    [message]
                        speaker=second_unit
                        message= _ "Because she is very careful and thinks about defence a lot, Pandemonium and surrounding lands are sealed. There are four guardians, hidden in their secret chambers. Together, they can open the seal. If they stop obeying Uria, Uria will kill them, and give that part of the seal to a more trustworthy demon."
                    [/message]
                    [message]
                        speaker=Efraim
                        message= _ "That means that if we kill all these guardians, we will be able to enter Pandemonium? Where are these guardians?"
                    [/message]
                    [message]
                        speaker=second_unit
                        message= _ "I have no idea. Nobody knows it except a few demons who interact with these guardians know who they really are. But I would expect them to be in some distant places, each one far away from all others. And they will eat you anyway if you come to them."
                    [/message]
                    [message]
                        speaker=Efraim
                        message= _ "Well, well, we will now kill you in the standard way, abomination. Thank you for the information."
                    [/message]
                    {VARIABLE quests.talked_to_high_demon 1}
                    {VARIABLE quests.tortured yes}
                    [if]
                        [variable]
                            name=quests.overall
                            equals=1
                        [/variable]
                        [then]
                            {VARIABLE quests.overall 2}
                        [/then]
                    [/if]
                [/event]
            [/else]
        [/if]
        [if]
            [variable]
                name=quests.talked_to_high_demon
                equals=1
            [/variable]
            [then]
                [event]
                    name=attack
                    [filter_second]
                        type=Demon Despot
                    [/filter_second]
                    [message]
                        speaker=unit
                        message= _ "I need reliable information about Inferno. What are its bounds?"
                    [/message]
                    [message]
                        speaker=second_unit
                        message= _ "And why should I tell you that? Because you look so tasty?"
                    [/message]
                    [message]
                        speaker=Lethalia
                        message= _ "Answer or suffer. I have developed a brilliant technique to torture demons."
                    [/message]
                    [message]
                        speaker=second_unit
                        message= _ "I am immune to all sorts of torture, I feel no pain..."
                    [/message]
                    {IN_EVENT_TORTURE $second_unit.id}
                    {IN_EVENT_TORTURE $second_unit.id}
                    {IN_EVENT_TORTURE $second_unit.id}
                    [message]
                        speaker=second_unit
                        message= _ "This... is... impossible to stand..."
                    [/message]
                    {IN_EVENT_TORTURE $second_unit.id}
                    [message]
                        speaker=Lethalia
                        message= _ "Speak."
                    [/message]
                    [message]
                        speaker=second_unit
                        message= _ "Ask."
                    [/message]
                    [message]
                        speaker=Efraim
                        message= _ "How can Inferno look like a plank floating in the emptiness?"
                    [/message]
                    [message]
                        speaker=second_unit
                        message= _ "Inferno was formerly a normal place like the place you used to live in. But when Uria became the Speaker of Yarae's Thoughts, some demons refused to follow her. These heretics were defeated, but remains of their legions were always assembling on remote places. They were like parasites you cannot get rid of. They kept on sabotaging our facilities and killing us with stealth. We separated us, the Faithful ones from the heretics by the Barrier of Void."
                    [/message]
                    [message]
                        speaker=Efraim
                        message= _ "So there are also good demons? Friendly to mankind?"
                    [/message]
                    [message]
                        speaker=second_unit
                        message= _ "They are not your friends, the fact that they are enemies of Uria, our enemies, does not make them your friends. And they are weak and pathetic, because after the creation of the Barrier of Void, a monumental work of Uria's magic, Uria found a way to make us stronger. The Barrier prevented them from getting this power, and therefore they are weak."
                    [/message]
                    [message]
                        speaker=Efraim
                        message= _ "Is there a way to get to them?"
                    [/message]
                    [message]
                        speaker=second_unit
                        message= _ "Uria controls who goes there. From the Grim Port, ships with special permissions may float there, but the Barrier will not let you through it without Uria's direct allowance, it was made to avoid penetrations by methods of stealth. These sly pests keep finding new and new flaws in the Barrier and penetrating, there has been a larger penetration lately, but as usual, it was easy to handle."
                    [/message]
                    [message]
                        speaker=Efraim
                        message= _ "This is bad... we will kill you now, I am too disgusted from talking to such abomination as you are."
                    [/message]
                    {VARIABLE quests.talked_to_high_demon 2}
                [/event]
            [/then]
        [/if]
        [if]
            [variable]
                name=quests.talked_to_high_demon
                equals=2
            [/variable]
            [then]
                [event]
                    name=attack
                    [filter_second]
                        type=Demon Despot
                    [/filter_second]
                    [message]
                        speaker=unit
                        message= _ "Provide us some information or we will torture you."
                    [/message]
                    [message]
                        speaker=second_unit
                        message= _ "I am not afraid of any torture."
                    [/message]
                    [message]
                        speaker=Lethalia
                        message= _ "Suffer, then."
                    [/message]
                    {IN_EVENT_TORTURE $second_unit.id}
                    {IN_EVENT_TORTURE $second_unit.id}
                    {IN_EVENT_TORTURE $second_unit.id}
                    [message]
                        speaker=second_unit
                        message= _ "Damn you..."
                    [/message]
                    {IN_EVENT_TORTURE $second_unit.id}
                    [message]
                        speaker=second_unit
                        message= _ "Ask. I will answer."
                    [/message]
                    [message]
                        speaker=Efraim
                        message= _ "What are the weaknesses of Uria? What is the source of her power?"
                    [/message]
                    [message]
                        speaker=second_unit
                        message= _ "Uria controls some powers that allow her to create almost anything. She also altered herself to be as powerful as she could. So if she is aware of a certain weak spot on her, she fixes it as soon as possible. That is why she returned from the dead several times in the past. Hahaha, you will die!"
                    [/message]
                    [message]
                        speaker=Efraim
                        message= _ "How much raw power does she have? What is the source of her power?"
                    [/message]
                    [message]
                        speaker=second_unit
                        message= _ "She has great reserves of raw power. Defeating her would require armies of mages and warriors. The power she wields was given to her from Yarae, whose power is superior to gods."
                    [/message]
                    [message]
                        speaker=Efraim
                        message= _ "Why this Yarae does not help you to take over all worlds?"
                    [/message]
                    [message]
                        speaker=second_unit
                        message= _ "Nobody knows. He is omnipotent, but his ways cannot be understood and his motivations are unknown."
                    [/message]
                    [message]
                        speaker=Efraim
                        message= _ "Do you know about a way to defeat him?"
                    [/message]
                    [message]
                        speaker=second_unit
                        message= _ "Nobody knows much about him. Uria neither."
                    [/message]
                    [message]
                        speaker=Efraim
                        message= _ "Where are the seal guardians located? We need to get to Pandemonium..."
                    [/message]
                    [message]
                        speaker=second_unit
                        message= _ "I shall not tell. So far, I have told you unimportant information you would learn anyway, but you will need much more to break me!"
                    [/message]
                    {IN_EVENT_TORTURE $second_unit.id}
                    [message]
                        speaker=Lethalia
                        message= _ "Suffer!"
                    [/message]
                    {IN_EVENT_TORTURE $second_unit.id}
                    [message]
                        speaker=second_unit
                        message= _ "Arghh.. raawrrr.. grraaa... This is terrible. But I can handle it! Carry on, you will get nothing from me!"
                    [/message]
                    {IN_EVENT_TORTURE $second_unit.id}
                    {IN_EVENT_TORTURE $second_unit.id}
                    [message]
                        speaker=second_unit
                        message= _ "RROOAARRRR! I WILL KILL YOU ALL, MINIONS, BRING THIS SCUM TO ME! RRRAAAWR!"
                    [/message]
                    {IN_EVENT_TORTURE $second_unit.id}
                    [message]
                        speaker=Lethalia
                        message= _ "He went mad. Furious lunacy makes demons immune to this spell. That is all the information we can get."
                    [/message]
                    {VARIABLE quests.talked_to_high_demon 3}
                [/event]
            [/then]
        [/if]
        [if]
            [variable]
                name=quests.talked_to_high_demon
                equals=3
            [/variable]
            [then]
                [if]
                    [variable]
                        name=quests.nw_lord_chat_outside
                        equals=yes
                    [/variable]
                    [then]
                        {VARIABLE quests.talked_to_high_demon 4}
                    [/then]
                    [else]
                        [event]
                            name=attack
                            [filter_second]
                                type=Demon Despot
                            [/filter_second]
                            [message]
                                speaker=unit
                                message= _ "Where are the seal guardians?"
                            [/message]
                            [message]
                                speaker=second_unit
                                message= _ "I have no idea. Even if I had, I would never tell that."
                            [/message]
                            [message]
                                speaker=Lethalia
                                message= _ "You obviously know it. Tell it to us, or we will torture you. I have mastered a terrible spell that can bend any demon."
                            [/message]
                            [message]
                                speaker=second_unit
                                message= _ "I would like to see that. I feel no pain."
                            [/message]
                            {IN_EVENT_TORTURE $second_unit.id}
                            [message]
                                speaker=second_unit
                                message= _ "I understand. This is truly a terrible thing. If you were a demon, you would have gained a high rank."
                            [/message]
                            [message]
                                speaker=Lethalia
                                message= _ "I am more powerful than a high-ranking demon! Now tell me, where are the seal guardians, or you will feel my wrath!"
                            [/message]
                            [message]
                                speaker=second_unit
                                message= _ "Will do. I am not perfectly sure, but I think I know about one. Living in the northwest of these lands, in Chambers of Oblivion beneath the Island of Atrocity."
                            [/message]
                            [message]
                                speaker=Efraim
                                message= _ "Finally."
                            [/message]
                            [message]
                                speaker=second_unit
                                message= _ "Now, when I have helped you so nicely, can I have a reward?"
                            [/message]
                            [message]
                                speaker=Lethalia
                                message= _ "Never! Flee into your stinking hole or we will kill you!"
                            [/message]
                            [message]
                                speaker=second_unit
                                message= _ "I want to kill you. I am not an imp, I do not tend to flee from battle!"
                            [/message]
                            {VARIABLE background "$story_map_old.background|~BLIT(maps/hell/25_Chambers_of_Oblivion.png~CS(-50,-50,40))"}
                            {VARIABLE story_map_old.background $background}
                            {CLEAR_VARIABLE background}
                            {VARIABLE quests.talked_to_high_demon 4}
                            {VARIABLE quests.objectives_comment "
Important locations discovered are marked blue on the map.
The map can be viewed through the right-click menu."}
                        [/event]
                    [/else]
                [/if]
            [/then]
        [/if]
        [if]
            [variable]
                name=quests.talked_to_high_demon
                equals=4
            [/variable]
            [then]
                [if]
                    [variable]
                        name=quests.overall
                        greater_than_equal_to=6
                    [/variable]
                    [then]
                        {VARIABLE quests.talked_to_high_demon 5}
                    [/then]
                    [else]
                        [event]
                            name=attack
                            [filter_second]
                                type=Demon Despot
                            [/filter_second]
                            [message]
                                speaker=unit
                                message= _ "What awaits us in Pandemonium? Speak, foul creature!"
                            [/message]
                            [message]
                                speaker=second_unit
                                message= _ "Why should I, $second_unit.name|, Marauder of Haergoth, Chewer of Dwarvish Guts, the one who defeated the Army of Blackened Minds,..."
                            [/message]
                            [message]
                                speaker=Lethalia
                                message= _ "Silence. You shall obey Lethalia, the ruler emerita of Amaranth, Slayer of Hephaestus, Lich Lady of Arsenius' cave, Vanquisher of the Shadow Empire, Bane of Orcs, Destroyer of Lilith's Servants, Guardian of the World of the Dead, Mass Dragonslayer,..."
                            [/message]
                            [message]
                                speaker=second_unit
                                message= _ "...Slayer of the Three Legged Lamprey, Destroyer of Karakrakian the Pious, Doom of Illiákrar, Deathbringer from the Deep,..."
                            [/message]
                            [message]
                                speaker=Lethalia
                                message= _ "...the Empress emerita of Wesnoth..."
                            [/message]
                            [message]
                                speaker=Efraim
                                message= _ "Enough! Both of you has surely done enough deeds to speak about them for hours. I have done also many of them..."
                            [/message]
                            [message]
                                speaker=Lethalia
                                message= _ "Do not start telling about your successes, this would never really end. Now you, $second_unit.name|, the Chewer of Hargranoth, will tell us what awaits us in Pandemonium, or we will force you to tell it to us."
                            [/message]
                            [message]
                                speaker=second_unit
                                message= _ "Well, well. I am aware that you know to force us demons to reply to your questions in a way that is really unpleasant to us, so I will reply, as I do not feel like experiencing it. Pandemonium was a strong city fortress. But the defences are no longer so strong, because the seal and nearby fortresses are protecting it well enough."
                            [/message]
                            [message]
                                speaker=Lethalia
                                message= _ "I can recognise lies. You are lying to me. I will not tolerate this!"
                            [/message]
                            {IN_EVENT_TORTURE $second_unit.id}
                            {IN_EVENT_TORTURE $second_unit.id}
                            [message]
                                speaker=second_unit
                                message= _ "Argh, your legendary torture is really mind-boiling..."
                            [/message]
                            {IN_EVENT_TORTURE $second_unit.id}
                            [message]
                                speaker=second_unit
                                message= _ "Stop. I will speak truth now. What awaits you there, is the Legion of the Damned."
                            [/message]
                            [message]
                                speaker=Efraim
                                message= _ "What are they?"
                            [/message]
                            [message]
                                speaker=second_unit
                                message= _ "The Burning Souls. Countless Burning Souls are imprisoned in the city of Pandemonium for the pleasure of all inhabitants. They also have a good military potential, it just needs some demon overseers that would coordinate the attack. Once you break the seal and approach the city, you will be decimated by the Legion of the Damned, hahahahahaha!"
                            [/message]
                            [message]
                                speaker=Efraim
                                message= _ "Are there any alternate ways to get there without encountering them?"
                            [/message]
                            [message]
                                speaker=second_unit
                                message= _ "Sure, they do not expect many attacks from Filthy Keep."
                            [/message]
                            [message]
                                speaker=Efraim
                                message= _ "Why?"
                            [/message]
                            [message]
                                speaker=second_unit
                                message= _ "Because... they do not expect being attacked at all. If you manage to pass into Pandemonium without raising alarm, they will not attack."
                            [/message]
                            [message]
                                speaker=Efraim
                                message= _ "You have just tried to lie to me. Also, you are trying to suggest us to attack with the whole damned Legion of the Damned behind our backs, preparing to attack us from behind. We will kill you, demon."
                            [/message]
                            {VARIABLE quests.talked_to_high_demon 5}
                            {VARIABLE quests.lie_detection 1}
                        [/event]
                    [/else]
                [/if]
            [/then]
        [/if]
        [if]
            [variable]
                name=quests.talked_to_high_demon
                equals=5
            [/variable]
            [then]
                [if]
                    [variable]
                        name=quests.se_lord_chat_outside
                        equals=yes
                    [/variable]
                    [then]
                        {VARIABLE quests.talked_to_high_demon 6}
                    [/then]
                    [else]
                        [event]
                            name=attack
                            [filter_second]
                                type=Demon Despot
                            [/filter_second]
                            [message]
                                speaker=unit
                                message= _ "Where do the seal guardians hide?"
                            [/message]
                            [message]
                                speaker=second_unit
                                message= _ "You are longing to learn that, heh? What bad luck that you will never learn."
                            [/message]
                            [message]
                                speaker=Lethalia
                                message= _ "I will teach you to stop mocking. If we need information, you will provide, since you obviously know it. And it is also <i>your</i> intention to make us leave Inferno, because the sooner we leave, the less havoc we will cause here."
                            [/message]
                            [message]
                                speaker=second_unit
                                message= _ "You are not getting it right. You are a prey, a trophy. The power of your souls is priceless, and most demons are dying to kill and enslave you. Do you know why we never united letting you get this far? Because everybody wanted to get you first. It is only our rivalry that is keeping you alive. And so I never intended to help you leave our stinky home. Heh heh."
                            [/message]
                            [message]
                                speaker=Lethalia
                                message= _ "So be it. I will get this information from you using less friendly methods."
                            [/message]
                            {IN_EVENT_TORTURE $second_unit.id}
                            [message]
                                speaker=second_unit
                                message= _ "Ehm, maybe... well, that thing wanders around... someplace..."
                            [/message]
                            [message]
                                speaker=second_unit
                                message= _ "A flash of remembering? That is all you have?"
                            [/message]
                            {IN_EVENT_TORTURE $second_unit.id}
                            {IN_EVENT_TORTURE $second_unit.id}
                            {IN_EVENT_TORTURE $second_unit.id}
                            [message]
                                speaker=Lethalia
                                message= _ "Do you still like it?"
                            [/message]
                            {IN_EVENT_TORTURE $second_unit.id}
                            {IN_EVENT_TORTURE $second_unit.id}
                            [message]
                                speaker=second_unit
                                message= _ "Enough..."
                            [/message]
                            [message]
                                speaker=Efraim
                                message= _ "Finally."
                            [/message]
                            [message]
                                speaker=Lethalia
                                message= _ "Where are the guardians?"
                            [/message]
                            [message]
                                speaker=second_unit
                                message= _ "In Stygian Caverns, below the Grim Port by the Shores of Abyss."
                            [/message]
                            [message]
                                speaker=Lethalia
                                message= _ "Nobody can resist me, you see."
                            [/message]
                            [message]
                                speaker=second_unit
                                message= _ "Let the fight carry on, I will kill you before you get anywhere!"
                            [/message]
                            {VARIABLE background "$story_map_old.background|~BLIT(maps/hell/05_Stygian_Caverns.png~CS(-50,-50,40))"}
                            {VARIABLE story_map_old.background $background}
                            {CLEAR_VARIABLE background}
                            {VARIABLE quests.talked_to_high_demon 6}
                            {VARIABLE quests.objectives_comment _"
Important locations discovered are marked blue on the map.
The map can be viewed through the right-click menu."}
                        [/event]
                    [/else]
                [/if]
            [/then]
        [/if]
        [if]
            [variable]
                name=quests.talked_to_high_demon
                equals=6
            [/variable]
            [then]
                [event]
                    name=attack
                    [filter_second]
                        type=Demon Despot
                    [/filter_second]
                    [message]
                        speaker=unit
                        message= _ "We will ask now. You will reply."
                    [/message]
                    [message]
                        speaker=second_unit
                        message= _ "I am not getting it. Why should I reply?"
                    [/message]
                    [message]
                        speaker=Lethalia
                        message= _ "Because I want you to. And I really enjoy torturing demons who do not do as I want."
                    [/message]
                    {IN_EVENT_TORTURE $second_unit.id}
                    {IN_EVENT_TORTURE $second_unit.id}
                    [message]
                        speaker=second_unit
                        message= _ "You will ask. I will answer."
                    [/message]
                    [message]
                        speaker=Efraim
                        message= _ "Are there some hidden artefacts of power you know about, demon?"
                    [/message]
                    [message]
                        speaker=second_unit
                        message= _ "There were some, but they were recently taken and our armies were geared with them. You must have found some of them on slain demons and our meatshields."
                    [/message]
                    [message]
                        speaker=Efraim
                        message= _ "Is that all you have?"
                    [/message]
                    {IN_EVENT_TORTURE $second_unit.id}
                    [message]
                        speaker=second_unit
                        message= _ "I am not lying! We wield the power ourselves, we have little need for artefacts to amplify our power like you, puny creatures."
                    [/message]
                    [message]
                        speaker=Efraim
                        message= _ "What a pity. Let us kill him, talking to demons makes me feel really bad."
                    [/message]
                    {VARIABLE quests.talked_to_high_demon 7}
                [/event]
            [/then]
        [/if]
        [if]
            [variable]
                name=quests.talked_to_high_demon
                equals=7
            [/variable]
            [then]
                [if]
                    [variable]
                        name=quests.sw_lord_chat_outside
                        equals=yes
                    [/variable]
                    [then]
                        {VARIABLE quests.talked_to_high_demon 8}
                    [/then]
                    [else]
                        [event]
                            name=attack
                            [filter_second]
                                type=Demon Despot
                            [/filter_second]
                            [message]
                                speaker=unit
                                message= _ "Where can we find the seal guardians?"
                            [/message]
                            [message]
                                speaker=second_unit
                                message= _ "I have heard of you. You like using torture. But it is hopeless for you, I know nothing of them."
                            [/message]
                            [message]
                                speaker=Lethalia
                                message= _ "You are not telling us the truth."
                            [/message]
                            [message]
                                speaker=Efraim
                                message= _ "Be careful with her, she can feel the lies."
                            [/message]
                            [message]
                                speaker=second_unit
                                message= _ "Then... I know about one. He dwells deep underground under a well protected place..."
                            [/message]
                            [message]
                                speaker=Lethalia
                                message= _ "Where is it exactly?"
                            [/message]
                            [message]
                                speaker=second_unit
                                message= _ "In the underground under the Fortress of Blackened Dreams, southwest from Infernal Narrows."
                            [/message]
                            [message]
                                speaker=second_unit
                                message= _ "You will not keep gaining information from me like this! You will die!"
                            [/message]
                            {VARIABLE background "$story_map_old.background|~BLIT(maps/hell/10_Fortress_of_Blackened_Dreams.png~CS(-50,-50,40))"}
                            {VARIABLE story_map_old.background $background}
                            {CLEAR_VARIABLE background}
                            {VARIABLE quests.talked_to_high_demon 8}
                            {VARIABLE quests.objectives_comment "
Important locations discovered are marked blue on the map.
The map can be viewed through the right-click menu."}
                        [/event]
                    [/else]
                [/if]
            [/then]
        [/if]
        [if]
            [variable]
                name=quests.talked_to_high_demon
                equals=8
            [/variable]
            [then]
                [event]
                    name=attack
                    [filter_second]
                        type=Demon Despot
                    [/filter_second]
                    [message]
                        speaker=unit
                        message= _ "Who is this Yarae some of you mentioned before?"
                    [/message]
                    [message]
                        speaker=second_unit
                        message= _ "Yarae the Arcane Lord is a unique being."
                    [/message]
                    [message]
                        speaker=Lethalia
                        message= _ "What is he like?"
                    [/message]
                    [message]
                        speaker=second_unit
                        message= _ "He is superior to gods. He needs no believers, no worshippers, no clerics. Yet he can kill or create gods. Create and destroy worlds. The life of a mortal is to him the same as the life of a sand flea to you. The life of a sand flea living somewhere far away from you."
                    [/message]
                    [message]
                        speaker=Efraim
                        message= _ "If he is so powerful, why is he letting you struggle with us instead of killing us instantly?"
                    [/message]
                    [message]
                        speaker=second_unit
                        message= _ "His motivations are not understandable. Whatever he does is a divine will. Maybe it is a test for us."
                    [/message]
                    [message]
                        speaker=Efraim
                        message= _ "What is even the purpose of his existence? Does he have some rivals?"
                    [/message]
                    [message]
                        speaker=second_unit
                        message= _ "I have never heard of any. It is said that he created all gods, all worlds and all nations for us to slaughter. We are his chosen ones. We will develop into much greater beings after that we destroy all the others."
                    [/message]
                    [message]
                        speaker=Efraim
                        message= _ "How can we defeat him?"
                    [/message]
                    [message]
                        speaker=second_unit
                        message= _ "There is no way. He can change anything he wants, so he can become immortal anytime he chooses to, his fireballs can be ten times as hot if he decides so."
                    [/message]
                    [message]
                        speaker=Efraim
                        message= _ "I was told he was sealed here with you. Your theories might be wrong."
                    [/message]
                    [message]
                        speaker=second_unit
                        message= _ "No. No. He was never sealed, he was just pretending it, this seal was rather shielding him from disturbance."
                    [/message]
                    [message]
                        speaker=Lethalia
                        message= _ "He cannot make himself indisturbable?"
                    [/message]
                    [message]
                        speaker=second_unit
                        message= _ "Die, heretic!"
                    [/message]
                    {VARIABLE quests.talked_to_high_demon 9}
                [/event]
            [/then]
        [/if]
        [if]
            [variable]
                name=quests.talked_to_high_demon
                equals=9
            [/variable]
            [then]
                [if]
                    [variable]
                        name=quests.ne_lord_chat_outside
                        equals=yes
                    [/variable]
                    [then]
                        {VARIABLE quests.talked_to_high_demon 10}
                    [/then]
                    [else]
                        [event]
                            name=attack
                            [filter_second]
                                type=Demon Despot
                            [/filter_second]
                            [message]
                                speaker=unit
                                message= _ "Where can we find the last seal guardian?"
                            [/message]
                            [message]
                                speaker=second_unit
                                message= _ "Last seal guardian? You have found all the rest of them? Hehe, after all this effort, you will never find the last one. Hahahahaaaa."
                            [/message]
                            [message]
                                speaker=Lethalia
                                message= _ "Where is he?!"
                            [/message]
                            [message]
                                speaker=second_unit
                                message= _ "Are you sure with that <i>he</i>? It can be also a demoness. You will never learn. What a shame..."
                            [/message]
                            [message]
                                speaker=Efraim
                                message= _ "Where is that cursed seal guardian?!"
                            [/message]
                            [message]
                                speaker=second_unit
                                message= _ "In the underground under the Fortress of Blackened Dreams, southwest from Infernal Narrows."
                            [/message]
                            [message]
                                speaker=Efraim
                                message= _ "You must know that we already know about that!"
                            [/message]
                            [message]
                                speaker=second_unit
                                message= _ "Sure, find the next one below the Grim Port..."
                            [/message]
                            [message]
                                speaker=Efraim
                                message= _ "We know about that one too! Where is the one we do not know about!"
                            [/message]
                            [message]
                                speaker=second_unit
                                message= _ "Inside the Tormentor's Burrow, under the Unholy Realm, near the Land of Misery, on the far northeast... heh heh... heh?"
                            [/message]
                            [message]
                                speaker=Efraim
                                message= _ "Yes, that is the one, thank you for the information."
                            [/message]
                            [message]
                                speaker=second_unit
                                message= _ "Damn your souls into the deepest depths of Abyss! I thought you already knew of that one too!"
                            [/message]
                            [message]
                                speaker=Lethalia
                                message= _ "Hahaha, Efraim's gimmicks are good!"
                            [/message]
                            [message]
                                speaker=second_unit
                                message= _ "I WILL KILL YOU!"
                            [/message]
                            {VARIABLE background "$story_map_old.background|~BLIT(maps/hell/21_Tormentors_Burrow.png~CS(-50,-50,40))"}
                            {VARIABLE story_map_old.background $background}
                            {CLEAR_VARIABLE background}
                            {VARIABLE quests.talked_to_high_demon 10}
                            {VARIABLE quests.objectives_comment "
Important locations discovered are marked blue on the map.
The map can be viewed through the right-click menu."}
                        [/event]
                    [/else]
                [/if]
            [/then]
        [/if]
        [if]
            [variable]
                name=quests.tortured
                equals=yes
            [/variable]
            [not]
                [variable]
                    name=quests.talked_about_torture
                    equals=yes
                [/variable]
            [/not]
            [then]
                [event]
                    name=turn refresh
                    [message]
                        speaker=Efraim
                        message= _ "By the way, where did you learn to torture these demons so terribly?"
                    [/message]
                    [message]
                        speaker=Lethalia
                        message= _ "Well, I expected we will need to gather some information from these demons. So I thought what might force these creatures into obedience. They probably cannot feel physical pain, any help of them is impossible and they care only a little about their comrades. The only way that seemed to be possible was to make them feel the pain through empathy. So I forged together the spell of remembering and the spell of empathy, that are usually used for communication and analysis, and are not offensive spells."
                    [/message]
                    [message]
                        speaker=Lethalia
                        message= _ "Because they are not expecting us to use non-offensive spells on them, they are not very likely to resist it. This makes them remember all the foul deeds they have done and feel the pain their victims felt. They suddenly remember and all the Burning Souls they watched burn, all the humans they chewed, all the lesser demons they mistreated, and feel what they felt. First test subjects I caught and experimented on near Krapul were completely unable to do anything, lost their sanity and died within minutes."
                    [/message]
                    [message]
                        speaker=Lethalia
                        message= _ "It is quite useless on battlefield though, because the ferocious anger most creatures feel in battle almost negates it."
                    [/message]
                    [message]
                        speaker=Efraim
                        message= _ "Interesting. Killed by empathy. This might be the best weapon against all evil."
                    [/message]
                    [message]
                        speaker=Lethalia
                        message= _ "It is also good that you will not accidentally torture an innocent being. It would not have much effect on you or me..."
                    [/message]
                    [message]
                        speaker=Efraim
                        message= _ "You or me? Can you remember what have we done? You know that only large amounts of elvish liquor can help us if we start remembering things we had done when we were undead. Maybe Krux or Vritra might be resistant to it, but they have already killed humans. Evil humans, but they felt pain."
                    [/message]
                    [message]
                        speaker=Lethalia
                        message= _ "Yes... but demons and other nasty mass murdering abominations will be affected much more significantly."
                    [/message]
                    [message]
                        speaker=Efraim
                        message= _ "Yes."
                    [/message]
                    {VARIABLE quests.talked_about_torture yes}
                [/event]
            [/then]
        [/if]
        [if]
            [variable]
                name=quests.steelhive_machines_seen
                equals=1
            [/variable]
            [else]
                [event]
                    name=attack
                    [filter]
                        type=Machine Drone,Machine Welder,Machine Oculus,Machine Sparkgazer,Machine Vector,Machine Vorpal
                    [/filter]
                    [message]
                        speaker=second unit
                        message= _ "What the hell is this thing?"
                    [/message]
                    [fire_event]
                        name=steelhive machines seen
                    [/fire_event]
                [/event]
                [event]
                    name=attack
                    [filter_second]
                        type=Machine Drone,Machine Welder,Machine Oculus,Machine Sparkgazer,Machine Vector,Machine Vorpal
                    [/filter_second]
                    [message]
                        speaker=unit
                        message= _ "What the hell is this thing?"
                    [/message]
                    [fire_event]
                        name=steelhive machines seen
                    [/fire_event]
                [/event]
                [event]
                    name=steelhive machines seen
                    [message]
                        speaker=Lethalia
                        message= _ "It is made of steel, but it is moving. It reminds me the minions of Akula, but these probably were not made of living beings."
                    [/message]
                    [message]
                        speaker=Uria
                        message= _ "These are my new pets. Imps are too weak as a tiring force and I cannot make them stronger because they would be a threat to demons..."
                    [/message]
                    [message]
                        speaker=Lethalia
                        message= _ "Another group of monsters again? I was already quite sure I have discovered all the horrors, then demons appeared, then Burning Souls, then undead demons, what will come next? Wait, those mechanical beasts..."
                    [/message]
                    [message]
                        speaker=Uria
                        message= _ "I wanted to surprise you, my dear."
                    [/message]
                    [message]
                        speaker=Lethalia
                        message= _ "Kill yourself."
                    [/message]
                    [message]
                        speaker=Uria
                        message= _ "Can you remember your adventure during the excavation of Antediluvian tunnels? All these half-mechanical liches that killed so many of your soldiers? Just like Akula, I have found this technology as well. With some help from my good servant Argan, I managed to create such soldiers as well."
                    [/message]
                    [message]
                        speaker=Lethalia
                        message= _ "Argan? He was sometimes a really bad person, but he would never ally himself with a perverted wrench like you."
                    [/message]
                    [message]
                        speaker=Lethalia_evil
                        message= _ "Only with perverted wretches like me."
                    [/message]
                    [message]
                        speaker=Efraim
                        message= _ "It was another Argan. Argan is not a rare name among nobility."
                    [/message]
                    [message]
                        speaker=Uria
                        message= _ "But there was only one Argan who was powerful. He had a greatly powerful soul like you, and inside a mechanical body, he was really strong. He founded a powerful religion, led armies where humans and demons marched together to slaughter innocent children... It was a shame that a former love of his defeated him. But you do not know this, you have been asleep, am I right?"
                    [/message]
                    [message]
                        speaker=Efraim
                        message= _ "She is lying. Trying to destabilise us. She tells whatever she can, just to weaken our determination."
                    [/message]
                    [message]
                        speaker=Uria
                        message= _ "Yes, weakening your determination is also one of the things I seek. But I am telling you truth. I have never lied so far. Now, understand that even if you have defeated so many demons, you cannot defeat the one who made them ten times as strong as they were before. Join me, and I will allow you to return into your own world. And I will even allow you to rule there."
                    [/message]
                    [message]
                        speaker=Uria
                        message= _ "You cannot defeat me. I have upgraded the technology greatly. They are crafted from lifeless iron with extreme precision and mastery, so they are much stronger. And their numbers are sooo large. The steelhive I have built produces them with incredible speed."
                    [/message]
                    [message]
                        speaker=Lethalia
                        message= _ "We will never serve you!"
                    [/message]
                    [message]
                        speaker=Uria
                        message= _ "I will tell something you do not want me to tell. You know what I am speaking about, Lethalia."
                    [/message]
                    [message]
                        speaker=Lethalia
                        message= _ "I do not need to hear another of your lies. And I will never serve you, no matter how many things you say about me. Words cannot kill me. I have been a monster, I have killed thousands of people, created armies of monstrous miscreations, drank the power of darkness with massive gulps..."
                    [/message]
                    [message]
                        speaker=Uria
                        message= _ "Well, then. Efraim, did you know that Lethalia did not tell you the full truth the last time? She concealed the worse part of it."
                    [/message]
                    [message]
                        speaker=Efraim
                        message= _ "Enough! I am not interested in more proofs that you were watching us all the time, from our birth."
                    [/message]
                    {VARIABLE quests.steelhive_machines_seen 1}
                [/event]
            [/else]
        [/if]
        [if]
            [variable]
                name=quests.lie_detection
                equals=1
            [/variable]
            [then]
                [event]
                    name=turn refresh
                    [message]
                        speaker=Efraim
                        message= _ "By the way, where did you detect that the demon lied to you? I thought these demons are beyond the reach of truth spells."
                    [/message]
                    [message]
                        speaker=Lethalia
                        message= _ "It just sounded like a lie. It could not have been so easy. So I decided to tell that the demon was lying and see the reaction. And I noticed the facial expression showing the feeling of failure."
                    [/message]
                    [message]
                        speaker=Efraim
                        message= _ "Clever."
                    [/message]
                    {VARIABLE quests.lie_detection 2}
                [/event]
            [/then]
        [/if]
        [if]
            [variable]
                name=quests.lethalia_lied
                equals=1
            [/variable]
            [then]
                [event]
                    name=turn refresh
                    [message]
                        speaker=Efraim
                        message= _ "Now tell me this secret. Send this information through the interiors of our minds, to make sure Uria will not hear it, although I am quite sure she knows it. I do not really trust you about your secrets. I have given you time to think it over, but it seems you did not change your mind naturally."
                    [/message]
                    [message]
                        speaker=Lethalia
                        message= _ "You usually forget things like that... And I think that it is not a problem if Uria hears it, she must have noticed it. It is rather a good thing, but it might cause unpleasant aftershocks, and it is certainly making our struggle here easier..."
                    [/message]
                    [message]
                        speaker=Efraim
                        message= _ "Can you tell me what this secret is, without these introductions?"
                    [/message]
                    [message]
                        speaker=Lethalia
                        message= _ "Do you think about the exact magical formulae I am using when casting spells?"
                    [/message]
                    [message]
                        speaker=Efraim
                        message= _ "No. You were formerly using spells related to faerie power that were uselessly hard and complicated for a human, and then our ways to shape the details of spells became quite different. After some time, I never really felt like trying to analyse what you were exactly casting, just the nature of the spell. So you use different spells than I expect occasionally, using some whole new level of forbidden knowledge?"
                    [/message]
                    [message]
                        speaker=Lethalia
                        message= _ "Not that bad, you know what type of spell I am casting, or you can learn it far too easily. I would never try to enslave a demon to cast a fireball instead of casting a fireball using my power, and not only because you would notice it. I am not using any kinds of magic that are darker than those you are using. I already know that I can exceed any limits easily in the search for power, and I chose that to decide what is acceptable and what is not, I ask myself if you would use that or not. Necromancy is allowed, demonology not."
                    [/message]
                    [message]
                        speaker=Efraim
                        message= _ "Will you tell me the secret now?"
                    [/message]
                    [message]
                        speaker=Lethalia
                        message= _ "As stubborn as a mule... Remember the gathering at the duke's castle when we learned that our enemies are demons? When we were fighting against an invasion of masked illusions, and the necromancer decided to make all the souls of fallen stay on the battlefield as undead to prevent the demons from turning them into Burning Souls?"
                    [/message]
                    [message]
                        speaker=Efraim
                        message= _ "You used a spell. To make these souls be released right after being captured then. I did not listen to the spell, because I knew what you were about to use. Or I thought I knew."
                    [/message]
                    [message]
                        speaker=Lethalia
                        message= _ "To save power, I used a disease-like, limited effect that spread from one enchanted person to anyone within short distance. I did not realise in time that it probably would not save all soldiers from the terrible fate."
                    [/message]
                    [message]
                        speaker=Efraim
                        message= _ "But the impact of this decision is not as large as Uria indicated. She would have never noticed slightly fewer slaves when so many of them were coming."
                    [/message]
                    [message]
                        speaker=Lethalia
                        message= _ "Well, ahem... I did not think about it initially. After that battle, it continued to spread... First into nearby towns by random travel, than quickly all over the country... It also travelled with our army, enchanting everyone we came across... Meanwhile, the whole population is probably enchanted."
                    [/message]
                    [message]
                        speaker=Efraim
                        message= _ "I am starting to understand. People can no longer become liches without dispelling it first, and realising this would require the death of a lot of necromancers. Also, if you made a mistake, all the world would suffer. But from the other side, demons will turn humans into Burning Souls no more."
                    [/message]
                    [message]
                        speaker=Lethalia
                        message= _ "They will learn to dispel it in the soul sucking process. But it earned us some time to die and rest in peace after that."
                    [/message]
                    [message]
                        speaker=Efraim
                        message= _ "In view of that, one would expect to find Uria to choke with rage, sadly this is not the case. This spell saves countless souls, certainly nothing to make a secret of. You are grimly determined to keep the truth from me, and I am tired to worm it out of you. Let's leave it at that, for now..."
                    [/message]
                    {VARIABLE quests.lethalia_lied 2}
                [/event]
            [/then]
        [/if]
        [if]
            [variable]
                name=quests.seen_blood_rain
                greater_than=0
            [/variable]
            [else]
                [event]
                    name=raining blood
                    [message]
                        speaker=unit
                        message= _ "It is raining blood!"
                    [/message]
                    [message]
                        speaker=Lethalia
                        message= _ "Another way to make our way harder..."
                    [/message]
                    [message]
                        speaker=Efraim
                        message= _ "Whoever is casting this, it takes a lot of time to focus. I suggest that we should keep moving."
                    [/message]
                    [message]
                        speaker=Lethalia
                        message= _ "We might be able to survive it for some time, but it is harmful and sucks all our will to fight the enemy and that can be fatal if enemies are close."
                    [/message]
                    {VARIABLE quests.seen_blood_rain 1}
                [/event]
            [/else]
        [/if]
        [if]
            [variable]
                name=quests.seen_a_demon_lord
                greater_than=0
            [/variable]
            [then]
                [if]
                    [variable]
                        name=quests.seen_a_demon_lord
                        equals=1
                    [/variable]
                    [then]
                        [event]
                            name=turn refresh
                            [message]
                                speaker=Efraim
                                message= _ "I never expected that these demon lords will look so... human."
                            [/message]
                            [message]
                                speaker=Lethalia
                                message= _ "It seems that their shape does not limit their power and they prefer to look good."
                            [/message]
                            [if]
                                [variable]
                                    name=quests.met_uria_avatar
                                    greater_than=0
                                [/variable]
                                [then]
                                    [message]
                                        speaker=Efraim
                                        message= _ "Yes, familiar appearance is the best way to infiltrate and misguide. That might explain why Uria looks so normal."
                                    [/message]
                                [/then]
                                [else]
                                    [message]
                                        speaker=Efraim
                                        message= _ "Yes, familiar appearance is the best way to infiltrate and misguide. I expect that Uria is indistinguishable from the people we are used to see every day."
                                    [/message]
                                [/else]
                            [/if]
                            {VARIABLE quests.seen_a_demon_lord 2}
                        [/event]
                    [/then]
                [/if]
            [/then]
            [else]
                [event]
                    name=attack
                    [filter_second]
                        race=demon lord-loti
                    [/filter_second]
                    {VARIABLE quests.seen_a_demon_lord 1}
                [/event]
            [/else]
        [/if]
        [if]
            [variable]
                name=quests.fought_a_spider_demon
                greater_than=0
            [/variable]
            [else]
                [event]
                    name=attack
                    [filter_second]
                        type=Spider Demon
                    [/filter_second]
                    [message]
                        speaker=unit
                        message= _ "What the hell is this... miscreation?"
                    [/message]
                    [message]
                        speaker=second_unit
                        message= _ "The bringer of your death."
                    [/message]
                    [message]
                        speaker=Lethalia
                        message= _ "Uria seems to have experimented a lot. Fighting these abominations will be complicated."
                    [/message]
                    [message]
                        speaker=second_unit
                        message= _ "You will perish in our belly fangs, pathetic weak creatures."
                    [/message]
                    [message]
                        speaker=unit
                        message= _ "Silence!"
                    [/message]
                    {VARIABLE quests.fought_a_spider_demon 1}
                [/event]
            [/else]
        [/if]
    [/event]
    [event]
        name=go to location
        [if]
            [variable]
                name=map_locations.area[$to_location].no_map
                equals=yes
            [/variable]
            [else]
                [if]
                    [variable]
                        name=story_map_old.background
                        contains=$map_locations.area[$to_location].id
                    [/variable]
                    [else]
                        {VARIABLE background "$story_map_old.background|~BLIT(maps/hell/$map_locations.area[$to_location].id|.png)"}
                        {VARIABLE story_map_old.background $background}
                        {CLEAR_VARIABLE background}
                    [/else]
                [/if]
            [/else]
        [/if]
        [if]
            [variable]
                name=map_locations.area[$to_location].outside_map
                equals=yes
            [/variable]
            [else]
                {VARIABLE original_x $map_locations.area[$last_scenario].x}
                {VARIABLE original_y $map_locations.area[$last_scenario].y}
                {VARIABLE final_x $map_locations.area[$to_location].x}
                {VARIABLE final_y $map_locations.area[$to_location].y}
                [set_variables]
                    name=story_map_new
                    to_variable=story_map_old
                    mode=replace
                [/set_variables]
                {VARIABLE distance "$($original_y - $final_y)"}	#Shame that there is no square root and coding its calculation in WML would be slow
                {VARIABLE distance_y "$($original_x - $final_x)"}
                [if]
                    [variable]
                        name=distance
                        less_than=0
                    [/variable]
                    [then]
                        {VARIABLE_OP distance multiply "-1"}
                    [/then]
                [/if]
                [if]
                    [variable]
                        name=distance_y
                        less_than=0
                    [/variable]
                    [then]
                        {VARIABLE_OP distance_y multiply "-1"}
                    [/then]
                [/if]
                {VARIABLE_OP distance add $distance_y}
                [if]
                    [variable]
                        name=distance
                        greater_than=30
                    [/variable]
                    [and]
                        [variable]
                            name=distance
                            less_than_equal_to=60
                        [/variable]
                    [/and]
                    [then]
                        {VARIABLE step_x "$($($final_x - $original_x)/2)"}
                        {VARIABLE step_y "$($($final_y - $original_y)/2)"}
                        {VARIABLE_OP original_x add $step_x}
                        {VARIABLE_OP original_y add $step_y}
                        [set_variables]
                            name=story_map_old.image[$story_map_old.image.length]
                            [value]
                                file="misc/dot-white.png"
                                x,y=$original_x,$original_y
                            [/value]
                        [/set_variables]
                        [set_variables]
                            name=story_map_new.image[$story_map_old.image.length]
                            [value]
                                file="misc/new-journey.png"
                                x,y=$original_x,$original_y
                                delay=500
                            [/value]
                        [/set_variables]
                    [/then]
                [/if]
                [if]
                    [variable]
                        name=distance
                        greater_than=60
                    [/variable]
                    [then]
                        {VARIABLE step_x "$($($final_x - $original_x)/3)"}
                        {VARIABLE step_y "$($($final_y - $original_y)/3)"}
                        {VARIABLE_OP original_x add $step_x}
                        {VARIABLE_OP original_y add $step_y}
                        [set_variables]
                            name=story_map_old.image[$story_map_old.image.length]
                            [value]
                                file="misc/dot-white.png"
                                x,y=$original_x,$original_y
                            [/value]
                        [/set_variables]
                        [set_variables]
                            name=story_map_new.image[$story_map_old.image.length]
                            [value]
                                file="misc/new-journey.png"
                                x,y=$original_x,$original_y
                                delay=500
                            [/value]
                        [/set_variables]
                        {VARIABLE_OP original_x add $step_x}
                        {VARIABLE_OP original_y add $step_y}
                        [set_variables]
                            name=story_map_old.image[$story_map_old.image.length]
                            [value]
                                file="misc/dot-white.png"
                                x,y=$original_x,$original_y
                            [/value]
                        [/set_variables]
                        [set_variables]
                            name=story_map_new.image[$story_map_old.image.length]
                            [value]
                                file="misc/new-journey.png"
                                x,y=$original_x,$original_y
                                delay=500
                            [/value]
                        [/set_variables]
                    [/then]
                [/if]

                [set_variables]
                    name=story_map_old.image[$story_map_old.image.length]
                    [value]
                        file="misc/cross-white.png"
                        x,y=$final_x,$final_y
                    [/value]
                [/set_variables]
                [set_variables]
                    name=story_map_new.image[$story_map_old.image.length]
                    [value]
                        file="misc/new-battle.png"
                        delay=500
                        x,y=$final_x,$final_y
                    [/value]
                [/set_variables]
                {CLEAR_VARIABLE final_x,final_y,original_x,original_y,step_x,step_y,distance,distance_y}
            [/else]
        [/if]
    [/event]

    [event]
        name=recruit
        first_time_only=no

        [filter]
            side=2,3,4,5,6,7,8,9
            race=human
            [or]
                side=2,3,4,5,6,7,8,9
                race=elf
            [/or]
            [or]
                side=2,3,4,5,6,7,8,9
                race=dwarf
            [/or]
        [/filter]
        [object]
            [filter]
                x=$unit.x
                y=$unit.y
            [/filter]
            silent=yes
            duration=forever
            [effect]
                apply_to=image_mod
                replace="CS(40,-30,-30)"
            [/effect]
            [effect]
                apply_to=attack
                increase_damage=90%
                increase_attacks=60%
            [/effect]
            [effect]
                apply_to=new_ability
                [abilities]
                    {ABILITY_REGENERATES_OTHER 16}
                [/abilities]
            [/effect]
            [effect]
                apply_to=hitpoints
                increase=250%
                increase_total=250%
            [/effect]
            [effect]
                apply_to=resistance
                replace=true
                [resistance]
                    fire=40
                    cold=60
                    arcane=180
                [/resistance]
            [/effect]
            [effect]
                apply_to=resistance
                replace=false
                [resistance]
                    blade=-25
                    pierce=-25
                    impact=-25
                [/resistance]
            [/effect]
            [effect]
                apply_to=defense
                replace=true
                [defense]
                    deep_water=100
                    shallow_water=100
                    reef=100
                    swamp_water=100
                    flat=100
                    sand=100
                    forest=100
                    hills=100
                    mountains=100
                    village=100
                    castle=100
                    cave=100
                    frozen=100
                    fungus=100
                [/defense]
            [/effect]
        [/object]
        [store_unit]
            variable=burning_store
            kill=no
            [filter]
                x=$unit.x
                y=$unit.y
            [/filter]
        [/store_unit]
        [set_variable]
            name=burning_store.level
            multiply=2
        [/set_variable]
        [set_variable]
            name=burning_store.variables.burning_soul
            value=yes
        [/set_variable]
        [set_variable]
            name=burning_store.level
            add=2
        [/set_variable]
        [set_variable]
            name=burning_store.race
            value="burning soul-loti"
        [/set_variable]
        [set_variable]
            name=burning_store.alignment
            value=neutral
        [/set_variable]
        [set_variable]
            name=burning_store.halo
            value="halo/burning-1.png~O(80%):100,halo/burning-2.png~O(80%):100,halo/burning-3.png~O(80%):100,halo/burning-4.png~O(80%):100,halo/burning-5.png~O(80%):100,halo/burning-6.png~O(80%):100"
        [/set_variable]
        [unstore_unit]
            variable=burning_store
            find_vacant=no
        [/unstore_unit]
        {CLEAR_VARIABLE burning_store}
    [/event]
    [event]
        name=post advance
        first_time_only=no

        [filter]
            [filter_wml]
                [variables]
                    burning_soul=yes
                [/variables]
            [/filter_wml]
        [/filter]
        {CLEAR_VARIABLE unit.variables.burning_soul,unit.modifications.object}
        [set_variable]
            name=unit.side
            value=1
        [/set_variable]
        [unstore_unit]
            variable=unit
            find_vacant=no
            text= _ "Thank you for ending my torment. I am now loyal to you!"
        [/unstore_unit]
        {ADVANCE_UNIT id=$unit.id $unit.type}
        {UPDATE_ATTACKS $unit.x $unit.y}
    [/event]
    [event]
        name=side turn
        first_time_only=no
        [harm_unit]
            [filter]
                [filter_adjacent]
                    race=burning soul-loti
                    is_enemy=yes
                [/filter_adjacent]
                side=$side_number
            [/filter]
            amount=24
            damage_type=fire
            kill=no
            animate=no
        [/harm_unit]
    [/event]
    [event]
        name=attacker_hits
        first_time_only=no

        [filter_attack]
            special_id=storm_demon
        [/filter_attack]
        [harm_unit]
            [filter]
                [filter_adjacent]
                    x,y=$x1,$y1
                [/filter_adjacent]
                [not]
                    side=$enemy_sides
                [/not]
            [/filter]
            [filter_second]
                x,y=$x1,$y1
            [/filter_second]
            amount=16
            damage_type=fire
            fire_event=yes
            experience=no
        [/harm_unit]
        [harm_unit]
            [filter]
                [filter_adjacent]
                    x,y=$x1,$y1
                [/filter_adjacent]
                [not]
                    side=$enemy_sides
                [/not]
            [/filter]
            [filter_second]
                x,y=$x1,$y1
            [/filter_second]
            amount=8
            damage_type=impact
            fire_event=yes
            experience=no
        [/harm_unit]
        [harm_unit]
            [filter]
                [filter_location]
                    [not]
                        x,y=$x1,$y1
                        radius=1
                    [/not]
                    [and]
                        x,y=$x1,$y1
                        radius=2
                    [/and]
                [/filter_location]
                [not]
                    side=$enemy_sides
                [/not]
            [/filter]
            [filter_second]
                x,y=$x1,$y1
            [/filter_second]
            amount=4
            damage_type=impact
            fire_event=yes
            experience=no
        [/harm_unit]
        [harm_unit]
            [filter]
                [filter_location]
                    [not]
                        x,y=$x1,$y1
                        radius=1
                    [/not]
                    [and]
                        x,y=$x1,$y1
                        radius=2
                    [/and]
                [/filter_location]
                [not]
                    side=$enemy_sides
                [/not]
            [/filter]
            [filter_second]
                x,y=$x1,$y1
            [/filter_second]
            amount=8
            damage_type=fire
            fire_event=yes
            experience=no
        [/harm_unit]
    [/event]

    [event]
        name=new turn
        id=blood_rain
        first_time_only=no
        {VARIABLE rains 0}
        [if]
            [variable]
                name=turn_number
                {QUANTITY greater_than_equal_to 13 11 10}
            [/variable]
            [then]
                {VARIABLE rains $turn_number}
                [set_variable]
                    name=rains
                    {QUANTITY sub 6 5 5}
                [/set_variable]
                [set_variable]
                    name=rains
                    {QUANTITY divide 7 6 5}
                [/set_variable]
            [/then]
        [/if]
        [store_locations]
            [filter]
                side=1
            [/filter]
            radius=3
            variable=rain_good
        [/store_locations]
        [while]
            [variable]
                name=rains
                greater_than=0
            [/variable]
            [do]
                {VARIABLE_OP rand rand "1..99999"}
                {VARIABLE_OP rand modulo $rain_good.length}

                {VARIABLE already no}
                {FOREACH blood_rain i}
                    [if]
                        [variable]
                            name=blood_rain[$i].x
                            equals=$rain_good[$rand].x
                        [/variable]
                        [and]
                            [variable]
                                name=blood_rain[$i].x
                                equals=$rain_good[$rand].y
                            [/variable]
                        [/and]
                        [then]
                            {VARIABLE already yes}
                        [/then]
                    [/if]
                {NEXT i}
                [if]
                    [variable]
                        name=already
                        equals=yes
                    [/variable]
                    [else]
                        [set_variables]
                            mode=replace
                            name=blood_rain[$blood_rain.length]
                            [value]
                                x,y=$rain_good[$rand].x,$rain_good[$rand].y
                            [/value]
                        [/set_variables]
                        [item]
                            halo=bloodrain/bloodrain-1.png:40,bloodrain/bloodrain-2.png:40,bloodrain/bloodrain-3.png:40,bloodrain/bloodrain-4.png:40,bloodrain/bloodrain-5.png:40,bloodrain/bloodrain-6.png:40,bloodrain/bloodrain-7.png:40,bloodrain/bloodrain-8.png:40,bloodrain/bloodrain-9.png:40,bloodrain/bloodrain-10.png:40
                            x,y=$rain_good[$rand].x,$rain_good[$rand].y
                        [/item]
                        [event]
                            name=victory
                            id=remove_blood_rain_notes
                            {CLEAR_VARIABLE blood_rain}
                        [/event]
                    [/else]
                [/if]
                {VARIABLE_OP rains sub 1}
            [/do]
        [/while]
        {CLEAR_VARIABLE map_size,already,rain_good}
        {FOREACH blood_rain i}
            [store_unit]
                [filter]
                    [filter_location]
                        x,y=$blood_rain[$i].x,$blood_rain[$i].y
                        radius=1
                    [/filter_location]
                    side=1
                [/filter]
                variable=rained
                kill=no
            [/store_unit]
            {FOREACH rained j}
                [fire_event]
                    name=dooming lethargy
                    [primary_unit]
                        find_in=rained[$j]
                    [/primary_unit]
                [/fire_event]
                [harm_unit]
                    [filter]
                        find_in=rained[$j]
                    [/filter]
                    amount=8
                    kill=no
                    animate=yes
                [/harm_unit]
                [fire_event]
                    name=raining blood
                    [primary_unit]
                        find_in=rained[$j]
                    [/primary_unit]
                [/fire_event]
            {NEXT j}
        {NEXT i}
        {CLEAR_VARIABLE rained}
    [/event]

    [event]
        name=side 1 turn refresh
        first_time_only=no
        [if]
            {VARIABLE_CONDITIONAL turn_number greater_than 1}
            [then]
                [store_unit]
                    [filter]
                        side=1
                        [filter_location]
                            terrain=Zgwl
                        [/filter_location]
                    [/filter]
                    variable=on_weird
                    kill=no
                [/store_unit]
                {FOREACH on_weird i}
                    {VARIABLE_OP on_weird[$i].moves sub 2}
                    [unstore_unit]
                        variable=on_weird[$i]
                        find_vacant=no
                    [/unstore_unit]
                {NEXT i}
                [store_unit]
                    [filter]
                        side=1
                        [filter_location]
                            terrain=*^Zewe
                        [/filter_location]
                    [/filter]
                    variable=on_weird
                    kill=no
                [/store_unit]
                {FOREACH on_weird i}
                    [harm_unit]
                        [filter]
                            id=$on_weird[$i].id
                        [/filter]
                        amount=4
                        damage_type=impact
                        fire_event=yes
                        experience=no
                        slowed=yes
                    [/harm_unit]
                {NEXT i}
                [store_unit]
                    [filter]
                        side=1
                        [filter_location]
                            terrain=*^Zews
                        [/filter_location]
                    [/filter]
                    variable=on_weird
                    kill=no
                [/store_unit]
                {FOREACH on_weird i}
                    [harm_unit]
                        [filter]
                            id=$on_weird[$i].id
                        [/filter]
                        amount=16
                        damage_type=impact
                        fire_event=yes
                        experience=no
                        slowed=yes
                    [/harm_unit]
                {NEXT i}
                [store_unit]
                    [filter]
                        side=1
                        [filter_location]
                            terrain=*^Zewt
                        [/filter_location]
                    [/filter]
                    variable=on_weird
                    kill=no
                [/store_unit]
                {FOREACH on_weird i}
                    [harm_unit]
                        [filter]
                            id=$on_weird[$i].id
                        [/filter]
                        amount=24
                        damage_type=impact
                        fire_event=yes
                        experience=no
                    [/harm_unit]
                {NEXT i}
                [store_unit]
                    [filter]
                        side=1
                        [filter_location]
                            terrain=*^Zewc
                        [/filter_location]
                    [/filter]
                    variable=on_weird
                    kill=no
                [/store_unit]
                {FOREACH on_weird i}
                    [harm_unit]
                        [filter]
                            id=$on_weird[$i].id
                        [/filter]
                        amount=40
                        damage_type=impact
                        fire_event=yes
                        experience=no
                    [/harm_unit]
                {NEXT i}
                {CLEAR_VARIABLE on_weird}
            [/then]
        [/if]
    [/event]
#enddef

#define INFERNO_SPAWN_POINT SIDE PERIOD X Y
    {PLACE_IMAGE scenery/portal-evil.png {X} {Y}}
    [event]
        name=start
        [set_variables]
            name=infernal_portals[$infernal_portals.length]
            [value]
                side={SIDE}
                period={PERIOD}
                x={X}
                y={Y}
            [/value]
        [/set_variables]
    [/event]
#enddef

#define INFERNAL_FLORA SIDES TYPES
    [event]
        name=start
        [store_locations]
            terrain=*^Ziff
            variable=to_grow
        [/store_locations]
        {FOREACH to_grow i}
            {VARIABLE_OP spawn_type rand {TYPES}}
            {VARIABLE_OP spawn_side rand {SIDES}}
            [unit]
                type=$spawn_type
                x,y=$to_grow[$i].x,$to_grow[$i].y
                ai_special=guardian
                random_traits=yes
                side=$spawn_side
            [/unit]
        {NEXT i}
        {CLEAR_VARIABLE to_grow,spawn_type,spawn_side}
    [/event]
#enddef

#define INFERNO_RECALL_ALL
    [recall]
        id=Lethalia
        show=no
    [/recall]
    [recall]
        id=Lethalia_evil
        show=no
    [/recall]
    [recall]
        id=Lilith
        show=no
    [/recall]
    [if]
        [variable]
            name=max_autorecall
            greater_than_equal_to=8
        [/variable]
        [else]
            {VARIABLE max_autorecall 8}
        [/else]
    [/if]
    {VARIABLE recall_count $max_autorecall}
    {VARIABLE i 0}
    [while]
        [variable]
            name=i
            less_than=$autorecall.length
        [/variable]
        [and]
            [variable]
                name=recall_count
                greater_than=0
            [/variable]
        [/and]
        [do]
            [store_unit]
                [filter]
                    id=$autorecall[$i].id
                [/filter]
                variable=to_autorecall
                kill=no
            [/store_unit]
            [if]
                [variable]
                    name=to_autorecall.length
                    equals=1
                [/variable]
                [then]
                    [recall]
                        id=$autorecall[$i].id
                        show=no
                    [/recall]
                    {VARIABLE_OP recall_count sub 1}
                [/then]
            [/if]
            {VARIABLE_OP i add 1}
        [/do]
    [/while]
    [while]
        [variable]
            name=recall_count
            greater_than=1
        [/variable]
        [do]
            [recall]
                show=no
            [/recall]
            {VARIABLE_OP recall_count sub 1}
        [/do]
    [/while]
    {CLEAR_VARIABLE recall_count,i,to_autorecall}
#enddef

#define DEMONIC_CEMETERY SIDE
    [event]
        name=side 1 turn end
        first_time_only=no
        [store_locations]
            terrain=*^Zdcm
            [not]
                [filter]
                [/filter] # Must be empty
            [/not]
            variable=graves
        [/store_locations]
        {FOREACH graves i}
            {GENERIC_UNIT {SIDE} "Demon Soul" $graves[$i].x $graves[$i].y}
        {NEXT i}
        {CLEAR_VARIABLE graves}
    [/event]
    [event]
        name=side 1 turn
        first_time_only=no
        [kill]
            type=Demon Soul
        [/kill]
    [/event]
    [event]
        name=attack
        [filter]
            type=Demon Soul
        [/filter]
        [if]
            [not]
                [variable]
                    name=quests.seen_demon_soul
                    equals=yes
                [/variable]
            [/not]
            [then]
                [message]
                    speaker=Lethalia
                    message=_"They appear, wander, attack and vanish. Then the cycle repeats again. This will be an annoyance."
                [/message]
                {VARIABLE quests.seen_demon_soul yes}
            [/then]
        [/if]
    [/event]
#enddef

#define HUNGRY_VOID
    [event]
        name=new turn
        first_time_only=no
        [store_locations]
            [not]
                terrain=Xv
            [/not]
            [filter_adjacent_location]
                terrain=Xv
                count=1
            [/filter_adjacent_location]
            variable=near_void
        [/store_locations]
        {FOREACH near_void i}
            {VARIABLE_OP do_expand rand (yes,no,no)}
            [if]
                [variable]
                    name=do_expand
                    equals=yes
                [/variable]
                [then]
                    [terrain]
                        x,y=$near_void[$i].x,$near_void[$i].y
                        terrain=Xv
                    [/terrain]
                    [harm_unit]
                        [filter]
                            x,y=$near_void[$i].x,$near_void[$i].y
                        [/filter]
                        amount=32
                        damage_type=arcane
                        kill=yes
                    [/harm_unit]
                [/then]
            [/if]
        {NEXT i}
        [store_locations]
            [not]
                terrain=Xv
            [/not]
            [filter_adjacent_location]
                terrain=Xv
                count=4-6
            [/filter_adjacent_location]
            variable=near_void
        [/store_locations]
        {FOREACH near_void i}
            [terrain]
                x,y=$near_void[$i].x,$near_void[$i].y
                terrain=Xv
            [/terrain]
            [harm_unit]
                [filter]
                    x,y=$near_void[$i].x,$near_void[$i].y
                [/filter]
                amount=32
                damage_type=arcane
                kill=yes
            [/harm_unit]
            [if]
                [variable]
                    name=near_void[$i].side
                    equals=1
                [/variable]
                [not]
                    [variable]
                        name=quests.seen_void
                        equals=yes
                    [/variable]
                [/not]
                [then]
                    [message]
                        speaker=Efraim
                        message=_"This hungry void expands and eats everything it can reach. We most get through before it consumes the whole area."
                    [/message]
                    {VARIABLE quests.seen_void yes}
                [/then]
            [/if]
        {NEXT i}
        {CLEAR_VARIABLE near_void,do_expand}
    [/event]
#enddef

#define BLACKENING_DEMONS
    [event]
        name=last breath
        first_time_only=no
        [filter]
            race=demon-loti
        [/filter]
        [fire_event]
            [primary_unit]
                find_in=unit
            [/primary_unit]
            name=demon blackens
        [/fire_event]
        [store_unit]
            [filter]
                find_in=unit
            [/filter]
            variable=blackening_store
            kill=yes
        [/store_unit]
        {VARIABLE blackening_store.hitpoints $blackening_store.max_hitpoints}
        {VARIABLE blackening_store.moves 0}
        {VARIABLE blackening_store.attacks_left 0}
        [fire_event]
            name=make black soul
        [/fire_event]
    [/event]
    [event]
        name=demon blackens
        [message]
            speaker=unit
            message=_"My soul now sees the light. The bleak truths that you would never grasp without losing your sanity."
        [/message]
        [if]
            [not]
                [variable]
                    name=quests.seen_demon_blacken
                    equals=yes
                [/variable]
            [/not]
            [then]
                [message]
                    speaker=Lethalia
                    message=_"Black soul demons. The last thing we need."
                [/message]
                {VARIABLE quests.seen_demon_blacken yes}
            [/then]
        [/if]
    [/event]
#enddef

#define MAKE_ANIMATED_STATUE TYPE GENDER X Y IMAGE
    [remove_item]
        image={IMAGE}
        x,y={X},{Y}
    [/remove_item]
    {PLACE_IMAGE scenery/statue-piedestal.png {X} {Y}}
    [unit]
        side=3
        x,y={X},{Y}
        type={TYPE}
        generate_name=yes
        random_traits=yes
        gender={GENDER}
        [modifications]
            [object]
                [effect]
                    apply_to=image_mod
                    add="GS()"
                [/effect]
                [effect]
                    apply_to=resistance
                    replace=false
                    [resistance]
                        cold=-20
                        fire=-30
                        arcane=-10
                        blade=-30
                        pierce=-40
                        impact=-20
                    [/resistance]
                [/effect]
                [effect]
                    apply_to=status
                    add=not_living
                [/effect]
            [/object]
        [/modifications]
    [/unit]
#enddef

#define STATUE_AMBUSH NUMBER ACTIVATION X1 X2 X3 Y1 Y2 Y3
    [event]
        name=prestart
        [if]
            [variable]
                name=quests.statues_{NUMBER}
                equals=yes
            [/variable]
            [then]
#ifndef EASY
                {PLACE_IMAGE scenery/statue-piedestal.png {X1} {Y2}}
#endif
                {PLACE_IMAGE scenery/statue-piedestal.png {X1} {Y3}}
                {PLACE_IMAGE scenery/statue-piedestal.png {X2} {Y1}}
                {PLACE_IMAGE scenery/statue-piedestal.png {X3} {Y3}}
                {PLACE_IMAGE scenery/statue-piedestal.png {X3} {Y2}}
                {PLACE_IMAGE scenery/statue-piedestal.png {X2} {Y3}}
#ifdef HARD
                {PLACE_IMAGE scenery/statue-piedestal.png {X3} {Y1}}
#endif
                {PLACE_IMAGE scenery/lilith-statue.png {X2} {Y2}}
            [/then]
            [else]
                {VARIABLE_OP gender_{X2}_{Y3} rand (male,female)}
#ifdef HARD
                {VARIABLE_OP gender_{X3}_{Y1} rand (male,female)}
#endif

#ifndef EASY
                {PLACE_IMAGE scenery/demon-manowar-statue.png {X1} {Y2}}
#endif
                {PLACE_IMAGE scenery/demon-manowar-statue.png {X1} {Y3}}
                {PLACE_IMAGE scenery/demon-manowar-statue.png {X2} {Y1}}
                {PLACE_IMAGE scenery/demon-manowar-statue.png {X3} {Y3}}
                {PLACE_IMAGE scenery/demon-despot-statue.png {X3} {Y2}}
                [if]
                    [variable]
                        name=gender_{X2}_{Y3}
                        equals=male
                    [/variable]
                    [then]
                        {PLACE_IMAGE scenery/incubus-statue.png {X2} {Y3}}
                    [/then]
                    [else]
                        {PLACE_IMAGE scenery/succubus-statue.png {X2} {Y3}}
                    [/else]
                [/if]
#ifdef HARD
                [if]
                    [variable]
                        name=gender_{X3}_{Y1}
                        equals=male
                    [/variable]
                    [then]
                        {PLACE_IMAGE scenery/incubus-statue.png {X3} {Y1}}
                    [/then]
                    [else]
                        {PLACE_IMAGE scenery/succubus-statue.png {X3} {Y1}}
                    [/else]
                [/if]
#endif
                {PLACE_IMAGE scenery/lilith-statue.png {X2} {Y2}}

                [event]
                    name=moveto
                    [filter]
                        side=1
                        x,y={ACTIVATION}
                    [/filter]
                    [fire_event]
                        name=before fist activation of statues
                    [/fire_event]
#ifndef EASY
                    {MAKE_ANIMATED_STATUE "Demon Manowar" male {X1} {Y2} scenery/demon-manowar-statue.png}
#endif
                    {MAKE_ANIMATED_STATUE "Demon Manowar" male {X1} {Y3} scenery/demon-manowar-statue.png}
                    {MAKE_ANIMATED_STATUE "Demon Manowar" male {X2} {Y1} scenery/demon-manowar-statue.png}
                    {MAKE_ANIMATED_STATUE "Demon Manowar" male {X3} {Y3} scenery/demon-manowar-statue.png}
                    {MAKE_ANIMATED_STATUE "Demon Despot" male {X3} {Y2} scenery/demon-despot-statue.png}
                    [if]
                        [variable]
                            name=gender_{X2}_{Y3}
                            equals=male
                        [/variable]
                        [then]
                            {MAKE_ANIMATED_STATUE "Succubus" male {X2} {Y3} scenery/incubus-statue.png}
                        [/then]
                        [else]
                            {MAKE_ANIMATED_STATUE "Succubus" female {X2} {Y3} scenery/succubus-statue.png}
                        [/else]
                    [/if]
                    {CLEAR_VARIABLE gender_{X2}_{Y3}}
#ifdef HARD
                    [if]
                        [variable]
                            name=gender_{X3}_{Y1}
                            equals=male
                        [/variable]
                        [then]
                            {MAKE_ANIMATED_STATUE "Succubus" male {X3} {Y1} scenery/incubus-statue.png}
                        [/then]
                        [else]
                            {MAKE_ANIMATED_STATUE "Succubus" female {X3} {Y1} scenery/succubus-statue.png}
                        [/else]
                    [/if]
                    {CLEAR_VARIABLE gender_{X3}_{Y1}}
#endif
                    [fire_event]
                        name=after fist activation of statues
                    [/fire_event]
                    {VARIABLE quests.statues_{NUMBER} yes}
                [/event]
            [/else]
        [/if]
    [/event]
#enddef

#define ROTTING_CARCASSES SIDE
    [event]
        name=die
        first_time_only=no
        [filter]
            [not]
                side=1
            [/not]
            [not]
                side={SIDE}
            [/not]
        [/filter]
        {VARIABLE already_carcass no}
        {FOREACH carcasses i}
            [if]
                [variable]
                    name=carcasses[$i].x
                    equals=$x1
                [/variable]
                [and]
                    [variable]
                        name=carcasses[$i].y
                        equals=$y1
                    [/variable]
                [/and]
                [then]
                    {VARIABLE already_carcass yes}
                [/then]
            [/if]
        {NEXT i}
        [if]
            [variable]
                name=already_carcass
                equals=no
            [/variable]
            [then]
                [item]
                    x,y=$x1,$y1
                    image=units/carcass.png
                [/item]
                [set_variables]
                    name=carcasses
                    mode=append
                    [value]
                        x=$x1
                        y=$y1
                    [/value]
                [/set_variables]
            [/then]
        [/if]
    [/event]
    [event]
        name=new turn
        first_time_only=no
        {FOREACH carcasses i}
            {VARIABLE_OP random rand (yes,no)}
            [if]
                [variable]
                    name=random
                    equals=yes
                [/variable]
                [then]
                    {GENERIC_UNIT {SIDE} Flies $carcasses[$i].x $carcasses[$i].y}
                    [+unit]
                        [modifications]
                            [object]
                                [effect]
                                    apply_to=attack
                                    increase_damage=200%
                                    increase_attacks=-50%
                                [/effect]
                            [/object]
                        [/modifications]
                    [/unit]
                [/then]
            [/if]
        {NEXT i}
        {CLEAR_VARIABLE random}
    [/event]
    [event]
        name=victory
        {CLEAR_VARIABLE carcasses,already_carcass}
    [/event]
    [event]
        name=attack
        [filter]
            type=Flies
        [/filter]
        [if]
            [not]
                [variable]
                    name=quests.seen_rot_flies
                    equals=yes
                [/variable]
            [/not]
            [then]
                [message]
                    speaker=Efraim
                    message=_"The corpses get putrid insanely fast here. There is some sort of infestation here. We should leave before the flies spread too much."
                [/message]
                {VARIABLE quests.seen_rot_flies yes}
            [/then]
        [/if]
    [/event]
#enddef
